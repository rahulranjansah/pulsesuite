test_dcfield
============

.. py:module:: test_dcfield

.. autoapi-nested-parse::

   Comprehensive test suite for dcfield.py module.

   Tests all DC field carrier transport functions including initialization,
   DC field calculations, drift velocity, phonon interactions, and legacy functions.



Classes
-------

.. autoapisummary::

   test_dcfield.TestGetKArray
   test_dcfield.TestInitializeDC
   test_dcfield.TestEkReNorm
   test_dcfield.TestDriftVt
   test_dcfield.TestLrtz
   test_dcfield.TestTheta
   test_dcfield.TestCalcI0n
   test_dcfield.TestCalcI0
   test_dcfield.TestCalcVD
   test_dcfield.TestCalcPD
   test_dcfield.TestThetaEM
   test_dcfield.TestThetaABS
   test_dcfield.TestFDrift2
   test_dcfield.TestFDrift
   test_dcfield.TestCalcAvgCoeff
   test_dcfield.TestDndEk
   test_dcfield.TestThetaEMABS
   test_dcfield.TestGetFunctions
   test_dcfield.TestShiftN1D
   test_dcfield.TestShiftN2D
   test_dcfield.TestTransport
   test_dcfield.TestCalcDCE2
   test_dcfield.TestCalcDCH2
   test_dcfield.TestCalcDCE
   test_dcfield.TestCalcDCH
   test_dcfield.TestDCFieldIntegration
   test_dcfield.TestNumericalStability
   test_dcfield.TestDC_Step_Scale
   test_dcfield.TestDC_Step_FD
   test_dcfield.TestPhysicalProperties


Module Contents
---------------

.. py:class:: TestGetKArray

   Test k-space array generation.


   .. py:method:: test_GetKArray_basic()

      Test basic k-array generation.



   .. py:method:: test_GetKArray_centered()

      Test that k-array is centered at zero.



   .. py:method:: test_GetKArray_spacing()

      Test k-array spacing.



   .. py:method:: test_GetKArray_zero_length()

      Test k-array with zero length.



.. py:class:: TestInitializeDC

   Test DC field module initialization.


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up module state.



   .. py:method:: test_InitializeDC_basic()

      Test basic initialization.



   .. py:method:: test_InitializeDC_arrays_shape()

      Test that initialized arrays have correct shapes.



   .. py:method:: test_InitializeDC_file_creation()

      Test that output files are created.



   .. py:method:: test_InitializeDC_rates_initialized()

      Test that rates are initialized to zero.



.. py:class:: TestEkReNorm

   Test energy renormalization function.


   .. py:method:: test_EkReNorm_simple()

      Test energy renormalization with simple case.



   .. py:method:: test_EkReNorm_zero_interaction()

      Test with zero interaction matrix.



   .. py:method:: test_EkReNorm_identity_matrix()

      Test with identity interaction matrix.



   .. py:method:: test_EkReNorm_physical_values()

      Test with physical energy values.



.. py:class:: TestDriftVt

   Test drift velocity calculation.


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: test_DriftVt_simple()

      Test drift velocity with simple distribution.



   .. py:method:: test_DriftVt_gaussian_distribution()

      Test drift velocity with Gaussian distribution.



   .. py:method:: test_DriftVt_zero_distribution()

      Test drift velocity with zero distribution.



   .. py:method:: test_DriftVt_constant_energy()

      Test drift velocity with constant energy.



.. py:class:: TestLrtz

   Test Lorentzian function.


   .. py:method:: test_Lrtz_peak()

      Test Lorentzian at peak.



   .. py:method:: test_Lrtz_array()

      Test Lorentzian with array.



   .. py:method:: test_Lrtz_large_argument()

      Test Lorentzian with large argument.



   .. py:method:: test_Lrtz_small_width()

      Test Lorentzian with small width.



.. py:class:: TestTheta

   Test Heaviside step function.


   .. py:method:: test_theta_positive()

      Test theta for positive value.



   .. py:method:: test_theta_negative()

      Test theta for negative value.



   .. py:method:: test_theta_zero()

      Test theta at zero.



   .. py:method:: test_theta_array()

      Test theta with array.



.. py:class:: TestCalcI0n

   Test electron current calculation.


   .. py:method:: test_CalcI0n_simple()

      Test electron current with simple distribution.



   .. py:method:: test_CalcI0n_zero_distribution()

      Test electron current with zero distribution.



   .. py:method:: test_CalcI0n_symmetric_distribution()

      Test electron current with symmetric distribution.



.. py:class:: TestCalcI0

   Test total current calculation.


   .. py:method:: test_CalcI0_simple()

      Test total current with simple distributions.



   .. py:method:: test_CalcI0_zero_distributions()

      Test total current with zero distributions.



.. py:class:: TestCalcVD

   Test drift velocity from distribution.


   .. py:method:: test_CalcVD_simple()

      Test drift velocity calculation.



   .. py:method:: test_CalcVD_zero_distribution()

      Test drift velocity with zero distribution.



.. py:class:: TestCalcPD

   Test momentum from distribution.


   .. py:method:: test_CalcPD_simple()

      Test momentum calculation.



   .. py:method:: test_CalcPD_symmetric_distribution()

      Test momentum with symmetric distribution.



.. py:class:: TestThetaEM

   Test emission matrix element calculation.


   .. py:method:: test_ThetaEM_basic()

      Test basic emission matrix element.



   .. py:method:: test_ThetaEM_edge_cases()

      Test emission matrix element at edge cases.



.. py:class:: TestThetaABS

   Test absorption matrix element calculation.


   .. py:method:: test_ThetaABS_basic()

      Test basic absorption matrix element.



.. py:class:: TestFDrift2

   Test drift force calculation.


   .. py:method:: test_FDrift2_basic()

      Test basic drift force calculation.



   .. py:method:: test_FDrift2_zero_distribution()

      Test drift force with zero distribution.



.. py:class:: TestFDrift

   Test drift force calculation (alternative implementation).


   .. py:method:: test_FDrift_basic()

      Test basic FDrift calculation.



   .. py:method:: test_FDrift_zero_derivative()

      Test FDrift with zero derivative.



.. py:class:: TestCalcAvgCoeff

   Test average coefficient calculation.


   .. py:method:: test_CalcAvgCoeff_basic()

      Test basic coefficient calculation.



.. py:class:: TestDndEk

   Test derivative of occupation with respect to energy.


   .. py:method:: test_dndEk_basic()

      Test basic dndEk calculation.



.. py:class:: TestThetaEMABS

   Test emission-absorption matrix element.


   .. py:method:: test_ThetaEMABS_basic()

      Test basic ThetaEMABS calculation.



.. py:class:: TestGetFunctions

   Test getter functions for module variables.


   .. py:method:: setup_method()

      Set up module state.



   .. py:method:: test_GetEDrift()

      Test get electron drift rate.



   .. py:method:: test_GetHDrift()

      Test get hole drift rate.



   .. py:method:: test_GetVEDrift()

      Test get electron drift velocity.



   .. py:method:: test_GetVHDrift()

      Test get hole drift velocity.



.. py:class:: TestShiftN1D

   Test 1D distribution shifting.


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: test_ShiftN1D_zero_shift()

      Test shift with zero displacement.



   .. py:method:: test_ShiftN1D_small_shift()

      Test shift with small displacement.



.. py:class:: TestShiftN2D

   Test 2D distribution shifting.


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: test_ShiftN2D_zero_shift()

      Test shift with zero displacement.



   .. py:method:: test_ShiftN2D_small_shift()

      Test shift with small displacement.



.. py:class:: TestTransport

   Test transport step function.


   .. py:method:: test_Transport_no_DCTrans()

      Test transport with DCTrans=False.



   .. py:method:: test_Transport_with_DCTrans()

      Test transport with DCTrans=True.



.. py:class:: TestCalcDCE2

   Test DC field contribution for electrons (version 2).


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up.



   .. py:method:: test_CalcDCE2_no_DCTrans()

      Test with DCTrans=False.



   .. py:method:: test_CalcDCE2_with_DCTrans()

      Test with DCTrans=True.



.. py:class:: TestCalcDCH2

   Test DC field contribution for holes (version 2).


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up.



   .. py:method:: test_CalcDCH2_no_DCTrans()

      Test with DCTrans=False.



   .. py:method:: test_CalcDCH2_with_DCTrans()

      Test with DCTrans=True.



.. py:class:: TestCalcDCE

   Test DC field contribution for electrons (original version).


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up.



   .. py:method:: test_CalcDCE_no_DCTrans()

      Test with DCTrans=False.



   .. py:method:: test_CalcDCE_with_DCTrans()

      Test with DCTrans=True.



.. py:class:: TestCalcDCH

   Test DC field contribution for holes (original version).


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up.



   .. py:method:: test_CalcDCH_no_DCTrans()

      Test with DCTrans=False.



   .. py:method:: test_CalcDCH_with_DCTrans()

      Test with DCTrans=True.



.. py:class:: TestDCFieldIntegration

   Integration tests for DC field calculations.


   .. py:method:: setup_method()

      Set up test data.



   .. py:method:: teardown_method()

      Clean up.



   .. py:method:: test_energy_renormalization_chain()

      Test chain of energy renormalization operations.



   .. py:method:: test_dc_field_calculation_workflow()

      Test complete DC field calculation workflow.



   .. py:method:: test_current_calculation_workflow()

      Test complete current calculation workflow.



   .. py:method:: test_phonon_interaction_workflow()

      Test phonon interaction calculation workflow.



.. py:class:: TestNumericalStability

   Test numerical stability of functions.


   .. py:method:: test_energy_renormalization_stability()

      Test energy renormalization with various inputs.



   .. py:method:: test_drift_velocity_stability()

      Test drift velocity calculation stability.



.. py:class:: TestDC_Step_Scale

   Test DC step using scaling method (legacy).


   .. py:method:: test_DC_Step_Scale_basic()

      Test DC_Step_Scale function exists and runs.



   .. py:method:: test_DC_Step_Scale_zero_field()

      Test DC_Step_Scale with zero field.



.. py:class:: TestDC_Step_FD

   Test DC step using finite difference method (legacy).


   .. py:method:: test_DC_Step_FD_basic()

      Test DC_Step_FD with basic inputs.



   .. py:method:: test_DC_Step_FD_zero_field()

      Test DC_Step_FD with zero field.



.. py:class:: TestPhysicalProperties

   Test that physical properties are preserved.


   .. py:method:: test_current_conservation()

      Test that current calculations are physically reasonable.



   .. py:method:: test_energy_renormalization_consistency()

      Test that energy renormalization is consistent.



