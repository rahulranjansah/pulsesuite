test_phost
==========

.. py:module:: test_phost

.. autoapi-nested-parse::

   Comprehensive test suite for phost.py module.

   Tests all host material polarization calculation functions including
   polarization time-stepping, material parameter setup, dispersion calculations,
   and FFT operations.



Attributes
----------

.. autoapisummary::

   test_phost.pi
   test_phost.twopi
   test_phost.ii


Classes
-------

.. autoapisummary::

   test_phost.TestNw2NoGam
   test_phost.TestNw2
   test_phost.TestNl2NoGam
   test_phost.TestNl2
   test_phost.TestNwpNoGam
   test_phost.TestNwp
   test_phost.TestEpsrwpNoGam
   test_phost.TestSetParamsAlAs
   test_phost.TestSetParamsGaAs
   test_phost.TestSetParamsSilica
   test_phost.TestSetParamsNone
   test_phost.TestCalcMonoP
   test_phost.TestCalcNextP
   test_phost.TestCalcPHost
   test_phost.TestCalcPHostOld
   test_phost.TestMakeTransverse
   test_phost.TestSetHostMaterial
   test_phost.TestInitializeHost
   test_phost.TestCalcWq
   test_phost.TestCalcEpsrWq
   test_phost.TestCalcEpsrWqIj
   test_phost.TestDetermineCoeffs
   test_phost.TestEpsrQ
   test_phost.TestEpsrQij
   test_phost.TestWq
   test_phost.TestFDTDDispersion
   test_phost.TestSetInitialP
   test_phost.TestIFFT
   test_phost.TestWriteHostDispersion
   test_phost.TestIntegration


Module Contents
---------------

.. py:data:: pi

.. py:data:: twopi

.. py:data:: ii
   :value: 1j


.. py:class:: TestNw2NoGam

   Test dielectric constant calculation without damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nw2_no_gam_basic()

      Test nw2_no_gam with basic inputs.



   .. py:method:: test_nw2_no_gam_zero_frequency()

      Test nw2_no_gam with zero frequency.



   .. py:method:: test_nw2_no_gam_resonance()

      Test nw2_no_gam near resonance.



   .. py:method:: test_nw2_no_gam_none_b_w()

      Test nw2_no_gam when _B or _w is None.



.. py:class:: TestNw2

   Test dielectric constant calculation with damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nw2_basic()

      Test nw2 with basic inputs.



   .. py:method:: test_nw2_zero_frequency()

      Test nw2 with zero frequency.



   .. py:method:: test_nw2_none_b_w_gam()

      Test nw2 when _B, _w, or _gam is None.



.. py:class:: TestNl2NoGam

   Test dielectric constant from wavelength without damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nl2_no_gam_basic()

      Test nl2_no_gam with basic inputs.



   .. py:method:: test_nl2_no_gam_none_b_c()

      Test nl2_no_gam when _B or _C is None.



.. py:class:: TestNl2

   Test dielectric constant from wavelength with damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nl2_basic()

      Test nl2 with basic inputs.



   .. py:method:: test_nl2_none_b_w_gam()

      Test nl2 when _B, _w, or _gam is None.



.. py:class:: TestNwpNoGam

   Test derivative of refractive index without damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nwp_no_gam_basic()

      Test nwp_no_gam with basic inputs.



   .. py:method:: test_nwp_no_gam_none_b_w()

      Test nwp_no_gam when _B or _w is None.



.. py:class:: TestNwp

   Test derivative of refractive index with damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_nwp_basic()

      Test nwp with basic inputs.



   .. py:method:: test_nwp_none_b_w_gam()

      Test nwp when _B, _w, or _gam is None.



.. py:class:: TestEpsrwpNoGam

   Test derivative of dielectric constant without damping.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_epsrwp_no_gam_basic()

      Test epsrwp_no_gam with basic inputs.



   .. py:method:: test_epsrwp_no_gam_none_b_w()

      Test epsrwp_no_gam when _B or _w is None.



.. py:class:: TestSetParamsAlAs

   Test AlAs material parameter setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_params_alas()

      Test SetParamsAlAs.



.. py:class:: TestSetParamsGaAs

   Test GaAs material parameter setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_params_gaas()

      Test SetParamsGaAs.



.. py:class:: TestSetParamsSilica

   Test Silica material parameter setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_params_silica()

      Test SetParamsSilica.



.. py:class:: TestSetParamsNone

   Test None (vacuum) material parameter setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_params_none()

      Test SetParamsNone.



.. py:class:: TestCalcMonoP

   Test monochromatic polarization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_mono_p_basic()

      Test CalcMonoP with basic inputs.



   .. py:method:: test_calc_mono_p_different_sizes()

      Test CalcMonoP with different array sizes.



.. py:class:: TestCalcNextP

   Test next polarization value calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_next_p_basic()

      Test CalcNextP with basic inputs.



   .. py:method:: test_calc_next_p_different_sizes()

      Test CalcNextP with different array sizes.



.. py:class:: TestCalcPHost

   Test host material polarization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_p_host_basic()

      Test CalcPHost with basic inputs.



   .. py:method:: test_calc_p_host_multiple_calls()

      Test CalcPHost with multiple calls (time-stepping).



.. py:class:: TestCalcPHostOld

   Test old version of host material polarization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_p_host_old_m_less_than_2()

      Test CalcPHostOld with m < 2.



   .. py:method:: test_calc_p_host_old_m_equal_2()

      Test CalcPHostOld with m == 2.



   .. py:method:: test_calc_p_host_old_m_greater_than_2()

      Test CalcPHostOld with m > 2.



.. py:class:: TestMakeTransverse

   Test transverse projection of electric field.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_make_transverse_basic()

      Test MakeTransverse with basic inputs.



   .. py:method:: test_make_transverse_transverse_property()

      Test that MakeTransverse makes field transverse to q.



.. py:class:: TestSetHostMaterial

   Test host material parameter setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_host_material_alas()

      Test SetHostMaterial with AlAs.



   .. py:method:: test_set_host_material_gaas()

      Test SetHostMaterial with GaAs.



   .. py:method:: test_set_host_material_silica()

      Test SetHostMaterial with silica.



   .. py:method:: test_set_host_material_none()

      Test SetHostMaterial with none.



   .. py:method:: test_set_host_material_unknown()

      Test SetHostMaterial with unknown material.



.. py:class:: TestInitializeHost

   Test host material initialization.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_initialize_host_with_dispersion()

      Test InitializeHost with host dispersion enabled.



   .. py:method:: test_initialize_host_without_dispersion()

      Test InitializeHost without host dispersion.



.. py:class:: TestCalcWq

   Test frequency calculation from momentum.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_wq_basic()

      Test CalcWq with basic inputs.



.. py:class:: TestCalcEpsrWq

   Test dielectric constant calculation as function of frequency.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_epsr_wq_basic()

      Test CalcEpsrWq with basic inputs.



.. py:class:: TestCalcEpsrWqIj

   Test dielectric constant calculation for single frequency.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_epsr_wq_ij_low_frequency()

      Test CalcEpsrWq_ij with low frequency.



   .. py:method:: test_calc_epsr_wq_ij_high_frequency()

      Test CalcEpsrWq_ij with high frequency.



   .. py:method:: test_calc_epsr_wq_ij_mid_frequency()

      Test CalcEpsrWq_ij with mid frequency.



.. py:class:: TestDetermineCoeffs

   Test expansion coefficient determination.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_determine_coeffs_basic()

      Test DetermineCoeffs with basic inputs.



.. py:class:: TestEpsrQ

   Test dielectric constant array retrieval.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_epsr_q_basic()

      Test Epsr_q with basic inputs.



.. py:class:: TestEpsrQij

   Test dielectric constant at specific indices.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_epsr_qij_basic()

      Test Epsr_qij with basic inputs.



.. py:class:: TestWq

   Test frequency retrieval at specific indices.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_wq_basic()

      Test wq with basic inputs.



.. py:class:: TestFDTDDispersion

   Test FDTD dispersion relation calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_fdtd_dispersion_basic()

      Test FDTD_Dispersion with basic inputs.



   .. py:method:: test_fdtd_dispersion_different_sizes()

      Test FDTD_Dispersion with different array sizes.



.. py:class:: TestSetInitialP

   Test initial polarization setup.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_set_initial_p_basic()

      Test SetInitialP with basic inputs.



.. py:class:: TestIFFT

   Test inverse FFT wrapper.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_ifft_basic()

      Test IFFT with basic inputs.



   .. py:method:: test_ifft_round_trip()

      Test IFFT round-trip property.



.. py:class:: TestWriteHostDispersion

   Test host dispersion data writing.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_write_host_dispersion_basic()

      Test WriteHostDispersion with basic inputs.



   .. py:method:: test_write_host_dispersion_none_b_w()

      Test WriteHostDispersion when _w or _B is None.



.. py:class:: TestIntegration

   Integration tests for complete host material workflows.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_material_setup_workflow()

      Test complete material setup workflow.



   .. py:method:: test_polarization_workflow()

      Test complete polarization calculation workflow.



   .. py:method:: test_dispersion_workflow()

      Test complete dispersion calculation workflow.



   .. py:method:: test_different_array_sizes(N1, N2)

      Test integration with different array sizes.



