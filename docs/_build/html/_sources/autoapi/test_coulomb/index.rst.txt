test_coulomb
============

.. py:module:: test_coulomb

.. autoapi-nested-parse::

   Comprehensive test suite for coulomb.py module.

   Tests all Coulomb interaction functions including initialization, interaction integrals,
   many-body arrays, screening calculations, and Semiconductor Bloch Equations terms.



Attributes
----------

.. autoapisummary::

   test_coulomb.eV
   test_coulomb.hbar
   test_coulomb.pi
   test_coulomb.twopi


Classes
-------

.. autoapisummary::

   test_coulomb.TestGaussDelta
   test_coulomb.TestMakeK3
   test_coulomb.TestMakeQs
   test_coulomb.TestMakeUnDel
   test_coulomb.TestSetLorentzDelta
   test_coulomb.TestVint
   test_coulomb.TestVehint
   test_coulomb.TestCalcCoulombArrays
   test_coulomb.TestCalcMBArrays
   test_coulomb.TestCalcChi1D
   test_coulomb.TestEps1D
   test_coulomb.TestGetChi1Dqw
   test_coulomb.TestGetEps1Dqw
   test_coulomb.TestCalcScreenedArrays
   test_coulomb.TestUndell
   test_coulomb.TestCalcMVeh
   test_coulomb.TestBGRenorm
   test_coulomb.TestEeRenorm
   test_coulomb.TestEhRenorm
   test_coulomb.TestMBCE2
   test_coulomb.TestMBCE
   test_coulomb.TestMBCH
   test_coulomb.TestInitializeCoulomb
   test_coulomb.TestIntegration


Module Contents
---------------

.. py:data:: eV
   :value: 1.602176634e-19


.. py:data:: hbar

.. py:data:: pi

.. py:data:: twopi

.. py:class:: TestGaussDelta

   Test Gaussian delta function approximation.


   .. py:method:: test_gauss_delta_normal()

      Test Gaussian delta with normal values.



   .. py:method:: test_gauss_delta_nonzero_a()

      Test Gaussian delta with nonzero a.



   .. py:method:: test_gauss_delta_small_b()

      Test Gaussian delta with very small b.



   .. py:method:: test_gauss_delta_zero_b()

      Test Gaussian delta with zero b.



   .. py:method:: test_gauss_delta_large_a()

      Test Gaussian delta with large a.



.. py:class:: TestMakeK3

   Test momentum conservation indexing array.


   .. py:method:: test_make_k3_small()

      Test MakeK3 with small array.



   .. py:method:: test_make_k3_even_length()

      Test MakeK3 with even length array.



   .. py:method:: test_make_k3_odd_length()

      Test MakeK3 with odd length array.



   .. py:method:: test_make_k3_prime_length()

      Test MakeK3 with prime length array.



   .. py:method:: test_make_k3_invalid_combinations()

      Test that invalid momentum combinations return 0.



   .. py:method:: test_make_k3_module_storage()

      Test that MakeK3 stores result in module-level variable.



.. py:class:: TestMakeQs

   Test momentum difference arrays.


   .. py:method:: test_make_qs_small()

      Test MakeQs with small array.



   .. py:method:: test_make_qs_even_length()

      Test MakeQs with even length array.



   .. py:method:: test_make_qs_symmetry()

      Test that qe and qh are symmetric.



   .. py:method:: test_make_qs_module_storage()

      Test that MakeQs stores results in module-level variables.



.. py:class:: TestMakeUnDel

   Test inverse delta function array.


   .. py:method:: test_make_undel_small()

      Test MakeUnDel with small array.



   .. py:method:: test_make_undel_even_length()

      Test MakeUnDel with even length array.



   .. py:method:: test_make_undel_module_storage()

      Test that MakeUnDel stores result in module-level variable.



.. py:class:: TestSetLorentzDelta

   Test LorentzDelta flag setting.


   .. py:method:: test_set_lorentz_delta_true()

      Test setting LorentzDelta to True.



   .. py:method:: test_set_lorentz_delta_false()

      Test setting LorentzDelta to False.



   .. py:method:: test_set_lorentz_delta_int()

      Test setting LorentzDelta with integer.



.. py:class:: TestVint

   Test interaction integral calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_vint_small_q()

      Test Vint with small momentum difference.



   .. py:method:: test_vint_large_q()

      Test Vint with large momentum difference.



   .. py:method:: test_vint_zero_q()

      Test Vint with zero momentum difference.



   .. py:method:: test_vint_different_sizes()

      Test Vint with different array sizes.



   .. py:method:: test_vint_symmetry()

      Test that Vint is symmetric in alphae and alphah.



.. py:class:: TestVehint

   Test electron-hole interaction integral.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_vehint_valid_indices()

      Test Vehint with valid indices.



   .. py:method:: test_vehint_same_indices()

      Test Vehint with same indices.



   .. py:method:: test_vehint_different_sizes()

      Test Vehint with different array sizes.



.. py:class:: TestCalcCoulombArrays

   Test unscreened Coulomb array calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_coulomb_arrays_basic()

      Test CalcCoulombArrays with basic inputs.



   .. py:method:: test_calc_coulomb_arrays_screw_this()

      Test CalcCoulombArrays with ScrewThis=True.



   .. py:method:: test_calc_coulomb_arrays_module_storage()

      Test that CalcCoulombArrays stores results in module-level variables.



   .. py:method:: test_calc_coulomb_arrays_different_sizes()

      Test CalcCoulombArrays with different array sizes.



.. py:class:: TestCalcMBArrays

   Test many-body interaction array calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_mb_arrays_lorentzian()

      Test CalcMBArrays with Lorentzian broadening.



   .. py:method:: test_calc_mb_arrays_gaussian()

      Test CalcMBArrays with Gaussian delta function.



   .. py:method:: test_calc_mb_arrays_explicit_lorentzian()

      Test CalcMBArrays with explicit LorentzDelta parameter.



   .. py:method:: test_calc_mb_arrays_explicit_gaussian()

      Test CalcMBArrays with explicit LorentzDelta=False.



   .. py:method:: test_calc_mb_arrays_module_storage()

      Test that CalcMBArrays stores results in module-level variables.



   .. py:method:: test_calc_mb_arrays_different_sizes()

      Test CalcMBArrays with different array sizes.



.. py:class:: TestCalcChi1D

   Test 1D susceptibility array calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_chi1d_basic()

      Test CalcChi1D with basic inputs.



   .. py:method:: test_calc_chi1d_module_storage()

      Test that CalcChi1D stores results in module-level variables.



   .. py:method:: test_calc_chi1d_different_sizes()

      Test CalcChi1D with different array sizes.



.. py:class:: TestEps1D

   Test 1D dielectric function matrix.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_eps1d_basic()

      Test Eps1D with basic inputs.



   .. py:method:: test_eps1d_different_densities()

      Test Eps1D with different densities.



   .. py:method:: test_eps1d_error_if_not_initialized()

      Test that Eps1D raises error if arrays not initialized.



.. py:class:: TestGetChi1Dqw

   Test 1D quantum wire susceptibility calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_get_chi1dqw_basic()

      Test GetChi1Dqw with basic inputs.



   .. py:method:: test_get_chi1dqw_zero_frequency()

      Test GetChi1Dqw with zero frequency.



   .. py:method:: test_get_chi1dqw_different_q()

      Test GetChi1Dqw with different momentum values.



   .. py:method:: test_get_chi1dqw_different_frequencies()

      Test GetChi1Dqw with different frequencies.



.. py:class:: TestGetEps1Dqw

   Test 1D quantum wire dielectric function calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_get_eps1dqw_basic()

      Test GetEps1Dqw with basic inputs.



   .. py:method:: test_get_eps1dqw_zero_frequency()

      Test GetEps1Dqw with zero frequency.



   .. py:method:: test_get_eps1dqw_small_q()

      Test GetEps1Dqw with small q (should use minimum).



   .. py:method:: test_get_eps1dqw_different_densities()

      Test GetEps1Dqw with different densities.



.. py:class:: TestCalcScreenedArrays

   Test screened Coulomb array calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_screened_arrays_unscreened()

      Test CalcScreenedArrays with screening disabled.



   .. py:method:: test_calc_screened_arrays_screened()

      Test CalcScreenedArrays with screening enabled.



   .. py:method:: test_calc_screened_arrays_error_if_not_initialized()

      Test that CalcScreenedArrays raises error if arrays not initialized.



.. py:class:: TestUndell

   Test UnDel array access wrapper.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_undell_valid_indices()

      Test undell with valid 1-based indices.



   .. py:method:: test_undell_diagonal()

      Test undell with diagonal indices (should be 0).



   .. py:method:: test_undell_zero_index()

      Test undell with zero index (should be 0).



   .. py:method:: test_undell_error_if_not_initialized()

      Test that undell raises error if UnDel not initialized.



.. py:class:: TestCalcMVeh

   Test MVeh array calculation for Semiconductor Bloch Equations.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_calc_mveh_basic()

      Test CalcMVeh with basic inputs.



   .. py:method:: test_calc_mveh_module_arrays()

      Test CalcMVeh using module-level arrays.



   .. py:method:: test_calc_mveh_error_if_not_initialized()

      Test that CalcMVeh raises error if arrays not initialized.



.. py:class:: TestBGRenorm

   Test band gap renormalization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_bg_renorm_basic()

      Test BGRenorm with basic inputs.



   .. py:method:: test_bg_renorm_module_array()

      Test BGRenorm using module-level UnDel.



   .. py:method:: test_bg_renorm_error_if_not_initialized()

      Test that BGRenorm raises error if UnDel not initialized.



.. py:class:: TestEeRenorm

   Test electron energy renormalization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_ee_renorm_basic()

      Test EeRenorm with basic inputs.



   .. py:method:: test_ee_renorm_module_array()

      Test EeRenorm using module-level UnDel.



.. py:class:: TestEhRenorm

   Test hole energy renormalization calculation.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_eh_renorm_basic()

      Test EhRenorm with basic inputs.



   .. py:method:: test_eh_renorm_module_array()

      Test EhRenorm using module-level UnDel.



.. py:class:: TestMBCE2

   Test many-body Coulomb in/out rates for electrons (version 2).


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_mbce2_basic()

      Test MBCE2 with basic inputs.



   .. py:method:: test_mbce2_module_arrays()

      Test MBCE2 using module-level arrays.



   .. py:method:: test_mbce2_error_if_not_initialized()

      Test that MBCE2 raises error if arrays not initialized.



.. py:class:: TestMBCE

   Test many-body Coulomb in/out rates for electrons.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_mbce_basic()

      Test MBCE with basic inputs.



   .. py:method:: test_mbce_identical_to_mbce2()

      Test that MBCE gives same results as MBCE2.



.. py:class:: TestMBCH

   Test many-body Coulomb in/out rates for holes.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_mbch_basic()

      Test MBCH with basic inputs.



   .. py:method:: test_mbch_module_arrays()

      Test MBCH using module-level arrays.



.. py:class:: TestInitializeCoulomb

   Test main initialization function.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_initialize_coulomb_basic()

      Test InitializeCoulomb with basic inputs.



   .. py:method:: test_initialize_coulomb_idempotent()

      Test that InitializeCoulomb is idempotent.



.. py:class:: TestIntegration

   Integration tests for complete workflows.


   .. py:method:: setup_method()

      Set up test fixtures.



   .. py:method:: test_full_initialization_workflow()

      Test complete initialization workflow.



   .. py:method:: test_screening_workflow()

      Test complete screening calculation workflow.



   .. py:method:: test_many_body_rates_workflow()

      Test complete many-body rates calculation workflow.



   .. py:method:: test_different_array_sizes(N)

      Test integration with different array sizes.



