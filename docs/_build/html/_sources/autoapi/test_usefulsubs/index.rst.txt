test_usefulsubs
===============

.. py:module:: test_usefulsubs

.. autoapi-nested-parse::

   Comprehensive test suite for usefulsubs.py module.

   Tests all utility functions including array flipping, FFT operations,
   derivatives, field manipulations, special functions, and I/O operations.



Classes
-------

.. autoapisummary::

   test_usefulsubs.TestArrayFlipping
   test_usefulsubs.TestDerivatives1D
   test_usefulsubs.TestDerivatives2D
   test_usefulsubs.TestDerivativesQSpace
   test_usefulsubs.TestGaussianFFT
   test_usefulsubs.TestFieldDerivatives
   test_usefulsubs.TestAbsorbingBoundaryConditions
   test_usefulsubs.TestFourierTransforms
   test_usefulsubs.TestFlipFunction
   test_usefulsubs.TestGetArray0Index
   test_usefulsubs.TestSpecialFunctions
   test_usefulsubs.TestEnergyFunctions
   test_usefulsubs.TestLorentzianAndStep
   test_usefulsubs.TestAngleConversion
   test_usefulsubs.TestFieldRotation
   test_usefulsubs.TestFieldShift
   test_usefulsubs.TestBesselFunctions
   test_usefulsubs.TestLocator
   test_usefulsubs.TestInterpolation
   test_usefulsubs.TestGaussianFunction
   test_usefulsubs.TestConvolve
   test_usefulsubs.TestFFTG
   test_usefulsubs.TestFileIO
   test_usefulsubs.TestFFTDerivativeIntegration
   test_usefulsubs.TestFieldRotationIntegration
   test_usefulsubs.TestFFTRoundTripIntegration
   test_usefulsubs.TestMaxwellFieldDerivatives
   test_usefulsubs.TestNumericalStability
   test_usefulsubs.TestPhysicalProperties


Module Contents
---------------

.. py:class:: TestArrayFlipping

   Test array flipping functions.


   .. py:method:: test_fflip_dp_simple()

      Test flipping real array with simple case.



   .. py:method:: test_fflip_dp_single_element()

      Test flipping single element array.



   .. py:method:: test_fflip_dp_even_length()

      Test flipping even length array.



   .. py:method:: test_fflip_dp_odd_length()

      Test flipping odd length array.



   .. py:method:: test_fflip_dpc_complex()

      Test flipping complex array.



   .. py:method:: test_fflip_dpc_single_element()

      Test flipping single element complex array.



.. py:class:: TestDerivatives1D

   Test 1D derivative functions using FFT.


   .. py:method:: test_dfdy1D_linear()

      Test derivative of periodic function (FFT assumes periodicity).



   .. py:method:: test_dfdy1D_quadratic()

      Test derivative of periodic function (FFT assumes periodicity).



   .. py:method:: test_dfdy1D_gaussian()

      Test derivative of Gaussian function (well-localized, minimal boundary effects).



   .. py:method:: test_dfdy1D_single_element()

      Test derivative with single element array.



   .. py:method:: test_dfdx1D_linear()

      Test x-derivative of periodic function (FFT assumes periodicity).



.. py:class:: TestDerivatives2D

   Test 2D derivative functions using FFT.


   .. py:method:: test_dfdy2D_constant()

      Test 2D derivative of constant function.



   .. py:method:: test_dfdy2D_linear()

      Test 2D derivative of periodic function in y (FFT assumes periodicity).



   .. py:method:: test_dfdx2D_linear()

      Test 2D derivative of periodic function in x (FFT assumes periodicity).



   .. py:method:: test_dfdy2D_single_element()

      Test 2D derivative with single element in y.



.. py:class:: TestDerivativesQSpace

   Test derivative functions in q-space (Fourier domain).


   .. py:method:: test_dfdy1D_q_simple()

      Test 1D q-space derivative.



   .. py:method:: test_dfdx1D_q_simple()

      Test 1D q-space derivative in x.



   .. py:method:: test_dfdy2D_q_simple()

      Test 2D q-space derivative in y.



   .. py:method:: test_dfdx2D_q_simple()

      Test 2D q-space derivative in x.



   .. py:method:: test_dfdy1D_q_single_element()

      Test q-space derivative with single element.



.. py:class:: TestGaussianFFT

   Test Gaussian-normalized FFT functions.


   .. py:method:: test_GFFT_1D_normalization()

      Test 1D Gaussian FFT normalization.



   .. py:method:: test_GIFFT_1D_normalization()

      Test 1D Gaussian IFFT normalization.



   .. py:method:: test_GFFT_GIFFT_1D_roundtrip()

      Test FFT-IFFT round trip with Gaussian normalization.



   .. py:method:: test_GFFT_2D_normalization()

      Test 2D Gaussian FFT normalization.



   .. py:method:: test_GIFFT_2D_normalization()

      Test 2D Gaussian IFFT normalization.



.. py:class:: TestFieldDerivatives

   Test electromagnetic field derivative functions.


   .. py:method:: test_dEdx_forward_difference()

      Test E field x-derivative with forward difference.



   .. py:method:: test_dEdy_forward_difference()

      Test E field y-derivative with forward difference.



   .. py:method:: test_dHdx_backward_difference()

      Test H field x-derivative with backward difference.



   .. py:method:: test_dHdy_backward_difference()

      Test H field y-derivative with backward difference.



   .. py:method:: test_dEdx_single_row()

      Test E field x-derivative with single row.



   .. py:method:: test_dEdy_single_column()

      Test E field y-derivative with single column.



.. py:class:: TestAbsorbingBoundaryConditions

   Test absorbing boundary condition application.


   .. py:method:: test_ApplyABC_simple()

      Test ABC application with simple coefficients.



   .. py:method:: test_ApplyABC_absorption()

      Test ABC absorption at boundaries.



.. py:class:: TestFourierTransforms

   Test direct Fourier transform implementations.


   .. py:method:: test_FT_IFT_roundtrip()

      Test FT-IFT round trip.



   .. py:method:: test_FT_gaussian()

      Test FT of Gaussian function.



.. py:class:: TestFlipFunction

   Test Flip function.


   .. py:method:: test_Flip_simple()

      Test Flip with simple array.



   .. py:method:: test_Flip_single_element()

      Test Flip with single element.



.. py:class:: TestGetArray0Index

   Test GetArray0Index function.


   .. py:method:: test_GetArray0Index_center()

      Test finding zero index in centered array.



   .. py:method:: test_GetArray0Index_offset()

      Test finding zero index in offset array.



   .. py:method:: test_GetArray0Index_not_found()

      Test error when zero not in array.



.. py:class:: TestSpecialFunctions

   Test special mathematical functions.


   .. py:method:: test_GaussDelta_scalar()

      Test Gaussian delta function with scalar.



   .. py:method:: test_GaussDelta_array()

      Test Gaussian delta function with array.



   .. py:method:: test_delta_at_zero()

      Test delta function at zero.



   .. py:method:: test_delta_away_from_zero()

      Test delta function away from zero.



   .. py:method:: test_kdel_at_zero()

      Test Kronecker delta at zero.



   .. py:method:: test_kdel_nonzero()

      Test Kronecker delta at nonzero.



   .. py:method:: test_delt_at_zero()

      Test delt function at zero.



   .. py:method:: test_delt_nonzero()

      Test delt function at nonzero.



   .. py:method:: test_sgn_positive()

      Test sign function for positive.



   .. py:method:: test_sgn_negative()

      Test sign function for negative.



   .. py:method:: test_sgn_zero()

      Test sign function for zero.



   .. py:method:: test_sgn2_array()

      Test sign function for array.



.. py:class:: TestEnergyFunctions

   Test energy and temperature calculation functions.


   .. py:method:: test_TotalEnergy_simple()

      Test total energy calculation.



   .. py:method:: test_AvgEnergy_simple()

      Test average energy calculation.



   .. py:method:: test_AvgEnergy_weighted()

      Test weighted average energy.



   .. py:method:: test_Temperature_simple()

      Test temperature calculation.



.. py:class:: TestLorentzianAndStep

   Test Lorentzian and step functions.


   .. py:method:: test_Lrtz_peak()

      Test Lorentzian at peak.



   .. py:method:: test_Lrtz_array()

      Test Lorentzian with array.



   .. py:method:: test_theta_negative()

      Test Heaviside step for negative.



   .. py:method:: test_theta_positive()

      Test Heaviside step for positive.



   .. py:method:: test_theta_array()

      Test Heaviside step with array.



   .. py:method:: test_softtheta_negative()

      Test soft step for negative.



   .. py:method:: test_softtheta_positive()

      Test soft step for positive.



   .. py:method:: test_softtheta_zero()

      Test soft step at zero.



.. py:class:: TestAngleConversion

   Test angle conversion.


   .. py:method:: test_rad_simple()

      Test degree to radian conversion.



   .. py:method:: test_rad_array()

      Test degree to radian with array.



.. py:class:: TestFieldRotation

   Test field rotation functions.


   .. py:method:: test_RotateField_90deg()

      Test 2D field rotation by 90 degrees.



   .. py:method:: test_RotateField_180deg()

      Test 2D field rotation by 180 degrees.



   .. py:method:: test_RotateField_360deg()

      Test 2D field rotation by 360 degrees.



   .. py:method:: test_RotateField3D_90deg()

      Test 3D field rotation by 90 degrees about y-axis.



   .. py:method:: test_RotateField3D_identity()

      Test 3D field rotation by 0 degrees.



.. py:class:: TestFieldShift

   Test field shifting function.


   .. py:method:: test_ShiftField_no_shift()

      Test field shift with zero displacement.



   .. py:method:: test_ShiftField_x_direction()

      Test field shift in x direction (LEFT shift to match Fortran Cshift).



.. py:class:: TestBesselFunctions

   Test modified Bessel functions.


   .. py:method:: test_cik01_real_small()

      Test Bessel functions for small real argument.



   .. py:method:: test_cik01_real_large()

      Test Bessel functions for large real argument.



   .. py:method:: test_cik01_complex()

      Test Bessel functions for complex argument.



   .. py:method:: test_cik01_zero()

      Test Bessel functions at zero.



   .. py:method:: test_K03_small()

      Test K0 function for small argument.



   .. py:method:: test_K03_large()

      Test K0 function for large argument.



.. py:class:: TestLocator

   Test locator function for finding insertion index.


   .. py:method:: test_locator_interior()

      Test locator for interior point.



   .. py:method:: test_locator_start()

      Test locator for point at start.



   .. py:method:: test_locator_end()

      Test locator for point at end.



   .. py:method:: test_locator_beyond_end()

      Test locator for point beyond end.



   .. py:method:: test_locator_before_start()

      Test locator for point before start.



.. py:class:: TestInterpolation

   Test interpolation functions.


   .. py:method:: test_EAtX_linear_interpolation()

      Test 2D interpolation at specified x.



   .. py:method:: test_EAtX_single_element()

      Test interpolation with single element.



   .. py:method:: test_EAtXYZ_trilinear()

      Test 3D trilinear interpolation.



   .. py:method:: test_EAtXYZ_corner()

      Test 3D interpolation at grid corner.



.. py:class:: TestGaussianFunction

   Test Gaussian function.


   .. py:method:: test_gaussian_peak()

      Test Gaussian at peak.



   .. py:method:: test_gaussian_array()

      Test Gaussian with array.



   .. py:method:: test_gaussian_decay()

      Test Gaussian decay.



.. py:class:: TestConvolve

   Test convolution function.


   .. py:method:: test_convolve_delta()

      Test convolution with delta function.



   .. py:method:: test_convolve_simple()

      Test convolution with simple kernel.



   .. py:method:: test_convolve_length()

      Test convolution output length.



.. py:class:: TestFFTG

   Test FFTG and iFFTG functions.


   .. py:method:: test_FFTG_normalization()

      Test FFTG normalization.



   .. py:method:: test_iFFTG_normalization()

      Test iFFTG normalization.



   .. py:method:: test_FFTG_iFFTG_roundtrip()

      Test FFTG-iFFTG round trip.



.. py:class:: TestFileIO

   Test file I/O functions.


   .. py:method:: setup_method()

      Set up temporary directory for each test.



   .. py:method:: teardown_method()

      Clean up temporary directory.



   .. py:method:: test_WriteIT1D_ReadIT1D()

      Test 1D array write and read.



   .. py:method:: test_WriteIT2D_ReadIT2D()

      Test 2D array write and read.



   .. py:method:: test_print2file()

      Test print2file function.



   .. py:method:: test_printIT()

      Test printIT function.



   .. py:method:: test_printITR()

      Test printITR function.



   .. py:method:: test_printIT2D()

      Test printIT2D function.



.. py:class:: TestFFTDerivativeIntegration

   Integration tests for FFT-based derivative calculations.


   .. py:method:: test_derivative_chain_1D()

      Test chain of derivative operations in 1D with periodic function.



   .. py:method:: test_derivative_2D_consistency()

      Test consistency between 1D and 2D derivatives.



.. py:class:: TestFieldRotationIntegration

   Integration tests for field rotation operations.


   .. py:method:: test_rotation_energy_conservation()

      Test that rotation conserves field energy.



   .. py:method:: test_rotation_3D_energy_conservation()

      Test that 3D rotation conserves field energy.



.. py:class:: TestFFTRoundTripIntegration

   Integration tests for FFT round-trip operations.


   .. py:method:: test_GFFT_workflow()

      Test complete workflow with Gaussian FFT.



   .. py:method:: test_2D_FFT_workflow()

      Test complete 2D FFT workflow.



.. py:class:: TestMaxwellFieldDerivatives

   Integration tests for Maxwell equation field derivatives.


   .. py:method:: test_curl_E_to_B()

      Test that curl of E field is computed correctly.



   .. py:method:: test_divergence_H_field()

      Test computation of field divergence.



.. py:class:: TestNumericalStability

   Test numerical stability of functions.


   .. py:method:: test_derivative_with_noise()

      Test derivative calculation with noisy data.



   .. py:method:: test_bessel_stability()

      Test Bessel function stability across range.



.. py:class:: TestPhysicalProperties

   Test that physical properties are preserved.


   .. py:method:: test_energy_conservation_ABC()

      Test that ABC reduces energy appropriately.



   .. py:method:: test_parseval_theorem()

      Test Parseval's theorem for FFT.



