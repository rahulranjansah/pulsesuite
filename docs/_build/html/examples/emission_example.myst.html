<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Spontaneous Emission and Photoluminescence in Quantum Wires &mdash; PulseSuite 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Phonon Interactions in Quantum Wires" href="phonons_example.myst.html" />
    <link rel="prev" title="DC Field Carrier Transport in Quantum Wires" href="dcfield_example.myst.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PulseSuite
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gallery.html">Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coulomb_example.myst.html">Coulomb Interactions in Quantum Wires</a></li>
<li class="toctree-l2"><a class="reference internal" href="dcfield_example.myst.html">DC Field Carrier Transport in Quantum Wires</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Spontaneous Emission and Photoluminescence in Quantum Wires</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#spontaneous-emission-rate">Spontaneous Emission Rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transition-energy">Transition Energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#photon-density-of-states">Photon Density of States</a></li>
<li class="toctree-l4"><a class="reference internal" href="#photoluminescence-spectrum">Photoluminescence Spectrum</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-initialization">Setup and Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialize-emission-module">Initialize Emission Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initial-carrier-distributions">Initial Carrier Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coulomb-energy-correction">Coulomb Energy Correction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spontaneous-emission-rates">Spontaneous Emission Rates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Photon Density of States</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Photoluminescence Spectrum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#temperature-dependence">Temperature Dependence</a></li>
<li class="toctree-l3"><a class="reference internal" href="#time-evolution-of-pl">Time Evolution of PL</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spontaneous-emission-integral">Spontaneous Emission Integral</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="phonons_example.myst.html">Phonon Interactions in Quantum Wires</a></li>
<li class="toctree-l2"><a class="reference internal" href="qwoptics_example.myst.html">Quantum Wire Optics and Field Conversion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PulseSuite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../gallery.html">Examples Gallery</a></li>
      <li class="breadcrumb-item active">Spontaneous Emission and Photoluminescence in Quantum Wires</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/emission_example.myst.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="spontaneous-emission-and-photoluminescence-in-quantum-wires">
<h1>Spontaneous Emission and Photoluminescence in Quantum Wires<a class="headerlink" href="#spontaneous-emission-and-photoluminescence-in-quantum-wires" title="Link to this heading"></a></h1>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Link to this heading"></a></h2>
<p>The emission module calculates spontaneous emission and photoluminescence (PL) from quantum wires. Spontaneous emission occurs when electron-hole pairs recombine radiatively, emitting photons.</p>
<section id="spontaneous-emission-rate">
<h3>Spontaneous Emission Rate<a class="headerlink" href="#spontaneous-emission-rate" title="Link to this heading"></a></h3>
<p>The spontaneous emission rate <span class="math notranslate nohighlight">\(R_{sp}(k)\)</span> for a momentum state <span class="math notranslate nohighlight">\(k\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[
R_{sp}(k) = \int_0^{\infty} d(\hbar\omega) \, (\hbar\omega + E_k) \, \rho_0(\hbar\omega + E_k) \, W(\hbar\omega)
\]</div>
<p>where <span class="math notranslate nohighlight">\(E_k\)</span> is the transition energy including many-body corrections, <span class="math notranslate nohighlight">\(\rho_0\)</span> is the photon density of states, and <span class="math notranslate nohighlight">\(W\)</span> is the emission probability.</p>
</section>
<section id="transition-energy">
<h3>Transition Energy<a class="headerlink" href="#transition-energy" title="Link to this heading"></a></h3>
<p>The transition energy includes Coulomb many-body corrections:</p>
<div class="math notranslate nohighlight">
\[
E_k = E_{gap} + E_e(k) + E_h(k) + E_c(k)
\]</div>
<p>where <span class="math notranslate nohighlight">\(E_c(k)\)</span> is the Coulomb energy correction due to electron-electron, hole-hole, and electron-hole interactions.</p>
</section>
<section id="photon-density-of-states">
<h3>Photon Density of States<a class="headerlink" href="#photon-density-of-states" title="Link to this heading"></a></h3>
<p>The photon density of states in free space is:</p>
<div class="math notranslate nohighlight">
\[
\rho_0(\hbar\omega) = \frac{(\hbar\omega)^2}{\pi^2 c^3 \hbar^3}
\]</div>
</section>
<section id="photoluminescence-spectrum">
<h3>Photoluminescence Spectrum<a class="headerlink" href="#photoluminescence-spectrum" title="Link to this heading"></a></h3>
<p>The PL spectrum <span class="math notranslate nohighlight">\(PLS(\hbar\omega)\)</span> accounts for carrier distributions, thermal broadening, and dephasing:</p>
<div class="math notranslate nohighlight">
\[
PLS(\hbar\omega) = R_{scale} \sum_k n_e(k) n_h(k) \, \hbar\omega \, \rho_0(\hbar\omega) \,
\exp\left(-\frac{|\hbar\omega - E_k|}{k_B T_{avg}}\right) \,
L(\hbar\omega - E_k, \hbar\gamma_{eh})
\]</div>
<p>where <span class="math notranslate nohighlight">\(L\)</span> is a Lorentzian lineshape, <span class="math notranslate nohighlight">\(T_{avg}\)</span> is the average carrier temperature, and <span class="math notranslate nohighlight">\(\gamma_{eh}\)</span> is the electron-hole dephasing rate.</p>
</section>
</section>
<section id="setup-and-initialization">
<h2>Setup and Initialization<a class="headerlink" href="#setup-and-initialization" title="Link to this heading"></a></h2>
<p>First, we import the necessary modules and set up the physical parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pulsesuite.PSTD3D</span><span class="w"> </span><span class="kn">import</span> <span class="n">emission</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">e</span> <span class="k">as</span> <span class="n">e0</span><span class="p">,</span> <span class="n">hbar</span><span class="p">,</span> <span class="n">k</span> <span class="k">as</span> <span class="n">kB</span>

<span class="c1"># Physical Parameters for GaAs Quantum Wire</span>
<span class="n">L_wire</span> <span class="o">=</span> <span class="mf">200e-9</span>          <span class="c1"># Wire length (m)</span>
<span class="n">N_k</span> <span class="o">=</span> <span class="mi">128</span>                <span class="c1"># Momentum grid points</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">0.067</span> <span class="o">*</span> <span class="mf">9.109e-31</span>  <span class="c1"># Electron effective mass (kg)</span>
<span class="n">m_h</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="o">*</span> <span class="mf">9.109e-31</span>   <span class="c1"># Hole effective mass (kg)</span>
<span class="n">gap</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">e0</span>           <span class="c1"># Band gap energy (J)</span>
<span class="n">dcv</span> <span class="o">=</span> <span class="mf">1.0e-29</span>            <span class="c1"># Dipole matrix element (C·m)</span>
<span class="n">epsr</span> <span class="o">=</span> <span class="mf">12.0</span>              <span class="c1"># Relative dielectric constant</span>
<span class="n">geh</span> <span class="o">=</span> <span class="mf">1e12</span>               <span class="c1"># Electron-hole dephasing rate (Hz)</span>
<span class="n">ehint</span> <span class="o">=</span> <span class="mf">0.8</span>              <span class="c1"># Electron-hole interaction strength</span>
<span class="n">Temp</span> <span class="o">=</span> <span class="mf">77.0</span>              <span class="c1"># Temperature (K)</span>

<span class="c1"># Initialize Momentum Grid</span>
<span class="n">k_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">5e8</span><span class="p">,</span> <span class="mf">5e8</span><span class="p">,</span> <span class="n">N_k</span><span class="p">)</span>  <span class="c1"># Momentum grid (1/m)</span>
<span class="n">dk</span> <span class="o">=</span> <span class="n">k_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">k_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Single-particle energies</span>
<span class="n">E_e</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">)</span>
<span class="n">E_h</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m_h</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Momentum grid: </span><span class="si">{</span><span class="n">k_grid</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">k_grid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Band gap: </span><span class="si">{</span><span class="n">gap</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temperature: </span><span class="si">{</span><span class="n">Temp</span><span class="si">}</span><span class="s2"> K&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="initialize-emission-module">
<h2>Initialize Emission Module<a class="headerlink" href="#initialize-emission-module" title="Link to this heading"></a></h2>
<p>We initialize the emission module, which sets up internal arrays and pre-calculates integration parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initialize Emission Module</span>
<span class="n">emission</span><span class="o">.</span><span class="n">InitializeEmission</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">dcv</span><span class="p">,</span> <span class="n">epsr</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">ehint</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Emission module initialized&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RScale factor: </span><span class="si">{</span><span class="n">emission</span><span class="o">.</span><span class="n">_RScale</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">InitializeEmission</span></code> function sets up:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">_idel</span></code> matrix (1 - identity) for Coulomb calculations</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_RScale</span></code> factor for emission rate scaling</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_HOmega</span></code> array for numerical integration</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">_square</span></code> array for pre-calculated emission integrals</p></li>
</ul>
</div>
</section>
<section id="initial-carrier-distributions">
<h2>Initial Carrier Distributions<a class="headerlink" href="#initial-carrier-distributions" title="Link to this heading"></a></h2>
<p>We create initial carrier distributions for electrons and holes. These represent excited carriers that can recombine radiatively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial Electron Distribution (Gaussian centered at k=0)</span>
<span class="n">sigma_k</span> <span class="o">=</span> <span class="mf">1e8</span>
<span class="n">n_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma_k</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
<span class="n">n_e</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_e</span><span class="p">)</span>  <span class="c1"># Normalize</span>

<span class="c1"># Initial Hole Distribution</span>
<span class="n">n_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma_k</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
<span class="n">n_h</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_h</span><span class="p">)</span>  <span class="c1"># Normalize</span>

<span class="c1"># Coulomb interaction matrices (simplified - constant for this demo)</span>
<span class="n">N_k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">k_grid</span><span class="p">)</span>
<span class="n">VC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_k</span><span class="p">,</span> <span class="n">N_k</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="c1"># For realistic simulations, these would be calculated from Coulomb module</span>
<span class="n">VC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-20</span>  <span class="c1"># Electron-hole (simplified)</span>
<span class="n">VC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-20</span>  <span class="c1"># Electron-electron (simplified)</span>
<span class="n">VC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-20</span>  <span class="c1"># Hole-hole (simplified)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial electron density: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial hole density: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="coulomb-energy-correction">
<h2>Coulomb Energy Correction<a class="headerlink" href="#coulomb-energy-correction" title="Link to this heading"></a></h2>
<p>The Coulomb energy correction accounts for many-body effects on transition energies.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate Coulomb energy correction</span>
<span class="n">Ec_correction</span> <span class="o">=</span> <span class="n">emission</span><span class="o">.</span><span class="n">Ec</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">),</span> <span class="n">VC</span><span class="p">)</span>

<span class="c1"># Transition energies with and without Coulomb correction</span>
<span class="n">E_transition</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">+</span> <span class="n">E_e</span> <span class="o">+</span> <span class="n">E_h</span>
<span class="n">E_transition_corrected</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">+</span> <span class="n">E_e</span> <span class="o">+</span> <span class="n">E_h</span> <span class="o">+</span> <span class="n">Ec_correction</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Coulomb correction range: </span><span class="si">{</span><span class="n">Ec_correction</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">Ec_correction</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> meV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transition energy range (no correction): </span><span class="si">{</span><span class="n">E_transition</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">E_transition</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Transition energy range (with correction): </span><span class="si">{</span><span class="n">E_transition_corrected</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">E_transition_corrected</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="spontaneous-emission-rates">
<h2>Spontaneous Emission Rates<a class="headerlink" href="#spontaneous-emission-rates" title="Link to this heading"></a></h2>
<p>We calculate the spontaneous emission rate for each momentum state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate spontaneous emission rates</span>
<span class="n">Rsp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span>

<span class="n">emission</span><span class="o">.</span><span class="n">SpontEmission</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">n_h</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">Rsp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Spontaneous emission rate range: </span><span class="si">{</span><span class="n">Rsp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">Rsp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> s^-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total emission rate: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">Rsp</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> s^-1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>Photon Density of States<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>The photon density of states determines the available photon modes for emission.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate photon density of states for a range of energies</span>
<span class="n">hw_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">gap</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">gap</span> <span class="o">*</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">rho_photon</span> <span class="o">=</span> <span class="n">emission</span><span class="o">.</span><span class="n">rho0</span><span class="p">(</span><span class="n">hw_range</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hw_range</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">rho_photon</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Photon Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Photon Density of States (1/(J·m³))&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Photon Density of States&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id2">
<h2>Photoluminescence Spectrum<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>We calculate the full photoluminescence spectrum as a function of photon energy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up photon energy array for PL spectrum</span>
<span class="n">N_w</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># Number of energy points</span>
<span class="n">hw_PL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_w</span><span class="p">)</span>
<span class="n">PLS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_w</span><span class="p">)</span>

<span class="c1"># Energy range for PL spectrum (around band gap)</span>
<span class="n">E_start</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">*</span> <span class="mf">0.95</span>
<span class="n">E_max</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">*</span> <span class="mf">1.15</span>

<span class="n">emission</span><span class="o">.</span><span class="n">Calchw</span><span class="p">(</span><span class="n">hw_PL</span><span class="p">,</span> <span class="n">PLS</span><span class="p">,</span> <span class="n">E_start</span><span class="p">,</span> <span class="n">E_max</span><span class="p">)</span>

<span class="c1"># Calculate PL spectrum at time t = 0</span>
<span class="n">t</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">emission</span><span class="o">.</span><span class="n">PLSpectrum</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">n_h</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">hw_PL</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">PLS</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PL spectrum calculated&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak PL intensity: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">PLS</span><span class="p">)</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Peak energy: </span><span class="si">{</span><span class="n">hw_PL</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">PLS</span><span class="p">)]</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> meV&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h2>
<p>We visualize the carrier distributions, emission rates, and PL spectrum.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Carrier distributions</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n_e(k)$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$n_h(k)$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Occupation&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Carrier Distributions&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Spontaneous emission rates</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">Rsp</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Emission Rate (s$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Spontaneous Emission Rates&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Transition energies</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_transition</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Without Coulomb&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_transition_corrected</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;With Coulomb&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Transition Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Transition Energies&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Photoluminescence spectrum</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hw_PL</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">PLS</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Photon Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;PL Intensity (arb. u.)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Photoluminescence Spectrum&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">gap</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Band Gap&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The PL spectrum shows a peak near the band gap energy. The width and shape depend on:</p>
<ul class="simple">
<li><p>Carrier temperature (thermal broadening)</p></li>
<li><p>Dephasing rate (Lorentzian broadening)</p></li>
<li><p>Coulomb interactions (energy renormalization)</p></li>
<li><p>Carrier distributions (occupation factors)</p></li>
</ul>
</div>
</section>
<section id="temperature-dependence">
<h2>Temperature Dependence<a class="headerlink" href="#temperature-dependence" title="Link to this heading"></a></h2>
<p>We investigate how the PL spectrum changes with temperature by modifying the temperature parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate PL spectra at different temperatures</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">77.0</span><span class="p">,</span> <span class="mf">150.0</span><span class="p">,</span> <span class="mf">300.0</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">T</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">temperatures</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="c1"># Update temperature (this would normally be done through InitializeEmission)</span>
    <span class="c1"># For this demo, we&#39;ll recalculate with different thermal factors</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">_Temp</span> <span class="o">=</span> <span class="n">T</span>

    <span class="c1"># Re-initialize to update temperature-dependent arrays</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">InitializeEmission</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">dcv</span><span class="p">,</span> <span class="n">epsr</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">ehint</span><span class="p">)</span>

    <span class="c1"># Recalculate PL spectrum</span>
    <span class="n">PLS_T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_w</span><span class="p">)</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">Calchw</span><span class="p">(</span><span class="n">hw_PL</span><span class="p">,</span> <span class="n">PLS_T</span><span class="p">,</span> <span class="n">E_start</span><span class="p">,</span> <span class="n">E_max</span><span class="p">)</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">PLSpectrum</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">n_h</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">hw_PL</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">PLS_T</span><span class="p">)</span>

    <span class="c1"># Normalize for comparison</span>
    <span class="n">PLS_T</span> <span class="o">=</span> <span class="n">PLS_T</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">PLS_T</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">PLS_T</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">PLS_T</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hw_PL</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">PLS_T</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;T = </span><span class="si">{</span><span class="n">T</span><span class="si">}</span><span class="s1"> K&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Photon Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized PL Intensity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature-Dependent Photoluminescence&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>At higher temperatures, the PL spectrum broadens due to increased thermal energy. The peak may also shift slightly due to temperature-dependent band gap renormalization.</p>
</div>
</section>
<section id="time-evolution-of-pl">
<h2>Time Evolution of PL<a class="headerlink" href="#time-evolution-of-pl" title="Link to this heading"></a></h2>
<p>We can track how the PL spectrum evolves in time as carriers recombine.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulate time evolution (simplified - in real simulations, carriers would evolve)</span>
<span class="n">times</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="mf">5e-12</span><span class="p">,</span> <span class="mf">10e-12</span><span class="p">]</span>  <span class="c1"># Time points (s)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t_val</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="c1"># For this demo, we&#39;ll use the same distributions but different times</span>
    <span class="c1"># In real simulations, n_e and n_h would evolve according to SBEs</span>
    <span class="n">PLS_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_w</span><span class="p">)</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">Calchw</span><span class="p">(</span><span class="n">hw_PL</span><span class="p">,</span> <span class="n">PLS_t</span><span class="p">,</span> <span class="n">E_start</span><span class="p">,</span> <span class="n">E_max</span><span class="p">)</span>
    <span class="n">emission</span><span class="o">.</span><span class="n">PLSpectrum</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">n_h</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">geh</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">hw_PL</span><span class="p">,</span> <span class="n">t_val</span><span class="p">,</span> <span class="n">PLS_t</span><span class="p">)</span>

    <span class="c1"># Normalize for comparison</span>
    <span class="n">PLS_t</span> <span class="o">=</span> <span class="n">PLS_t</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">PLS_t</span><span class="p">)</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">PLS_t</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">PLS_t</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hw_PL</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">PLS_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;t = </span><span class="si">{</span><span class="n">t_val</span><span class="o">*</span><span class="mf">1e12</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> ps&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Photon Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized PL Intensity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Time Evolution of Photoluminescence&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="spontaneous-emission-integral">
<h2>Spontaneous Emission Integral<a class="headerlink" href="#spontaneous-emission-integral" title="Link to this heading"></a></h2>
<p>The spontaneous emission integral is calculated numerically using pre-computed arrays. Let’s examine how it depends on transition energy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate spontaneous emission integral for different transition energies</span>
<span class="n">E_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">gap</span> <span class="o">*</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">gap</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">Rsp_integral</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">E_test</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">E_val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">E_test</span><span class="p">):</span>
    <span class="n">Rsp_integral</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">emission</span><span class="o">.</span><span class="n">SpontIntegral</span><span class="p">(</span><span class="n">E_val</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_test</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="n">Rsp_integral</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Transition Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Spontaneous Emission Integral&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Emission Integral vs Transition Energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<p>This example demonstrated:</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong> of the emission module with physical parameters</p></li>
<li><p><strong>Coulomb energy corrections</strong> accounting for many-body effects</p></li>
<li><p><strong>Spontaneous emission rates</strong> calculation for each momentum state</p></li>
<li><p><strong>Photoluminescence spectrum</strong> as a function of photon energy</p></li>
<li><p><strong>Temperature dependence</strong> of PL spectra</p></li>
<li><p><strong>Time evolution</strong> of emission processes</p></li>
<li><p><strong>Photon density of states</strong> and its role in emission</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">emission</span></code> module provides a comprehensive framework for calculating radiative recombination processes in quantum wires, including spontaneous emission and photoluminescence with many-body Coulomb corrections and thermal effects.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dcfield_example.myst.html" class="btn btn-neutral float-left" title="DC Field Carrier Transport in Quantum Wires" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="phonons_example.myst.html" class="btn btn-neutral float-right" title="Phonon Interactions in Quantum Wires" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, PulseSuite Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>