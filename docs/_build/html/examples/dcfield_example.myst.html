<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DC Field Carrier Transport in Quantum Wires &mdash; PulseSuite 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spontaneous Emission and Photoluminescence in Quantum Wires" href="emission_example.myst.html" />
    <link rel="prev" title="Coulomb Interactions in Quantum Wires" href="coulomb_example.myst.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            PulseSuite
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../integrations.html">Integrations</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gallery.html">Examples Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="coulomb_example.myst.html">Coulomb Interactions in Quantum Wires</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">DC Field Carrier Transport in Quantum Wires</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#theory">Theory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#energy-renormalization">Energy Renormalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="#drift-velocity">Drift Velocity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#phonon-assisted-drift-force">Phonon-Assisted Drift Force</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setup-and-initialization">Setup and Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initial-carrier-distributions">Initial Carrier Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculating-dc-field-contributions">Calculating DC Field Contributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#current-calculation">Current Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualization">Visualization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#comparison-fft-vs-finite-difference-methods">Comparison: FFT vs Finite Difference Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="#drift-velocity-evolution">Drift Velocity Evolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Energy Renormalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="emission_example.myst.html">Spontaneous Emission and Photoluminescence in Quantum Wires</a></li>
<li class="toctree-l2"><a class="reference internal" href="phonons_example.myst.html">Phonon Interactions in Quantum Wires</a></li>
<li class="toctree-l2"><a class="reference internal" href="qwoptics_example.myst.html">Quantum Wire Optics and Field Conversion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PulseSuite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../gallery.html">Examples Gallery</a></li>
      <li class="breadcrumb-item active">DC Field Carrier Transport in Quantum Wires</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/examples/dcfield_example.myst.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="dc-field-carrier-transport-in-quantum-wires">
<h1>DC Field Carrier Transport in Quantum Wires<a class="headerlink" href="#dc-field-carrier-transport-in-quantum-wires" title="Link to this heading"></a></h1>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Link to this heading"></a></h2>
<p>The DC field transport module calculates the contribution of an applied electric field to the Semiconductor Bloch Equations (SBEs). The evolution of carrier distributions <span class="math notranslate nohighlight">\(f_{e/h}(k)\)</span> includes a drift term:</p>
<div class="math notranslate nohighlight">
\[
\left. \frac{\partial f}{\partial t} \right|_{DC} = -\frac{1}{\hbar} (-q E_{dc} - F_{drift}) \frac{\partial f}{\partial k}
\]</div>
<p>where <span class="math notranslate nohighlight">\(q = -e\)</span> for electrons and <span class="math notranslate nohighlight">\(q = +e\)</span> for holes, <span class="math notranslate nohighlight">\(E_{dc}\)</span> is the DC electric field, and <span class="math notranslate nohighlight">\(F_{drift}\)</span> is the drift force due to phonon interactions.</p>
<section id="energy-renormalization">
<h3>Energy Renormalization<a class="headerlink" href="#energy-renormalization" title="Link to this heading"></a></h3>
<p>The renormalized energy includes many-body Hartree-Fock corrections:</p>
<div class="math notranslate nohighlight">
\[
E_c(k) = E_n(k) + \frac{1}{2}\sum_{k'} f(k') \left[ V(k,k) - V(k,k') \right]
\]</div>
</section>
<section id="drift-velocity">
<h3>Drift Velocity<a class="headerlink" href="#drift-velocity" title="Link to this heading"></a></h3>
<p>The average drift velocity is calculated from the energy gradient:</p>
<div class="math notranslate nohighlight">
\[
v_{drift} = \frac{\sum_k \frac{dE_c}{dk}(k) \cdot f(k)}{\hbar \sum_k f(k)}
\]</div>
</section>
<section id="phonon-assisted-drift-force">
<h3>Phonon-Assisted Drift Force<a class="headerlink" href="#phonon-assisted-drift-force" title="Link to this heading"></a></h3>
<p>The drift force <span class="math notranslate nohighlight">\(F_{drift}(k)\)</span> accounts for phonon emission and absorption:</p>
<div class="math notranslate nohighlight">
\[
F_{drift}(k) = \sum_q \hbar k \cdot \left[ \Gamma_{em}(k,q) - \Gamma_{abs}(k,q) \right]
\]</div>
<p>where <span class="math notranslate nohighlight">\(\Gamma_{em}\)</span> and <span class="math notranslate nohighlight">\(\Gamma_{abs}\)</span> are the emission and absorption rates computed using Lorentzian line shapes.</p>
</section>
</section>
<section id="setup-and-initialization">
<h2>Setup and Initialization<a class="headerlink" href="#setup-and-initialization" title="Link to this heading"></a></h2>
<p>First, we import the necessary modules and set up the physical parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pulsesuite.PSTD3D</span><span class="w"> </span><span class="kn">import</span> <span class="n">dcfield</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.constants</span><span class="w"> </span><span class="kn">import</span> <span class="n">e</span> <span class="k">as</span> <span class="n">e0</span><span class="p">,</span> <span class="n">hbar</span>

<span class="c1"># Physical Parameters for GaAs Quantum Wire</span>
<span class="n">L_wire</span> <span class="o">=</span> <span class="mf">200e-9</span>          <span class="c1"># Wire length (m)</span>
<span class="n">N_k</span> <span class="o">=</span> <span class="mi">256</span>                <span class="c1"># Momentum grid points</span>
<span class="n">m_e</span> <span class="o">=</span> <span class="mf">0.067</span> <span class="o">*</span> <span class="mf">9.109e-31</span>  <span class="c1"># Electron effective mass (kg)</span>
<span class="n">m_h</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="o">*</span> <span class="mf">9.109e-31</span>   <span class="c1"># Hole effective mass (kg)</span>
<span class="n">E_phonon</span> <span class="o">=</span> <span class="mf">0.036</span> <span class="o">*</span> <span class="n">e0</span>    <span class="c1"># LO Phonon energy (~36 meV)</span>
<span class="n">E_dc</span> <span class="o">=</span> <span class="mf">5e4</span>               <span class="c1"># Applied DC Field (50 kV/cm)</span>
<span class="n">gamma_e</span> <span class="o">=</span> <span class="mf">1e12</span>           <span class="c1"># Electron scattering rate (Hz)</span>
<span class="n">gamma_h</span> <span class="o">=</span> <span class="mf">1e12</span>           <span class="c1"># Hole scattering rate (Hz)</span>
<span class="n">N0_phonon</span> <span class="o">=</span> <span class="mf">0.0</span>          <span class="c1"># Phonon occupation (T=0 K)</span>

<span class="c1"># Initialize Momentum Grid</span>
<span class="n">k_grid</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">GetKArray</span><span class="p">(</span><span class="n">N_k</span><span class="p">,</span> <span class="n">L_wire</span><span class="p">)</span>
<span class="n">dk</span> <span class="o">=</span> <span class="n">k_grid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">k_grid</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Momentum grid: </span><span class="si">{</span><span class="n">k_grid</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">k_grid</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Grid spacing: </span><span class="si">{</span><span class="n">dk</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m^-1&quot;</span><span class="p">)</span>

<span class="c1"># Initialize DC Field Module</span>
<span class="n">dcfield</span><span class="o">.</span><span class="n">InitializeDC</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">m_e</span><span class="p">,</span> <span class="n">m_h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DC field module initialized&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="initial-carrier-distributions">
<h2>Initial Carrier Distributions<a class="headerlink" href="#initial-carrier-distributions" title="Link to this heading"></a></h2>
<p>We create initial Gaussian distributions for electrons and holes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial Electron Distribution (Gaussian centered at k=0)</span>
<span class="n">sigma_k</span> <span class="o">=</span> <span class="mf">2e8</span>
<span class="n">n_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma_k</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
<span class="n">n_e</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_e</span><span class="p">)</span>  <span class="c1"># Normalize</span>

<span class="c1"># Initial Hole Distribution</span>
<span class="n">n_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">sigma_k</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">0</span><span class="n">j</span>
<span class="n">n_h</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_h</span><span class="p">)</span>  <span class="c1"># Normalize</span>

<span class="c1"># Single-particle energies</span>
<span class="n">E_e</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m_e</span><span class="p">)</span>
<span class="n">E_h</span> <span class="o">=</span> <span class="n">hbar</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m_h</span><span class="p">)</span>

<span class="c1"># Interaction matrices (simplified - no Coulomb for this demo)</span>
<span class="n">V_ee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_k</span><span class="p">,</span> <span class="n">N_k</span><span class="p">))</span>
<span class="n">V_hh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_k</span><span class="p">,</span> <span class="n">N_k</span><span class="p">))</span>

<span class="c1"># Phonon coupling constant (momentum-dependent)</span>
<span class="n">C_q2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-18</span>   <span class="c1"># Constant coupling for simplicity</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial electron density: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial hole density: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">))</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="calculating-dc-field-contributions">
<h2>Calculating DC Field Contributions<a class="headerlink" href="#calculating-dc-field-contributions" title="Link to this heading"></a></h2>
<p>We compute the DC field contribution to the electron distribution evolution using the finite difference method (<code class="docutils literal notranslate"><span class="pre">CalcDCE2</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Output arrays for DC contributions</span>
<span class="n">DC_e</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span>
<span class="n">DC_h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span>

<span class="c1"># Time step and iteration indices</span>
<span class="n">n_step</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Calculate DC field contribution for electrons</span>
<span class="n">dcfield</span><span class="o">.</span><span class="n">CalcDCE2</span><span class="p">(</span>
    <span class="n">DCTrans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># Enable DC transport</span>
    <span class="n">ky</span><span class="o">=</span><span class="n">k_grid</span><span class="p">,</span>
    <span class="n">Cq2</span><span class="o">=</span><span class="n">C_q2</span><span class="p">,</span>
    <span class="n">Edc</span><span class="o">=</span><span class="n">E_dc</span><span class="p">,</span>
    <span class="n">me</span><span class="o">=</span><span class="n">m_e</span><span class="p">,</span>
    <span class="n">ge</span><span class="o">=</span><span class="n">gamma_e</span><span class="p">,</span>
    <span class="n">Ephn</span><span class="o">=</span><span class="n">E_phonon</span><span class="p">,</span>
    <span class="n">N0</span><span class="o">=</span><span class="n">N0_phonon</span><span class="p">,</span>
    <span class="n">ne</span><span class="o">=</span><span class="n">n_e</span><span class="p">,</span>
    <span class="n">Ee</span><span class="o">=</span><span class="n">E_e</span><span class="p">,</span>
    <span class="n">Vee</span><span class="o">=</span><span class="n">V_ee</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n_step</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="n">iteration</span><span class="p">,</span>
    <span class="n">DC</span><span class="o">=</span><span class="n">DC_e</span>
<span class="p">)</span>

<span class="c1"># Calculate DC field contribution for holes</span>
<span class="n">dcfield</span><span class="o">.</span><span class="n">CalcDCH2</span><span class="p">(</span>
    <span class="n">DCTrans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>        <span class="c1"># Enable DC transport</span>
    <span class="n">ky</span><span class="o">=</span><span class="n">k_grid</span><span class="p">,</span>
    <span class="n">Cq2</span><span class="o">=</span><span class="n">C_q2</span><span class="p">,</span>
    <span class="n">Edc</span><span class="o">=</span><span class="n">E_dc</span><span class="p">,</span>
    <span class="n">mh</span><span class="o">=</span><span class="n">m_h</span><span class="p">,</span>
    <span class="n">gh</span><span class="o">=</span><span class="n">gamma_h</span><span class="p">,</span>
    <span class="n">Ephn</span><span class="o">=</span><span class="n">E_phonon</span><span class="p">,</span>
    <span class="n">N0</span><span class="o">=</span><span class="n">N0_phonon</span><span class="p">,</span>
    <span class="n">nh</span><span class="o">=</span><span class="n">n_h</span><span class="p">,</span>
    <span class="n">Eh</span><span class="o">=</span><span class="n">E_h</span><span class="p">,</span>
    <span class="n">Vhh</span><span class="o">=</span><span class="n">V_hh</span><span class="p">,</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n_step</span><span class="p">,</span>
    <span class="n">j</span><span class="o">=</span><span class="n">iteration</span><span class="p">,</span>
    <span class="n">DC</span><span class="o">=</span><span class="n">DC_h</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron drift rate: </span><span class="si">{</span><span class="n">dcfield</span><span class="o">.</span><span class="n">GetEDrift</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hole drift rate: </span><span class="si">{</span><span class="n">dcfield</span><span class="o">.</span><span class="n">GetHDrift</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> Hz&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron drift velocity: </span><span class="si">{</span><span class="n">dcfield</span><span class="o">.</span><span class="n">GetVEDrift</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hole drift velocity: </span><span class="si">{</span><span class="n">dcfield</span><span class="o">.</span><span class="n">GetVHDrift</span><span class="p">()</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="current-calculation">
<h2>Current Calculation<a class="headerlink" href="#current-calculation" title="Link to this heading"></a></h2>
<p>We calculate the total current from the carrier distributions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate electron current</span>
<span class="n">I_e</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcI0n</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">m_e</span><span class="p">,</span> <span class="n">k_grid</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron current: </span><span class="si">{</span><span class="n">I_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>

<span class="c1"># Calculate total current (requires interaction matrix structure)</span>
<span class="c1"># For this demo, we use a simplified version</span>
<span class="n">VC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">N_k</span><span class="p">,</span> <span class="n">N_k</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">VC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_ee</span>  <span class="c1"># Electron-electron</span>
<span class="n">VC</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_hh</span>  <span class="c1"># Hole-hole</span>

<span class="n">I_total</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcI0</span><span class="p">(</span><span class="n">n_e</span><span class="p">,</span> <span class="n">n_h</span><span class="p">,</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">dk</span><span class="p">,</span> <span class="n">k_grid</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total current: </span><span class="si">{</span><span class="n">I_total</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> A&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualization">
<h2>Visualization<a class="headerlink" href="#visualization" title="Link to this heading"></a></h2>
<p>We visualize the initial distributions and the DC field contributions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Electron distribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_e(k)$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Occupation&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Initial Electron Distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Electron DC contribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">DC_e</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">partial f_e/</span><span class="se">\\</span><span class="s1">partial t$ (DC)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rate of Change (s$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;DC Field Contribution (Electrons)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Hole distribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f_h(k)$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Occupation&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Initial Hole Distribution&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Hole DC contribution</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">DC_h</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">partial f_h/</span><span class="se">\\</span><span class="s1">partial t$ (DC)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rate of Change (s$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;DC Field Contribution (Holes)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The DC contribution shows the rate of change of the distribution. For electrons, the negative charge means they drift opposite to the field direction. The asymmetry in the DC contribution indicates the direction of carrier drift.</p>
</div>
</section>
<section id="comparison-fft-vs-finite-difference-methods">
<h2>Comparison: FFT vs Finite Difference Methods<a class="headerlink" href="#comparison-fft-vs-finite-difference-methods" title="Link to this heading"></a></h2>
<p>The module provides two implementations: <code class="docutils literal notranslate"><span class="pre">CalcDCE</span></code>/<code class="docutils literal notranslate"><span class="pre">CalcDCH</span></code> (FFT-based) and <code class="docutils literal notranslate"><span class="pre">CalcDCE2</span></code>/<code class="docutils literal notranslate"><span class="pre">CalcDCH2</span></code> (finite difference). Let’s compare them.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># FFT-based method</span>
<span class="n">DC_e_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span>
<span class="n">DC_h_fft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">N_k</span><span class="p">)</span>

<span class="n">dcfield</span><span class="o">.</span><span class="n">CalcDCE</span><span class="p">(</span>
    <span class="n">DCTrans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ky</span><span class="o">=</span><span class="n">k_grid</span><span class="p">,</span>
    <span class="n">Cq2</span><span class="o">=</span><span class="n">C_q2</span><span class="p">,</span>
    <span class="n">Edc</span><span class="o">=</span><span class="n">E_dc</span><span class="p">,</span>
    <span class="n">me</span><span class="o">=</span><span class="n">m_e</span><span class="p">,</span>
    <span class="n">ge</span><span class="o">=</span><span class="n">gamma_e</span><span class="p">,</span>
    <span class="n">Ephn</span><span class="o">=</span><span class="n">E_phonon</span><span class="p">,</span>
    <span class="n">N0</span><span class="o">=</span><span class="n">N0_phonon</span><span class="p">,</span>
    <span class="n">ne</span><span class="o">=</span><span class="n">n_e</span><span class="p">,</span>
    <span class="n">Ee</span><span class="o">=</span><span class="n">E_e</span><span class="p">,</span>
    <span class="n">Vee</span><span class="o">=</span><span class="n">V_ee</span><span class="p">,</span>
    <span class="n">DC</span><span class="o">=</span><span class="n">DC_e_fft</span>
<span class="p">)</span>

<span class="n">dcfield</span><span class="o">.</span><span class="n">CalcDCH</span><span class="p">(</span>
    <span class="n">DCTrans</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ky</span><span class="o">=</span><span class="n">k_grid</span><span class="p">,</span>
    <span class="n">Cq2</span><span class="o">=</span><span class="n">C_q2</span><span class="p">,</span>
    <span class="n">Edc</span><span class="o">=</span><span class="n">E_dc</span><span class="p">,</span>
    <span class="n">mh</span><span class="o">=</span><span class="n">m_h</span><span class="p">,</span>
    <span class="n">gh</span><span class="o">=</span><span class="n">gamma_h</span><span class="p">,</span>
    <span class="n">Ephn</span><span class="o">=</span><span class="n">E_phonon</span><span class="p">,</span>
    <span class="n">N0</span><span class="o">=</span><span class="n">N0_phonon</span><span class="p">,</span>
    <span class="n">nh</span><span class="o">=</span><span class="n">n_h</span><span class="p">,</span>
    <span class="n">Eh</span><span class="o">=</span><span class="n">E_h</span><span class="p">,</span>
    <span class="n">Vhh</span><span class="o">=</span><span class="n">V_hh</span><span class="p">,</span>
    <span class="n">DC</span><span class="o">=</span><span class="n">DC_h_fft</span>
<span class="p">)</span>

<span class="c1"># Compare the two methods</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">DC_e</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Finite Difference&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">DC_e_fft</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FFT-based&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Rate of Change (s$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electron DC Contribution: Method Comparison&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">DC_e</span> <span class="o">-</span> <span class="n">DC_e_fft</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Absolute Difference&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference Between Methods&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The finite difference method (<code class="docutils literal notranslate"><span class="pre">CalcDCE2</span></code>/<code class="docutils literal notranslate"><span class="pre">CalcDCH2</span></code>) is generally more stable and easier to debug, while the FFT method (<code class="docutils literal notranslate"><span class="pre">CalcDCE</span></code>/<code class="docutils literal notranslate"><span class="pre">CalcDCH</span></code>) can be faster for large grids but may have boundary effects.</p>
</div>
</section>
<section id="drift-velocity-evolution">
<h2>Drift Velocity Evolution<a class="headerlink" href="#drift-velocity-evolution" title="Link to this heading"></a></h2>
<p>We can track how the drift velocity changes with the distribution. Let’s calculate it directly from the distribution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate drift velocity from distribution</span>
<span class="n">v_e_dist</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcVD</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">m_e</span><span class="p">,</span> <span class="n">n_e</span><span class="p">)</span>
<span class="n">v_h_dist</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcVD</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">m_h</span><span class="p">,</span> <span class="n">n_h</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron drift velocity (from distribution): </span><span class="si">{</span><span class="n">v_e_dist</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hole drift velocity (from distribution): </span><span class="si">{</span><span class="n">v_h_dist</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> m/s&quot;</span><span class="p">)</span>

<span class="c1"># Calculate average momentum</span>
<span class="n">p_e</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcPD</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">m_e</span><span class="p">,</span> <span class="n">n_e</span><span class="p">)</span>
<span class="n">p_h</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">CalcPD</span><span class="p">(</span><span class="n">k_grid</span><span class="p">,</span> <span class="n">m_h</span><span class="p">,</span> <span class="n">n_h</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Electron average momentum: </span><span class="si">{</span><span class="n">p_e</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> kg·m/s&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Hole average momentum: </span><span class="si">{</span><span class="n">p_h</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> kg·m/s&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id1">
<h2>Energy Renormalization<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>The module includes energy renormalization to account for many-body effects. Let’s examine this.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate renormalized energies</span>
<span class="n">E_e_renorm</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">EkReNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_e</span><span class="p">),</span> <span class="n">E_e</span><span class="p">,</span> <span class="n">V_ee</span><span class="p">)</span>
<span class="n">E_h_renorm</span> <span class="o">=</span> <span class="n">dcfield</span><span class="o">.</span><span class="n">EkReNorm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">n_h</span><span class="p">),</span> <span class="n">E_h</span><span class="p">,</span> <span class="n">V_hh</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_e</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Single-particle&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_e_renorm</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Renormalized&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Electron Energy Renormalization&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_h</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Single-particle&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k_grid</span><span class="o">/</span><span class="mf">1e8</span><span class="p">,</span> <span class="n">E_h_renorm</span><span class="o">/</span><span class="n">e0</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Renormalized&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Wavevector ($10^8$ m$^{-1}$)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (meV)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Hole Energy Renormalization&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For this example with zero Coulomb interaction (<span class="math notranslate nohighlight">\(V_{ee} = V_{hh} = 0\)</span>), the renormalized energy equals the single-particle energy. In realistic simulations with Coulomb interactions, the renormalization shifts the energy bands.</p>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<p>This example demonstrated:</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong> of the DC field module with momentum grids and carrier masses</p></li>
<li><p><strong>DC field contribution calculation</strong> using both FFT and finite difference methods</p></li>
<li><p><strong>Drift velocity</strong> computation from carrier distributions</p></li>
<li><p><strong>Current calculation</strong> from electron and hole distributions</p></li>
<li><p><strong>Energy renormalization</strong> accounting for many-body effects</p></li>
<li><p><strong>Phonon-assisted transport</strong> through the drift force calculation</p></li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">dcfield</span></code> module provides a comprehensive framework for simulating carrier transport in quantum wires under applied DC fields, including phonon scattering and many-body interactions.
m</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="coulomb_example.myst.html" class="btn btn-neutral float-left" title="Coulomb Interactions in Quantum Wires" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="emission_example.myst.html" class="btn btn-neutral float-right" title="Spontaneous Emission and Photoluminescence in Quantum Wires" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, PulseSuite Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>