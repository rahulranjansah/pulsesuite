

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pulsesuite.PSTD3D.usefulsubs &mdash; pulsesuite 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.custom.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.bundle.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-shadow.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-punk.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-noir.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-light.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-borderless.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/micromodal.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/sphinx_rtd_theme.css?v=3234e928" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../../_static/copybutton.js?v=f281be69"></script>
      <script src="../../../../_static/js/hoverxref.js"></script>
      <script src="../../../../_static/js/tooltipster.bundle.min.js"></script>
      <script src="../../../../_static/js/micromodal.min.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            pulsesuite
              <img src="../../../../_static/PulseSuitenobg.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../readme.html">PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gallery.html">Examples Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../building_simulations.html">Building Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../params_reference.html">Parameter Files Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citation.html">Citing PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code_of_conduct.html">Code of Conduct for the PulseSuite community</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pulsesuite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pulsesuite.PSTD3D.usefulsubs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/pulsesuite/PSTD3D/usefulsubs/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pulsesuite.PSTD3D.usefulsubs">
<span id="pulsesuite-pstd3d-usefulsubs"></span><h1>pulsesuite.PSTD3D.usefulsubs<a class="headerlink" href="#module-pulsesuite.PSTD3D.usefulsubs" title="Link to this heading">¶</a></h1>
<p>Useful subroutines for quantum wire simulations.</p>
<p>This module provides utility functions for array manipulation and
derivative calculations using FFT methods.</p>
<p>Author: Rahul R. Sah</p>
<dl class="simple">
<dt>Bug fixes:</dt><dd><p>Fortran cshift(array, -1): shifts right (wraps left to right)
NumPy np.roll(array, 1): shifts left (wraps right to left)</p>
</dd>
</dl>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ii" title="pulsesuite.PSTD3D.usefulsubs.ii"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ii</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.pi" title="pulsesuite.PSTD3D.usefulsubs.pi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pi</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.twopi" title="pulsesuite.PSTD3D.usefulsubs.twopi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">twopi</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.small" title="pulsesuite.PSTD3D.usefulsubs.small"><code class="xref py py-obj docutils literal notranslate"><span class="pre">small</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.kB" title="pulsesuite.PSTD3D.usefulsubs.kB"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kB</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.fflip_dp" title="pulsesuite.PSTD3D.usefulsubs.fflip_dp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fflip_dp</span></code></a>(f)</p></td>
<td><p>Flip a real array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.fflip_dpc" title="pulsesuite.PSTD3D.usefulsubs.fflip_dpc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fflip_dpc</span></code></a>(f)</p></td>
<td><p>Flip a complex array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy1D" title="pulsesuite.PSTD3D.usefulsubs.dfdy1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy1D</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction for 1D array using FFT.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy2D" title="pulsesuite.PSTD3D.usefulsubs.dfdy2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy2D</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction for 2D array using FFT.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx1D" title="pulsesuite.PSTD3D.usefulsubs.dfdx1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx1D</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction for 1D array using FFT.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx2D" title="pulsesuite.PSTD3D.usefulsubs.dfdx2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx2D</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction for 2D array using FFT.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy1D_q" title="pulsesuite.PSTD3D.usefulsubs.dfdy1D_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy1D_q</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction for 1D array in q-space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy2D_q" title="pulsesuite.PSTD3D.usefulsubs.dfdy2D_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy2D_q</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction for 2D array in q-space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx1D_q" title="pulsesuite.PSTD3D.usefulsubs.dfdx1D_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx1D_q</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction for 1D array in q-space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx2D_q" title="pulsesuite.PSTD3D.usefulsubs.dfdx2D_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx2D_q</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction for 2D array in q-space.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GFFT_1D" title="pulsesuite.PSTD3D.usefulsubs.GFFT_1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GFFT_1D</span></code></a>(f, dx)</p></td>
<td><p>Gaussian FFT for 1D array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT_1D" title="pulsesuite.PSTD3D.usefulsubs.GIFFT_1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GIFFT_1D</span></code></a>(f, dq)</p></td>
<td><p>Gaussian IFFT for 1D array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GFFT_2D" title="pulsesuite.PSTD3D.usefulsubs.GFFT_2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GFFT_2D</span></code></a>(f, dx, dy)</p></td>
<td><p>Gaussian FFT for 2D array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT_2D" title="pulsesuite.PSTD3D.usefulsubs.GIFFT_2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GIFFT_2D</span></code></a>(f, dqx, dqy)</p></td>
<td><p>Gaussian IFFT for 2D array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.test2Dfrom1D" title="pulsesuite.PSTD3D.usefulsubs.test2Dfrom1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">test2Dfrom1D</span></code></a>(x, y)</p></td>
<td><p>Test function for 2D array construction from 1D arrays.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.testconv" title="pulsesuite.PSTD3D.usefulsubs.testconv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">testconv</span></code></a>(y)</p></td>
<td><p>Test function for convolution operations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ApplyABC" title="pulsesuite.PSTD3D.usefulsubs.ApplyABC"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ApplyABC</span></code></a>(Field, abc)</p></td>
<td><p>Apply absorbing boundary conditions (ABC) to a field.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dEdx" title="pulsesuite.PSTD3D.usefulsubs.dEdx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dEdx</span></code></a>(E, dx)</p></td>
<td><p>Calculate derivative of E field in x direction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dEdy" title="pulsesuite.PSTD3D.usefulsubs.dEdy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dEdy</span></code></a>(E, dy)</p></td>
<td><p>Calculate derivative of E field in y direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dHdx" title="pulsesuite.PSTD3D.usefulsubs.dHdx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dHdx</span></code></a>(H, dx)</p></td>
<td><p>Calculate derivative of H field in x direction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dHdy" title="pulsesuite.PSTD3D.usefulsubs.dHdy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dHdy</span></code></a>(H, dy)</p></td>
<td><p>Calculate derivative of H field in y direction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.testing_conv" title="pulsesuite.PSTD3D.usefulsubs.testing_conv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">testing_conv</span></code></a>(Ex, y, q)</p></td>
<td><p>Test function for convolution operations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.testing_fftc" title="pulsesuite.PSTD3D.usefulsubs.testing_fftc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">testing_fftc</span></code></a>(Ex, y, q)</p></td>
<td><p>Test function for FFTc operations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.print2file" title="pulsesuite.PSTD3D.usefulsubs.print2file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print2file</span></code></a>(x, y, filename)</p></td>
<td><p>Print arrays to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.FT" title="pulsesuite.PSTD3D.usefulsubs.FT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FT</span></code></a>(y, x, q)</p></td>
<td><p>Fourier Transform using direct summation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.IFT" title="pulsesuite.PSTD3D.usefulsubs.IFT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IFT</span></code></a>(y, x, q)</p></td>
<td><p>Inverse Fourier Transform using direct summation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.Flip" title="pulsesuite.PSTD3D.usefulsubs.Flip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Flip</span></code></a>(x)</p></td>
<td><p>Flip a complex array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GetArray0Index" title="pulsesuite.PSTD3D.usefulsubs.GetArray0Index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArray0Index</span></code></a>(x)</p></td>
<td><p>Get index of array element closest to zero.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GaussDelta" title="pulsesuite.PSTD3D.usefulsubs.GaussDelta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GaussDelta</span></code></a>(a, b)</p></td>
<td><p>Gaussian delta function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.delta" title="pulsesuite.PSTD3D.usefulsubs.delta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delta</span></code></a>(x[, dky])</p></td>
<td><p>Dirac delta function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.kdel" title="pulsesuite.PSTD3D.usefulsubs.kdel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kdel</span></code></a>(x)</p></td>
<td><p>Kronecker delta function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.delt" title="pulsesuite.PSTD3D.usefulsubs.delt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delt</span></code></a>(x)</p></td>
<td><p>Delta function variant.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.sgn" title="pulsesuite.PSTD3D.usefulsubs.sgn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sgn</span></code></a>(x)</p></td>
<td><p>Sign function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.sgn2" title="pulsesuite.PSTD3D.usefulsubs.sgn2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sgn2</span></code></a>(x)</p></td>
<td><p>Sign function for arrays.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.TotalEnergy" title="pulsesuite.PSTD3D.usefulsubs.TotalEnergy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TotalEnergy</span></code></a>(n, E)</p></td>
<td><p>Calculate total energy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.AvgEnergy" title="pulsesuite.PSTD3D.usefulsubs.AvgEnergy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AvgEnergy</span></code></a>(n, E)</p></td>
<td><p>Calculate average energy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.Temperature" title="pulsesuite.PSTD3D.usefulsubs.Temperature"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Temperature</span></code></a>(n, E)</p></td>
<td><p>Calculate temperature from energy distribution.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.Lrtz" title="pulsesuite.PSTD3D.usefulsubs.Lrtz"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Lrtz</span></code></a>(a, b)</p></td>
<td><p>Lorentzian function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.theta" title="pulsesuite.PSTD3D.usefulsubs.theta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code></a>(x)</p></td>
<td><p>Heaviside step function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.softtheta" title="pulsesuite.PSTD3D.usefulsubs.softtheta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">softtheta</span></code></a>(x, g)</p></td>
<td><p>Soft Heaviside step function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.rad" title="pulsesuite.PSTD3D.usefulsubs.rad"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rad</span></code></a>(degrees)</p></td>
<td><p>Convert degrees to radians.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.RotateField3D" title="pulsesuite.PSTD3D.usefulsubs.RotateField3D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RotateField3D</span></code></a>(theta, Ex, Ey, Ez)</p></td>
<td><p>Rotate 3D field by angle theta about y-axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.RotateField" title="pulsesuite.PSTD3D.usefulsubs.RotateField"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RotateField</span></code></a>(theta, Ex, Ey)</p></td>
<td><p>Rotate 2D field by angle theta.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ShiftField" title="pulsesuite.PSTD3D.usefulsubs.ShiftField"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ShiftField</span></code></a>(Lx, Ly, dx, dy, Ex, Ey)</p></td>
<td><p>Shift field by specified distances.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.RotateShiftEField" title="pulsesuite.PSTD3D.usefulsubs.RotateShiftEField"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RotateShiftEField</span></code></a>(theta, qx, qy, Ex, Ey[, FFTC, IFFTC])</p></td>
<td><p>Rotate and shift E field in momentum space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.cik01" title="pulsesuite.PSTD3D.usefulsubs.cik01"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cik01</span></code></a>(z)</p></td>
<td><p>Compute modified Bessel functions I0(z), I1(z), K0(z) and K1(z) for complex argument.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.K03" title="pulsesuite.PSTD3D.usefulsubs.K03"><code class="xref py py-obj docutils literal notranslate"><span class="pre">K03</span></code></a>(x)</p></td>
<td><p>Modified Bessel function K0 for real argument.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.locator" title="pulsesuite.PSTD3D.usefulsubs.locator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">locator</span></code></a>(x, x0)</p></td>
<td><p>Find index in sorted array where value should be inserted.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.WriteIT2D" title="pulsesuite.PSTD3D.usefulsubs.WriteIT2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteIT2D</span></code></a>(V, file)</p></td>
<td><p>Write 2D array to file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ReadIT2D" title="pulsesuite.PSTD3D.usefulsubs.ReadIT2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadIT2D</span></code></a>(V, file)</p></td>
<td><p>Read 2D array from file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.WriteIT1D" title="pulsesuite.PSTD3D.usefulsubs.WriteIT1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteIT1D</span></code></a>(V, file)</p></td>
<td><p>Write 1D array to file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ReadIT1D" title="pulsesuite.PSTD3D.usefulsubs.ReadIT1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadIT1D</span></code></a>(V, file)</p></td>
<td><p>Read 1D array from file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.EAtX" title="pulsesuite.PSTD3D.usefulsubs.EAtX"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EAtX</span></code></a>(f, x, x0)</p></td>
<td><p>Linear interpolation of 2D complex array at specified x position.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.EAtXYZ" title="pulsesuite.PSTD3D.usefulsubs.EAtXYZ"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EAtXYZ</span></code></a>(f, x, y, z, x0, y0, z0)</p></td>
<td><p>Trilinear interpolation of 3D complex field at point (x0, y0, z0).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.printIT" title="pulsesuite.PSTD3D.usefulsubs.printIT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">printIT</span></code></a>(Dx, z, n, file)</p></td>
<td><p>Print field to file with index number.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.printITR" title="pulsesuite.PSTD3D.usefulsubs.printITR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">printITR</span></code></a>(Dx, z, n, file)</p></td>
<td><p>Print real field to file with index number.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.printIT2D" title="pulsesuite.PSTD3D.usefulsubs.printIT2D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">printIT2D</span></code></a>(Dx, z, n, file)</p></td>
<td><p>Print 2D complex field to file with index number.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.gaussian" title="pulsesuite.PSTD3D.usefulsubs.gaussian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gaussian</span></code></a>(x, x0)</p></td>
<td><p>Gaussian function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.convolve" title="pulsesuite.PSTD3D.usefulsubs.convolve"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convolve</span></code></a>(x, h)</p></td>
<td><p>Convolution of two complex arrays.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.FFTG" title="pulsesuite.PSTD3D.usefulsubs.FFTG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FFTG</span></code></a>(F)</p></td>
<td><p>FFT with Gaussian normalization.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.iFFTG" title="pulsesuite.PSTD3D.usefulsubs.iFFTG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iFFTG</span></code></a>(F)</p></td>
<td><p>IFFT with Gaussian normalization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.ReadIt" title="pulsesuite.PSTD3D.usefulsubs.ReadIt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadIt</span></code></a>(V, file)</p></td>
<td><p>Read array from file (interface-style wrapper).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.WriteIt" title="pulsesuite.PSTD3D.usefulsubs.WriteIt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteIt</span></code></a>(V, file)</p></td>
<td><p>Write array to file (interface-style wrapper).</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy" title="pulsesuite.PSTD3D.usefulsubs.dfdy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction (interface-style wrapper).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx" title="pulsesuite.PSTD3D.usefulsubs.dfdx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction (interface-style wrapper).</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdy_q" title="pulsesuite.PSTD3D.usefulsubs.dfdy_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdy_q</span></code></a>(f, qy)</p></td>
<td><p>Calculate derivative in y direction in q-space (interface-style wrapper).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.dfdx_q" title="pulsesuite.PSTD3D.usefulsubs.dfdx_q"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfdx_q</span></code></a>(f, qx)</p></td>
<td><p>Calculate derivative in x direction in q-space (interface-style wrapper).</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GFFT" title="pulsesuite.PSTD3D.usefulsubs.GFFT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GFFT</span></code></a>(f, dx[, dy])</p></td>
<td><p>Gaussian FFT (interface-style wrapper).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT" title="pulsesuite.PSTD3D.usefulsubs.GIFFT"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GIFFT</span></code></a>(f, dq[, dqy])</p></td>
<td><p>Gaussian IFFT (interface-style wrapper).</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.usefulsubs.fflip" title="pulsesuite.PSTD3D.usefulsubs.fflip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fflip</span></code></a>(f)</p></td>
<td><p>Flip array (interface-style wrapper).</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ii">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ii</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1j</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ii" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.pi">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">pi</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.pi" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.twopi">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">twopi</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.twopi" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.small">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">small</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-100</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.small" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.kB">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">kB</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.380649e-23</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.kB" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.fflip_dp">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">fflip_dp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.fflip_dp" title="Link to this definition">¶</a></dt>
<dd><p>Flip a real array.</p>
<p>Reverses the order of elements in a real array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>ndarray</em>) – Input real array, 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flipped array, 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.fflip_dpc">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">fflip_dpc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.fflip_dpc" title="Link to this definition">¶</a></dt>
<dd><p>Flip a complex array.</p>
<p>Reverses the order of elements in a complex array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>ndarray</em>) – Input complex array, 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flipped array, 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy1D" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction for 1D array using FFT.</p>
<p>Computes the derivative df/dy using FFT method:
df/dy = IFFT(ii * qy * FFT(f))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 1D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy (complex), 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw FFT functions for computation.
Returns zero array if qy has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy2D" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction for 2D array using FFT.</p>
<p>Computes the derivative df/dy for each row of a 2D array using
the 1D derivative function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 2D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy (complex), 2D array with same shape as f</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calls dfdy1D for each row of the 2D array.
Returns zero array if qy has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx1D" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction for 1D array using FFT.</p>
<p>Computes the derivative df/dx using FFT method:
df/dx = IFFT(ii * qx * FFT(f))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 1D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx (complex), 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw FFT functions for computation.
Returns zero array if qx has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx2D" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction for 2D array using FFT.</p>
<p>Computes the derivative df/dx for each column of a 2D array using
the 1D derivative function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 2D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx (complex), 2D array with same shape as f</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calls dfdy1D for each column of the 2D array.
Returns zero array if qx has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy1D_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy1D_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy1D_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction for 1D array in q-space.</p>
<p>Computes the derivative df/dy in q-space (Fourier space):
df/dy = f * (ii * qy)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 1D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy in q-space (complex), 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the q-space version that operates directly on Fourier-transformed
arrays without requiring FFT/IFFT calls.
Returns zero array if qy has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy2D_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy2D_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy2D_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction for 2D array in q-space.</p>
<p>Computes the derivative df/dy in q-space (Fourier space) for each element:
df/dy(i,j) = f(i,j) * (ii * qy(j))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 2D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy in q-space (complex), 2D array with same shape as f</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the q-space version that operates directly on Fourier-transformed
arrays without requiring FFT/IFFT calls.
Returns zero array if qy has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx1D_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx1D_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx1D_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction for 1D array in q-space.</p>
<p>Computes the derivative df/dx in q-space (Fourier space):
df/dx = f * (ii * qx)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 1D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx in q-space (complex), 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the q-space version that operates directly on Fourier-transformed
arrays without requiring FFT/IFFT calls.
Returns zero array if qx has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx2D_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx2D_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx2D_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction for 2D array in q-space.</p>
<p>Computes the derivative df/dx in q-space (Fourier space) for each element:
df/dx(i,j) = f(i,j) * (ii * qx(i))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 2D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx in q-space (complex), 2D array with same shape as f</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is the q-space version that operates directly on Fourier-transformed
arrays without requiring FFT/IFFT calls.
Returns zero array if qx has only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GFFT_1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GFFT_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GFFT_1D" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian FFT for 1D array.</p>
<p>Performs FFT and scales by dx/sqrt(2*pi) for Gaussian normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D array</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw FFT function for computation.
The function performs: FFT(f) then f = f * dx / sqrt(2*pi)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GIFFT_1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GIFFT_1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT_1D" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian IFFT for 1D array.</p>
<p>Performs IFFT and scales by dq/sqrt(2*pi) * N for Gaussian normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D array</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Momentum step size (1/m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw IFFT function for computation.
The function performs: IFFT(f) then f = f * dq / sqrt(2*pi) * N</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GFFT_2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GFFT_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GFFT_2D" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian FFT for 2D array.</p>
<p>Performs FFT and scales by dx*dy/(2*pi) for Gaussian normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 2D array</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in x direction (m)</p></li>
<li><p><strong>dy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in y direction (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw FFT function for computation.
The function performs: FFT(f) then f = f * dx * dy / (2*pi)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GIFFT_2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GIFFT_2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT_2D" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian IFFT for 2D array.</p>
<p>Performs IFFT and scales by dqx*dqy/(2*pi) * Nx * Ny for Gaussian normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 2D array</p></li>
<li><p><strong>dqx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Momentum step size in x direction (1/m)</p></li>
<li><p><strong>dqy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Momentum step size in y direction (1/m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw IFFT function for computation.
The function performs: IFFT(f) then f = f * dqx * dqy / (2*pi) * Nx * Ny</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.test2Dfrom1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">test2Dfrom1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.test2Dfrom1D" title="Link to this definition">¶</a></dt>
<dd><p>Test function for 2D array construction from 1D arrays.</p>
<p>Creates 2D Gaussian functions from 1D arrays and tests FFT operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – X coordinates (m), 1D array</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Y coordinates (m), 1D array</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a test function. The function prints the sum of squared
absolute values and stops execution.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.testconv">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">testconv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.testconv" title="Link to this definition">¶</a></dt>
<dd><p>Test function for convolution operations.</p>
<p>Tests convolution of two Gaussian functions using FFT methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>ndarray</em>) – Y coordinates (m), 1D array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a test function that uses nyquist_1D and convolve functions
which need to be defined elsewhere. The function prints results and stops.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ApplyABC">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ApplyABC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Field</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ApplyABC" title="Link to this definition">¶</a></dt>
<dd><p>Apply absorbing boundary conditions (ABC) to a field.</p>
<p>Transforms field to real space, multiplies by ABC coefficients,
and transforms back to Fourier space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Field</strong> (<em>ndarray</em>) – Field array (complex), modified in-place, 2D array</p></li>
<li><p><strong>abc</strong> (<em>ndarray</em>) – Absorbing boundary condition coefficients (real), 2D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Field array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function performs: IFFT(Field), Field = Field * abc, FFT(Field)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dEdx">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dEdx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dEdx" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative of E field in x direction.</p>
<p>Computes forward difference derivative: dE/dx = (E(i+1,j) - E(i,j)) / dx</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>ndarray</em>) – Electric field (complex), 2D array</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in x direction (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative dE/dx (complex), 2D array with same shape as E</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns zero array if E has only one row.
Uses forward difference scheme with shifted indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dEdy">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dEdy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dEdy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative of E field in y direction.</p>
<p>Computes forward difference derivative: dE/dy = (E(i,j+1) - E(i,j)) / dy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E</strong> (<em>ndarray</em>) – Electric field (complex), 2D array</p></li>
<li><p><strong>dy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in y direction (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative dE/dy (complex), 2D array with same shape as E</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns zero array if E has only one column.
Uses forward difference scheme with shifted indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dHdx">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dHdx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dHdx" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative of H field in x direction.</p>
<p>Computes backward difference derivative: dH/dx = (H(i,j) - H(i-1,j)) / dx</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em>) – Magnetic field (complex), 2D array</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in x direction (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative dH/dx (complex), 2D array with same shape as H</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns zero array if H has only one row.
Uses backward difference scheme with shifted indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dHdy">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dHdy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dHdy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative of H field in y direction.</p>
<p>Computes backward difference derivative: dH/dy = (H(i,j) - H(i,j-1)) / dy</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<em>ndarray</em>) – Magnetic field (complex), 2D array</p></li>
<li><p><strong>dy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in y direction (m)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative dH/dy (complex), 2D array with same shape as H</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns zero array if H has only one column.
Uses backward difference scheme with shifted indices.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.testing_conv">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">testing_conv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.testing_conv" title="Link to this definition">¶</a></dt>
<dd><p>Test function for convolution operations.</p>
<p>Tests FFT/IFFT operations and normalization for convolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ex</strong> (<em>ndarray</em>) – Field array (complex), modified in-place, 1D array</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Spatial coordinates (m), 1D array</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Momentum coordinates (1/m), 1D array</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a test function that uses module variables yw, dy, dq, Ny
and functions FFTc, IFFTc which need to be defined elsewhere.
The function prints results for testing purposes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.testing_fftc">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">testing_fftc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.testing_fftc" title="Link to this definition">¶</a></dt>
<dd><p>Test function for FFTc operations.</p>
<p>Tests FFTc function with normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ex</strong> (<em>ndarray</em>) – Field array (complex), modified in-place, 1D array</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Spatial coordinates (m), 1D array</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Momentum coordinates (1/m), 1D array</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a test function that uses module variables dy and function FFTc
which need to be defined elsewhere. The function prints results.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.print2file">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">print2file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.print2file" title="Link to this definition">¶</a></dt>
<dd><p>Print arrays to file.</p>
<p>Writes x, y arrays and index to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – First array (real), 1D array</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Second array (real), 1D array</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Output filename</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function writes: x(i), y(i), i for each element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.FT">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">FT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.FT" title="Link to this definition">¶</a></dt>
<dd><p>Fourier Transform using direct summation.</p>
<p>Computes FT: Y(q) = (1/N) * sum(y(x) * exp(ii*x*q))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D array</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – Spatial coordinates (m), 1D array</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Momentum coordinates (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y array is modified in-place with transformed values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses direct summation method for Fourier transform.
The result is normalized by N (length of arrays).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.IFT">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">IFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.IFT" title="Link to this definition">¶</a></dt>
<dd><p>Inverse Fourier Transform using direct summation.</p>
<p>Computes IFT: Y(x) = sum(y(q) * exp(-ii*x*q))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>ndarray</em>) – Input function in q-space (complex), modified in-place, 1D array</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – Spatial coordinates (m), 1D array</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Momentum coordinates (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y array is modified in-place with transformed values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses direct summation method for inverse Fourier transform.
No normalization factor is applied.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.Flip">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">Flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.Flip" title="Link to this definition">¶</a></dt>
<dd><p>Flip a complex array.</p>
<p>Reverses the order of elements in a complex array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em>) – Input complex array, 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flipped array, 1D array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function performs: Flip[i] = x[N-i] for i=0 to N-1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GetArray0Index">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GetArray0Index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GetArray0Index" title="Link to this definition">¶</a></dt>
<dd><p>Get index of array element closest to zero.</p>
<p>Finds the index where the array value is closest to zero
by rounding and checking for zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em>) – Input array (real), 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index (1-based in Fortran, 0-based in Python) where value is closest to zero</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function rounds array values and finds the first index
where the rounded value is zero. Returns error message if not found.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GaussDelta">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GaussDelta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GaussDelta" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian delta function.</p>
<p>Computes normalized Gaussian function: (1/sqrt(pi)/b) * exp(-(a/b)^2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Input value(s)</p></li>
<li><p><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Width parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gaussian delta function value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.delta">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dky</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.delta" title="Link to this definition">¶</a></dt>
<dd><p>Dirac delta function.</p>
<p>Returns 1 if x/dky rounds to zero, otherwise 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Input value</p></li>
<li><p><strong>dky</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Step size for delta function. If None, uses a default small value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if nint(x/dky) == 0, else 0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Note: dky is a module variable in Fortran. Pass it as parameter if needed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.kdel">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">kdel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.kdel" title="Link to this definition">¶</a></dt>
<dd><p>Kronecker delta function.</p>
<p>Returns 1 if x == 0, otherwise 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Input integer value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if x == 0, else 0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.delt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">delt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.delt" title="Link to this definition">¶</a></dt>
<dd><p>Delta function variant.</p>
<p>Computes: 1 - abs(x) / (abs(x) + 1e-100)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Input integer value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Delta function value</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.sgn">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">sgn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.sgn" title="Link to this definition">¶</a></dt>
<dd><p>Sign function.</p>
<p>Returns the sign of a number: -1 if x &lt; 0, +1 if x &gt;= 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Input value</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if x &lt; 0, +1 if x &gt;= 0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.sgn2">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">sgn2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.sgn2" title="Link to this definition">¶</a></dt>
<dd><p>Sign function for arrays.</p>
<p>Applies sign function element-wise to an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>ndarray</em>) – Input array (real), 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of signs (-1 or +1), 1D array of integers</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.TotalEnergy">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">TotalEnergy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.TotalEnergy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate total energy.</p>
<p>Computes total energy as real part of sum(n * E).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>ndarray</em>) – Occupation numbers (complex), 1D array</p></li>
<li><p><strong>E</strong> (<em>ndarray</em>) – Energy values (real), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total energy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.AvgEnergy">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">AvgEnergy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.AvgEnergy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate average energy.</p>
<p>Computes average energy as real(sum(n*E) / (sum(n) + small)).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>ndarray</em>) – Occupation numbers (complex), 1D array</p></li>
<li><p><strong>E</strong> (<em>ndarray</em>) – Energy values (real), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average energy</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses small constant to avoid division by zero.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.Temperature">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">Temperature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.Temperature" title="Link to this definition">¶</a></dt>
<dd><p>Calculate temperature from energy distribution.</p>
<p>Computes temperature as 2 * AvgEnergy(n, E) / kB.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>ndarray</em>) – Occupation numbers (complex), 1D array</p></li>
<li><p><strong>E</strong> (<em>ndarray</em>) – Energy values (real), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Temperature (K)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses Boltzmann constant kB for temperature calculation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.Lrtz">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">Lrtz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.Lrtz" title="Link to this definition">¶</a></dt>
<dd><p>Lorentzian function.</p>
<p>Computes normalized Lorentzian: (b/pi) / (a^2 + b^2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Input value(s)</p></li>
<li><p><strong>b</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Width parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Lorentzian function value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.theta">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">theta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.theta" title="Link to this definition">¶</a></dt>
<dd><p>Heaviside step function.</p>
<p>Computes step function: (abs(x) + x) / 2 / (abs(x) + small)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Input value(s)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Step function value(s): 0 if x &lt; 0, 1 if x &gt; 0</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.
Uses small constant to avoid division by zero at x = 0.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.softtheta">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">softtheta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.softtheta" title="Link to this definition">¶</a></dt>
<dd><p>Soft Heaviside step function.</p>
<p>Computes smooth step function: 0.5 * (1.0 + 2.0/pi * atan(x/g))</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Input value(s)</p></li>
<li><p><strong>g</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Smoothness parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Soft step function value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.
Provides a smooth transition instead of a sharp step.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.rad">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">rad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">degrees</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.rad" title="Link to this definition">¶</a></dt>
<dd><p>Convert degrees to radians.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>degrees</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Angle in degrees</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Angle in radians</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.RotateField3D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">RotateField3D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ez</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.RotateField3D" title="Link to this definition">¶</a></dt>
<dd><p>Rotate 3D field by angle theta about y-axis.</p>
<p>Performs right-handed rotation about y-axis using rotation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Rotation angle (radians)</p></li>
<li><p><strong>Ex</strong> (<em>ndarray</em>) – X component of field (complex), modified in-place, 3D array</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em>) – Y component of field (complex), modified in-place, 3D array</p></li>
<li><p><strong>Ez</strong> (<em>ndarray</em>) – Z component of field (complex), modified in-place, 3D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ex, Ey, Ez arrays are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Rotation matrix for rotation about y-axis:
R = [[cos(theta), 0, sin(theta)],</p>
<blockquote>
<div><p>[0,           1, 0          ],
[-sin(theta), 0, cos(theta)]]</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.RotateField">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">RotateField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.RotateField" title="Link to this definition">¶</a></dt>
<dd><p>Rotate 2D field by angle theta.</p>
<p>Performs rotation in 2D plane using rotation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Rotation angle (radians)</p></li>
<li><p><strong>Ex</strong> (<em>ndarray</em>) – X component of field (complex), modified in-place, 2D array</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em>) – Y component of field (complex), modified in-place, 2D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ex, Ey arrays are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Rotation matrix:
R = [[cos(theta), -sin(theta)],</p>
<blockquote>
<div><p>[sin(theta),  cos(theta)]]</p>
</div></blockquote>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ShiftField">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ShiftField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Lx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ly</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ShiftField" title="Link to this definition">¶</a></dt>
<dd><p>Shift field by specified distances.</p>
<p>Shifts field arrays by integer number of grid points in x and y directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Lx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Shift distance in x direction (m)</p></li>
<li><p><strong>Ly</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Shift distance in y direction (m)</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid spacing in x direction (m)</p></li>
<li><p><strong>dy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Grid spacing in y direction (m)</p></li>
<li><p><strong>Ex</strong> (<em>ndarray</em>) – X component of field (complex), modified in-place, 2D array</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em>) – Y component of field (complex), modified in-place, 2D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ex, Ey arrays are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses circular shift (cshift) to shift arrays by nx and ny grid points.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.RotateShiftEField">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">RotateShiftEField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">FFTC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">IFFTC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.RotateShiftEField" title="Link to this definition">¶</a></dt>
<dd><p>Rotate and shift E field in momentum space.</p>
<p>Transforms field to momentum space, calculates center of mass,
shifts by rotation angle, and transforms back.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Rotation angle (radians)</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
<li><p><strong>Ex</strong> (<em>ndarray</em>) – X component of field (complex), modified in-place, 2D array</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em>) – Y component of field (complex), modified in-place, 2D array</p></li>
<li><p><strong>FFTC</strong> (<em>callable</em><em>, </em><em>optional</em>) – Forward FFT function. If None, uses pyfftw.</p></li>
<li><p><strong>IFFTC</strong> (<em>callable</em><em>, </em><em>optional</em>) – Inverse FFT function. If None, uses pyfftw.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ex, Ey arrays are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses FFTC and IFFTC which need to be defined.
Also uses module variables: dumb, qx0, qy0, q0x, q0y.
These should be passed as parameters or defined as module variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.cik01">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">cik01</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.cik01" title="Link to this definition">¶</a></dt>
<dd><p>Compute modified Bessel functions I0(z), I1(z), K0(z) and K1(z) for complex argument.</p>
<p>This procedure computes the modified Bessel functions I0(z), I1(z),
K0(z), K1(z), and their derivatives for a complex argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>z</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a>) – The complex argument</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(cbi0, cdi0, cbi1, cdi1, cbk0, cdk0, cbk1, cdk1)
Values of I0(z), I0’(z), I1(z), I1’(z), K0(z), K0’(z), K1(z), K1’(z)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This routine is copyrighted by Shanjie Zhang and Jianming Jin.
Reference: Shanjie Zhang, Jianming Jin, Computation of Special Functions,
Wiley, 1996, ISBN: 0-471-11963-6, LC: QA351.C45.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.K03">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">K03</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.K03" title="Link to this definition">¶</a></dt>
<dd><p>Modified Bessel function K0 for real argument.</p>
<p>Computes K0(x) using the complex Bessel function routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Real argument</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of K0(x), or 0.0 if x &gt; 100</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns 0.0 for large arguments (x &gt; 100) to avoid overflow.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.locator">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">locator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.locator" title="Link to this definition">¶</a></dt>
<dd><p>Find index in sorted array where value should be inserted.</p>
<p>Finds the index i such that x[i] &lt;= x0 &lt; x[i+1] (0-based indexing).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – Sorted array (real), 1D array</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Value to locate</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index i such that x[i] &lt;= x0 &lt; x[i+1] (0-based)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses binary search to find the insertion point.
Returns 0 if x0 &lt; x[0], and len(x)-2 if x0 &gt;= x[-1].</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.WriteIT2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">WriteIT2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.WriteIT2D" title="Link to this definition">¶</a></dt>
<dd><p>Write 2D array to file.</p>
<p>Writes a 2D real array to a file in the ‘dataQW’ directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to write (real), 2D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is written to ‘dataQW/{file}.dat’.
Each element is written on a separate line.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ReadIT2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ReadIT2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ReadIT2D" title="Link to this definition">¶</a></dt>
<dd><p>Read 2D array from file.</p>
<p>Reads a 2D real array from a file in the ‘dataQW’ directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to read into (real), modified in-place, 2D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>V array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is read from ‘dataQW/{file}.dat’.
The array shape must match the file contents.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.WriteIT1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">WriteIT1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.WriteIT1D" title="Link to this definition">¶</a></dt>
<dd><p>Write 1D array to file.</p>
<p>Writes a 1D real array to a file in the ‘dataQW’ directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to write (real), 1D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is written to ‘dataQW/{file}.dat’.
Each element is written on a separate line.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ReadIT1D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ReadIT1D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ReadIT1D" title="Link to this definition">¶</a></dt>
<dd><p>Read 1D array from file.</p>
<p>Reads a 1D real array from a file in the ‘dataQW’ directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to read into (real), modified in-place, 1D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>V array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is read from ‘dataQW/{file}.dat’.
The array length must match the file contents.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.EAtX">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">EAtX</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.EAtX" title="Link to this definition">¶</a></dt>
<dd><p>Linear interpolation of 2D complex array at specified x position.</p>
<p>Computes a linear interpolation of a complex 2D array at a specified
x position. The interpolation is performed along the first dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – 2D array to be interpolated (complex), 2D array</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – 1D position array corresponding to first dimension of f (real), 1D array</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Position at which f is to be interpolated</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated values (complex), 1D array of length f.shape[1]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Returns f[0, :] if x has only one element.
Returns zero array if x0 is outside the valid range.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.EAtXYZ">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">EAtXYZ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.EAtXYZ" title="Link to this definition">¶</a></dt>
<dd><p>Trilinear interpolation of 3D complex field at point (x0, y0, z0).</p>
<p>Computes trilinear interpolation of a complex 3D field at a specified point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – 3D field array (complex), 3D array</p></li>
<li><p><strong>x</strong> (<em>ndarray</em>) – 1D array of grid coordinates along x axis (real), 1D array</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – 1D array of grid coordinates along y axis (real), 1D array</p></li>
<li><p><strong>z</strong> (<em>ndarray</em>) – 1D array of grid coordinates along z axis (real), 1D array</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Query coordinate in x direction</p></li>
<li><p><strong>y0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Query coordinate in y direction</p></li>
<li><p><strong>z0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Query coordinate in z direction</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated field value at (x0, y0, z0)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)">complex</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses trilinear interpolation with weights computed for each axis.
Handles degenerate cases where arrays have only one element.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.printIT">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">printIT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.printIT" title="Link to this definition">¶</a></dt>
<dd><p>Print field to file with index number.</p>
<p>Writes a complex 1D field array to a file with index number in filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dx</strong> (<em>ndarray</em>) – Field array (complex), 1D array</p></li>
<li><p><strong>z</strong> (<em>ndarray</em>) – Spatial coordinates (real), 1D array</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index number for filename</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension and index)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is written to ‘dataQW/{file}{n:06d}.dat’.
Each line contains: z(i), real(Dx(i)), imag(Dx(i))</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.printITR">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">printITR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.printITR" title="Link to this definition">¶</a></dt>
<dd><p>Print real field to file with index number.</p>
<p>Writes a real 1D field array to a file with index number in filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dx</strong> (<em>ndarray</em>) – Field array (real), 1D array</p></li>
<li><p><strong>z</strong> (<em>ndarray</em>) – Spatial coordinates (real), 1D array</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index number for filename</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension and index)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is written to ‘dataQW/{file}{n:06d}.dat’.
Each line contains: z(i), Dx(i)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.printIT2D">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">printIT2D</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.printIT2D" title="Link to this definition">¶</a></dt>
<dd><p>Print 2D complex field to file with index number.</p>
<p>Writes a 2D complex field array to a file with index number in filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Dx</strong> (<em>ndarray</em>) – Field array (complex), 2D array</p></li>
<li><p><strong>z</strong> (<em>ndarray</em>) – Spatial coordinates (real), 1D array (not used in output)</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Index number for filename</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension and index)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The file is written to ‘dataQW/{file}{n:07d}.dat’.
Each line contains: abs(Dx(i,j))
The z parameter is kept for interface compatibility but not used.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.gaussian">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.gaussian" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian function.</p>
<p>Computes normalized Gaussian: exp(-x^2 / x0^2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Input value(s)</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em> or </em><em>ndarray</em>) – Width parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gaussian function value(s)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a> or ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an elemental function that works with both scalars and arrays.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.convolve">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">convolve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.convolve" title="Link to this definition">¶</a></dt>
<dd><p>Convolution of two complex arrays.</p>
<p>Computes convolution of signal array x with kernel/impulse array h.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – Signal array (complex), 1D array</p></li>
<li><p><strong>h</strong> (<em>ndarray</em>) – Kernel/impulse array (complex), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Convolved array (complex), 1D array of same length as x</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The convolution is computed using direct summation:
- For i &gt;= kernelsize: y(i) = sum(x(j)*h(k)) where j goes from i down to i-kernelsize+1
- For i &lt; kernelsize: y(i) = sum(x(j)*h(k)) where j goes from i down to 1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.FFTG">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">FFTG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.FFTG" title="Link to this definition">¶</a></dt>
<dd><p>FFT with Gaussian normalization.</p>
<p>Performs FFT and applies Gaussian normalization: F = -FFT(F) / Nf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>F</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>F array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw for FFT computation.
The function performs: FFTC(F) then F = -F / Nf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.iFFTG">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">iFFTG</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.iFFTG" title="Link to this definition">¶</a></dt>
<dd><p>IFFT with Gaussian normalization.</p>
<p>Performs IFFT and applies Gaussian normalization: F = -IFFT(F) * Nf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>F</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>F array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses pyfftw for IFFT computation.
The function performs: iFFTC(F) then F = -F * Nf</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.ReadIt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">ReadIt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.ReadIt" title="Link to this definition">¶</a></dt>
<dd><p>Read array from file (interface-style wrapper).</p>
<p>Automatically dispatches to ReadIT1D or ReadIT2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to read into (real), modified in-place, 1D or 2D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>V array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls ReadIT1D</p></li>
<li><p>2D arrays: calls ReadIT2D</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.WriteIt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">WriteIt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.WriteIt" title="Link to this definition">¶</a></dt>
<dd><p>Write array to file (interface-style wrapper).</p>
<p>Automatically dispatches to WriteIT1D or WriteIT2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>ndarray</em>) – Array to write (real), 1D or 2D array</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – Base filename (without extension)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls WriteIT1D</p></li>
<li><p>2D arrays: calls WriteIT2D</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction (interface-style wrapper).</p>
<p>Automatically dispatches to dfdy1D or dfdy2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 1D or 2D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy (complex), same shape as input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls dfdy1D</p></li>
<li><p>2D arrays: calls dfdy2D</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction (interface-style wrapper).</p>
<p>Automatically dispatches to dfdx1D or dfdx2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), 1D or 2D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx (complex), same shape as input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls dfdx1D</p></li>
<li><p>2D arrays: calls dfdx2D</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdy_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdy_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdy_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in y direction in q-space (interface-style wrapper).</p>
<p>Automatically dispatches to dfdy1D_q or dfdy2D_q based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 1D or 2D array</p></li>
<li><p><strong>qy</strong> (<em>ndarray</em>) – Momentum coordinates in y direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dy in q-space (complex), same shape as input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls dfdy1D_q</p></li>
<li><p>2D arrays: calls dfdy2D_q</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.dfdx_q">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">dfdx_q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.dfdx_q" title="Link to this definition">¶</a></dt>
<dd><p>Calculate derivative in x direction in q-space (interface-style wrapper).</p>
<p>Automatically dispatches to dfdx1D_q or dfdx2D_q based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function in q-space (complex), 1D or 2D array</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em>) – Momentum coordinates in x direction (1/m), 1D array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Derivative df/dx in q-space (complex), same shape as input array</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls dfdx1D_q</p></li>
<li><p>2D arrays: calls dfdx2D_q</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GFFT">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GFFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GFFT" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian FFT (interface-style wrapper).</p>
<p>Automatically dispatches to GFFT_1D or GFFT_2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D or 2D array</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Spatial step size in x direction (m)</p></li>
<li><p><strong>dy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Spatial step size in y direction (m). Required for 2D arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls GFFT_1D(f, dx)</p></li>
<li><p>2D arrays: calls GFFT_2D(f, dx, dy)</p></li>
<li><p>Raises ValueError for unsupported array dimensions or missing dy for 2D</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.GIFFT">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">GIFFT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dqy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.GIFFT" title="Link to this definition">¶</a></dt>
<dd><p>Gaussian IFFT (interface-style wrapper).</p>
<p>Automatically dispatches to GIFFT_1D or GIFFT_2D based on array dimensions.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray</em>) – Input function (complex), modified in-place, 1D or 2D array</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Momentum step size in x direction (1/m)</p></li>
<li><p><strong>dqy</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>) – Momentum step size in y direction (1/m). Required for 2D arrays.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>f array is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>1D arrays: calls GIFFT_1D(f, dq)</p></li>
<li><p>2D arrays: calls GIFFT_2D(f, dq, dqy)</p></li>
<li><p>Raises ValueError for unsupported array dimensions or missing dqy for 2D</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.usefulsubs.fflip">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.usefulsubs.</span></span><span class="sig-name descname"><span class="pre">fflip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.usefulsubs.fflip" title="Link to this definition">¶</a></dt>
<dd><p>Flip array (interface-style wrapper).</p>
<p>Automatically dispatches to fflip_dp or fflip_dpc based on array dtype.
This provides a unified interface similar to Fortran’s interface construct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>f</strong> (<em>ndarray</em>) – Input array (real or complex), 1D array</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flipped array, same dtype as input</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Real arrays: calls fflip_dp</p></li>
<li><p>Complex arrays: calls fflip_dpc</p></li>
<li><p>Raises ValueError for unsupported array dimensions</p></li>
</ul>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Rahul R. Sah and PulseSuite Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>