

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pulsesuite.PSTD3D.SBEs &mdash; pulsesuite 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=9edc463e" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=4ae1632d" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.custom.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster.bundle.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-shadow.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-punk.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-noir.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-light.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/tooltipster-sideTip-borderless.min.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/micromodal.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/sphinx_rtd_theme.css?v=3234e928" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=01f34227"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../../_static/copybutton.js?v=f281be69"></script>
      <script src="../../../../_static/js/hoverxref.js"></script>
      <script src="../../../../_static/js/tooltipster.bundle.min.js"></script>
      <script src="../../../../_static/js/micromodal.min.js"></script>
      <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            pulsesuite
              <img src="../../../../_static/PulseSuitenobg.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../readme.html">PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../gallery.html">Examples Gallery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Simulation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../building_simulations.html">Building Simulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../params_reference.html">Parameter Files Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../bibliography.html">Bibliography</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../authors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../citation.html">Citing PulseSuite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../code_of_conduct.html">Code of Conduct for the PulseSuite community</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pulsesuite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pulsesuite.PSTD3D.SBEs</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/pulsesuite/PSTD3D/SBEs/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-pulsesuite.PSTD3D.SBEs">
<span id="pulsesuite-pstd3d-sbes"></span><h1>pulsesuite.PSTD3D.SBEs<a class="headerlink" href="#module-pulsesuite.PSTD3D.SBEs" title="Link to this heading">¶</a></h1>
<p>Semiconductor Bloch Equations (SBEs) solver for quantum wire simulations.</p>
<p>This module solves the 1D Semiconductor Bloch equations in support of
propagation simulations for a quantum wire.</p>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.eV" title="pulsesuite.PSTD3D.SBEs.eV"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eV</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.me0" title="pulsesuite.PSTD3D.SBEs.me0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">me0</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.hbar" title="pulsesuite.PSTD3D.SBEs.hbar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">hbar</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.e0" title="pulsesuite.PSTD3D.SBEs.e0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">e0</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.eps0" title="pulsesuite.PSTD3D.SBEs.eps0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eps0</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.pi" title="pulsesuite.PSTD3D.SBEs.pi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pi</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.twopi" title="pulsesuite.PSTD3D.SBEs.twopi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">twopi</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ii" title="pulsesuite.PSTD3D.SBEs.ii"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ii</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.SBESolver" title="pulsesuite.PSTD3D.SBEs.SBESolver"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SBESolver</span></code></a></p></td>
<td><p>Class-based SBE solver. Encapsulates all module-level state as instance</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id4" title="pulsesuite.PSTD3D.SBEs.QWCalculator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWCalculator</span></code></a>(Exx, Eyy, Ezz, Vrr, rr, q, dt, w, Pxx, ...)</p></td>
<td><p>Backward-compatible shim — delegates to _default_solver.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkout" title="pulsesuite.PSTD3D.SBEs.Checkout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkout</span></code></a>(p1, p2, C1, C2, D1, D2, w)</p></td>
<td><p>Check out coherence matrices from module storage for wire w.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkin" title="pulsesuite.PSTD3D.SBEs.Checkin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkin</span></code></a>(p1, p2, p3, C1, C2, C3, D1, D2, D3, w)</p></td>
<td><p>Check in updated coherence matrices to module storage for wire w.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Preparation" title="pulsesuite.PSTD3D.SBEs.Preparation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Preparation</span></code></a>(p2, C2, D2, Ex, Ey, Ez, Vr, w, Heh, Hee, ...)</p></td>
<td><p>Prepare Hamiltonians, screening, and dephasing arrays for SBE time step.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcH" title="pulsesuite.PSTD3D.SBEs.CalcH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcH</span></code></a>(Meh, Wee, Whh, C, D, p, VC, Heh, Hee, Hhh)</p></td>
<td><p>Calculate the Hamiltonian matrices for the semiconductor Bloch equations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id5" title="pulsesuite.PSTD3D.SBEs.chiqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chiqw</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id6" title="pulsesuite.PSTD3D.SBEs.getqc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getqc</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id7" title="pulsesuite.PSTD3D.SBEs.QWArea"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWArea</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id8" title="pulsesuite.PSTD3D.SBEs.ShutOffOptics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ShutOffOptics</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadQWParams" title="pulsesuite.PSTD3D.SBEs.ReadQWParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadQWParams</span></code></a>()</p></td>
<td><p>Read quantum wire parameters from 'params/qw.params' file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadMBParams" title="pulsesuite.PSTD3D.SBEs.ReadMBParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadMBParams</span></code></a>()</p></td>
<td><p>Read many-body physics control flags from 'params/mb.params' file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id9" title="pulsesuite.PSTD3D.SBEs.WriteSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteSBEsData</span></code></a>(n)</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id10" title="pulsesuite.PSTD3D.SBEs.ReadSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadSBEsData</span></code></a>(Nt)</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Relaxation" title="pulsesuite.PSTD3D.SBEs.Relaxation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Relaxation</span></code></a>(ne, nh, VC, E1D, Rsp, dt, w, WriteFields)</p></td>
<td><p>Apply phonon scattering and carrier-carrier relaxation to electron and hole populations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RelaxationE" title="pulsesuite.PSTD3D.SBEs.RelaxationE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RelaxationE</span></code></a>(ne, nh, VC, E1D)</p></td>
<td><p>Calculate electron relaxation rates using many-body perturbation theory.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RelaxationH" title="pulsesuite.PSTD3D.SBEs.RelaxationH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RelaxationH</span></code></a>(ne, nh, VC, E1D)</p></td>
<td><p>Calculate hole relaxation rates using many-body perturbation theory.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a>(C, D, p, Heh, Hee, Hhh, GamE, GamH, OffP)</p></td>
<td><p>Calculate the time derivative of the electron-hole coherence (interband polarization).</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="pulsesuite.PSTD3D.SBEs.dCdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dCdt</span></code></a>(Cee, Dhh, Phe, Heh, Hee, Hhh, GamE, GamH, OffE)</p></td>
<td><p>Calculate the time derivative of the electron-electron coherence.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="pulsesuite.PSTD3D.SBEs.dDdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dDdt</span></code></a>(Cee, Dhh, Phe, Heh, Hee, Hhh, GamE, GamH, OffH)</p></td>
<td><p>Calculate the time derivative of the hole-hole coherence.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.write_statistics" title="pulsesuite.PSTD3D.SBEs.write_statistics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">write_statistics</span></code></a>(w, dt, ne2, nh2, Re, Rh)</p></td>
<td><p>Write statistical data to file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a>(Ex, Ey, Ez, w, Meh)</p></td>
<td><p>Calculate the dipole-field coupling matrix for electron-hole transitions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcWnn" title="pulsesuite.PSTD3D.SBEs.CalcWnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcWnn</span></code></a>(q0, Vr, Wnn)</p></td>
<td><p>Calculate the monopole-potential coupling matrix for carrier-carrier interactions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcXqw" title="pulsesuite.PSTD3D.SBEs.CalcXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcXqw</span></code></a>(iq, w, kr, fe, fh, Ee, Eh, gap, area, game, ...)</p></td>
<td><p>Calculate the linear optical susceptibility χ(q,ω) for a quantum wire.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordEpsLqw" title="pulsesuite.PSTD3D.SBEs.RecordEpsLqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordEpsLqw</span></code></a>(Qr, fe, fh, Ee, Eh, gap, area, gamE, ...)</p></td>
<td><p>Record the longitudinal dielectric function ε_L(q,ω) and susceptibility χ_L(q,ω).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordXqw" title="pulsesuite.PSTD3D.SBEs.RecordXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordXqw</span></code></a>(kr, fe, fh, Ee, Eh, gap, area, game, gamh, ...)</p></td>
<td><p>Record the linear optical susceptibility χ(q,ω) using CalcXqw.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.GetArrays" title="pulsesuite.PSTD3D.SBEs.GetArrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArrays</span></code></a>(x, qx, kx)</p></td>
<td><p>Initialize spatial and momentum arrays for the SBE solver.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.MakeKKP" title="pulsesuite.PSTD3D.SBEs.MakeKKP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MakeKKP</span></code></a>()</p></td>
<td><p>Create the momentum difference mapping array kkp.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.kindex" title="pulsesuite.PSTD3D.SBEs.kindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kindex</span></code></a>(k)</p></td>
<td><p>Convert a continuous momentum value to the nearest grid index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id0" title="pulsesuite.PSTD3D.SBEs.InitializeSBE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeSBE</span></code></a>(q, rr, r0, Emaxxx, lam, Nw, QW)</p></td>
<td><p>Backward-compatible shim — creates a default SBESolver instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.SBECalculator" title="pulsesuite.PSTD3D.SBEs.SBECalculator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SBECalculator</span></code></a>(Ex, Ey, Ez, Vr, dt, Px, Py, Pz, Re, Rh, ...)</p></td>
<td><p>Solve the 1D Semiconductor Bloch Equations and calculate source terms.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id0" title="pulsesuite.PSTD3D.SBEs.InitializeSBE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeSBE</span></code></a>(q, rr, r0, Emaxxx, lam, Nw, QW)</p></td>
<td><p>Backward-compatible shim — creates a default SBESolver instance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id4" title="pulsesuite.PSTD3D.SBEs.QWCalculator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWCalculator</span></code></a>(Exx, Eyy, Ezz, Vrr, rr, q, dt, w, Pxx, ...)</p></td>
<td><p>Backward-compatible shim — delegates to _default_solver.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id5" title="pulsesuite.PSTD3D.SBEs.chiqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chiqw</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id6" title="pulsesuite.PSTD3D.SBEs.getqc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getqc</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id7" title="pulsesuite.PSTD3D.SBEs.QWArea"><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWArea</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id8" title="pulsesuite.PSTD3D.SBEs.ShutOffOptics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ShutOffOptics</span></code></a>()</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id9" title="pulsesuite.PSTD3D.SBEs.WriteSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteSBEsData</span></code></a>(n)</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
<tr class="row-even"><td><p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id10" title="pulsesuite.PSTD3D.SBEs.ReadSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadSBEsData</span></code></a>(Nt)</p></td>
<td><p>Backward-compatible shim.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.eV">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">eV</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.602176634e-19</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.eV" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.me0">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">me0</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.me0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.hbar">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">hbar</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.hbar" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.e0">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">e0</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.e0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.eps0">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">eps0</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.eps0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.pi">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">pi</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.pi" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.twopi">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">twopi</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.twopi" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.ii">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ii</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1j</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.ii" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.QWCalculator">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">QWCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Exx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ezz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vrr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWDl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.QWCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Time-evolve the source terms of the quantum wire for Maxwell’s equations.</p>
<p>Solves the 1D Semiconductor Bloch equations and calculates polarization
and charge density source terms for propagation simulations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Exx</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – X-component total electric field in propagation space</p></li>
<li><p><strong>Eyy</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Y-component total electric field in propagation space</p></li>
<li><p><strong>Ezz</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Z-component electric field in propagation space</p></li>
<li><p><strong>Vrr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Potential electric field in propagation space</p></li>
<li><p><strong>rr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em>) – QW spatial array (m)</p></li>
<li><p><strong>q</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em>) – QW momentum array (1/m)</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Time step (s)</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Wire index (which wire to calculate for)</p></li>
<li><p><strong>Pxx</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – X polarization output (modified in-place)</p></li>
<li><p><strong>Pyy</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Y polarization output (modified in-place)</p></li>
<li><p><strong>Pzz</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Z polarization output (modified in-place)</p></li>
<li><p><strong>Rho</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em>) – Free charge density output (modified in-place)</p></li>
<li><p><strong>DoQWP</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – Boolean flag [should propagator use QW polarization] (modified in-place)</p></li>
<li><p><strong>DoQWDl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><em>list</em></a>) – Boolean flag [should propagator use longitudinal field] (modified in-place)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All outputs are modified in-place</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function:
- Updates module-level time counters (xxx, jjj, t)
- Allocates arrays on first call
- Calls Prop2QW to convert propagation fields to QW fields
- Calls SBECalculator to solve the SBEs
- Calls QW2Prop to convert back to propagation space
- Calculates energy transfer and writes to files
- Only activates when field is strong enough (controlled by _wireoff)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.Checkout">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">Checkout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.Checkout" title="Link to this definition">¶</a></dt>
<dd><p>Check out coherence matrices from module storage for wire w.</p>
<p>Retrieves previous time steps from module-level arrays for processing.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.Checkin">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">Checkin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.Checkin" title="Link to this definition">¶</a></dt>
<dd><p>Check in updated coherence matrices to module storage for wire w.</p>
<p>Stores current and future time steps to module-level arrays.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.Preparation">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">Preparation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ez</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Heh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">OffG</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rsp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.Preparation" title="Link to this definition">¶</a></dt>
<dd><p>Prepare Hamiltonians, screening, and dephasing arrays for SBE time step.</p>
<p>This function calculates all the arrays needed for one time step of the
semiconductor Bloch equations:
- Dipole coupling matrix M^{eh} (light-matter interaction)
- Monopole coupling matrices W^{ee}, W^{hh} (free-carrier potentials)
- Hamiltonian matrices H^{eh}, H^{ee}, H^{hh} (including many-body effects)
- Screened Coulomb interaction arrays VC, E1D
- Diagonal dephasing rates γ_e, γ_h
- Off-diagonal dephasing rates Γ^{off}
- Spontaneous emission rates R_sp</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p2</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole coherence matrix at previous time step</p></li>
<li><p><strong>C2</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron coherence matrix at previous time step</p></li>
<li><p><strong>D2</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole coherence matrix at previous time step</p></li>
<li><p><strong>Ex</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Electric field components in momentum space</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Electric field components in momentum space</p></li>
<li><p><strong>Ez</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Electric field components in momentum space</p></li>
<li><p><strong>Vr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Electric potential from free charge in momentum space</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Wire index</p></li>
<li><p><strong>Heh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole Hamiltonian (output, modified in-place)</p></li>
<li><p><strong>Hee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron Hamiltonian (output, modified in-place)</p></li>
<li><p><strong>Hhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole Hamiltonian (output, modified in-place)</p></li>
<li><p><strong>VC</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>, </em><em>Nr</em><em>, </em><em>3</em><em>)</em>) – Screened Coulomb arrays (output, modified in-place)</p></li>
<li><p><strong>E1D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – 1D dielectric screening array (output, modified in-place)</p></li>
<li><p><strong>GamE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron diagonal dephasing rates (output, modified in-place)</p></li>
<li><p><strong>GamH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole diagonal dephasing rates (output, modified in-place)</p></li>
<li><p><strong>OffG</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>, </em><em>3</em><em>)</em>) – Off-diagonal dephasing arrays (output, modified in-place)</p></li>
<li><p><strong>Rsp</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Spontaneous emission rates (output, modified in-place)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All output arrays are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The preparation sequence:
1. Initialize all arrays to zero/defaults
2. Extract carrier populations ne, nh from diagonal of C, D
3. Calculate dipole coupling M^{eh} if optics enabled
4. Calculate monopole coupling W^{ee}, W^{hh} if longitudinal field enabled
5. Calculate screened Coulomb arrays VC, E1D
6. Calculate Hamiltonian matrices H^{eh}, H^{ee}, H^{hh}
7. Calculate diagonal dephasing γ_e, γ_h if enabled
8. Calculate off-diagonal dephasing Γ^{off} if enabled
9. Calculate spontaneous emission rates R_sp if enabled</p>
<p>The Hamiltonian includes:
- Single-particle energies (diagonal)
- Light-matter coupling (via M^{eh})
- Coulomb many-body effects (via VC)
- Excitonic correlations (if _Excitons=True)</p>
<p>Module flags control which effects are included:
- _Optics: optical field coupling
- _LF: longitudinal field effects
- _FreePot: free potential effects
- _Excitons: excitonic correlations
- _DiagDph: diagonal dephasing
- _OffDiagDph: off-diagonal dephasing
- _Recomb: spontaneous recombination</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a></dt><dd><p>Dipole coupling matrix</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcWnn" title="pulsesuite.PSTD3D.SBEs.CalcWnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcWnn</span></code></a></dt><dd><p>Monopole coupling matrix</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcH" title="pulsesuite.PSTD3D.SBEs.CalcH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcH</span></code></a></dt><dd><p>Hamiltonian calculation</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcScreenedArrays</span></code></dt><dd><p>Screened Coulomb arrays</p>
</dd>
</dl>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcGammaE</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcGammaH</span></code></p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">OffDiagDephasing2</span></code></dt><dd><p>Off-diagonal dephasing</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">SpontEmission</span></code></dt><dd><p>Spontaneous emission rates</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.CalcH">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">CalcH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Meh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Whh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Heh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hhh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.CalcH" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the Hamiltonian matrices for the semiconductor Bloch equations.</p>
<p>Constructs the effective Hamiltonian matrices that appear in the SBEs,
including single-particle energies, light-matter coupling, Coulomb many-body
effects, and excitonic correlations.</p>
<p>The Hamiltonians govern the coherent dynamics:
- H^{eh}: electron-hole Hamiltonian (drives optical polarization)
- H^{ee}: electron-electron Hamiltonian (drives electron coherence)
- H^{hh}: hole-hole Hamiltonian (drives hole coherence)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Meh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Dipole-field coupling matrix M^{eh}_{k_e,k_h}</p></li>
<li><p><strong>Wee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron monopole-potential coupling W^{ee}_{k1,k2}</p></li>
<li><p><strong>Whh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole monopole-potential coupling W^{hh}_{k1,k2}</p></li>
<li><p><strong>C</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron coherence matrix</p></li>
<li><p><strong>D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole coherence matrix</p></li>
<li><p><strong>p</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole coherence matrix (interband polarization)</p></li>
<li><p><strong>VC</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>, </em><em>Nr</em><em>, </em><em>3</em><em>)</em>) – Screened Coulomb interaction arrays</p></li>
<li><p><strong>Heh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Output: electron-hole Hamiltonian (modified in-place)</p></li>
<li><p><strong>Hee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Output: electron-electron Hamiltonian (modified in-place)</p></li>
<li><p><strong>Hhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Output: hole-hole Hamiltonian (modified in-place)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hamiltonians Heh, Hee, Hhh are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The Hamiltonians are constructed as:</p>
<p>H^{eh}_{k_e,k_h} = M^{eh}_{k_e,k_h} + Σ_q V(q) p^†_{k_e+q,k_h+q}</p>
<dl>
<dt>H^{ee}_{k1,k2} = E_e(k1)δ_{k1,k2} + W^{ee}_{k1,k2}</dt><dd><ul class="simple">
<li><p>Σ_q V_ee(q) C^†_{k1+q,k2+q}</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k [V_ee(q)C_{k,k+q} - V_eh(q)D_{k+q,k}] (q = k1-k2)</p></li>
</ul>
</dd>
<dt>H^{hh}_{k1,k2} = E_h(k1)δ_{k1,k2} + W^{hh}_{k1,k2}</dt><dd><ul class="simple">
<li><p>Σ_q V_hh(q) D^†_{k1+q,k2+q}</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k [V_hh(q)D_{k,k+q} - V_eh(q)C_{k+q,k}] (q = k1-k2)</p></li>
</ul>
</dd>
</dl>
<p>where:
- V(q) is the screened Coulomb interaction
- q is momentum transfer
- † denotes transpose (not conjugate transpose here)</p>
<p>The excitonic terms (involving V and coherence matrices) are included
only if _Excitons=True.</p>
<p>If _LF=True (longitudinal field), off-diagonal Coulomb exchange terms
are included. If _LF=False, only diagonal terms (k1=k2) are included,
which is the Hartree-Fock approximation.</p>
<p>The noq0 array excludes q=0 terms to avoid divergences in the Coulomb
interaction.</p>
<p>Loop ranges max(1-k1, 1-k2) to min(Nk-k1, Nk-k2) ensure that k+q
stays within array bounds [1, Nk] in Fortran (or [0, Nk-1] in Python).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Preparation" title="pulsesuite.PSTD3D.SBEs.Preparation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Preparation</span></code></a></dt><dd><p>Calls this function to set up Hamiltonians</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a></dt><dd><p>Calculates dipole coupling M^{eh}</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcWnn" title="pulsesuite.PSTD3D.SBEs.CalcWnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcWnn</span></code></a></dt><dd><p>Calculates monopole coupling W^{nn}</p>
</dd>
</dl>
<p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a>, <a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="pulsesuite.PSTD3D.SBEs.dCdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dCdt</span></code></a>, <a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="pulsesuite.PSTD3D.SBEs.dDdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dDdt</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.chiqw">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">chiqw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.chiqw" title="Link to this definition">¶</a></dt>
<dd><p>Get the current linear optical susceptibility χ(ω).</p>
<p>Returns the module-level variable _chiw which stores the linear
susceptibility at the current frequency.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chi</strong> – Linear optical susceptibility χ(ω) (dimensionless).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)">complex</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a simple accessor function that returns the stored value.
The susceptibility is calculated elsewhere (e.g., in QWChi1 or CalcXqw)
and stored in _chiw.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id6" title="pulsesuite.PSTD3D.SBEs.getqc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getqc</span></code></a></dt><dd><p>Get critical momentum</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWChi1</span></code></dt><dd><p>Calculate linear susceptibility (qwoptics module)</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcXqw" title="pulsesuite.PSTD3D.SBEs.CalcXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcXqw</span></code></a></dt><dd><p>Calculate susceptibility at given (q,ω)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.getqc">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">getqc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.getqc" title="Link to this definition">¶</a></dt>
<dd><p>Get the critical momentum q_c.</p>
<p>Returns the module-level variable _qc which stores the critical
momentum for some physical process (e.g., plasmon cutoff, screening length).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>qc</strong> – Critical momentum q_c (rad/m).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a simple accessor function that returns the stored value.
The critical momentum is calculated elsewhere and stored in _qc.</p>
<p>Physical interpretation depends on context:
- Plasmon physics: momentum where plasmon dispersion changes character
- Screening: inverse screening length (q_c ≈ 1/λ_screen)
- Phase transitions: critical wave vector</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id5" title="pulsesuite.PSTD3D.SBEs.chiqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chiqw</span></code></a></dt><dd><p>Get linear susceptibility</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.QWArea">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">QWArea</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.QWArea" title="Link to this definition">¶</a></dt>
<dd><p>Get the quantum wire cross-sectional area.</p>
<p>Returns the module-level variable _area which stores the quantum wire
cross-sectional area.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>area</strong> – Quantum wire cross-sectional area (m²).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)">float</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is a simple accessor function. The area is set during initialization
and represents the effective cross-sectional area of the quantum wire.</p>
<p>The area affects:
- Carrier density normalization
- Optical transition strengths
- Coulomb interaction strengths</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadQWParams" title="pulsesuite.PSTD3D.SBEs.ReadQWParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadQWParams</span></code></a></dt><dd><p>Reads quantum wire parameters including area</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.ShutOffOptics">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ShutOffOptics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.ShutOffOptics" title="Link to this definition">¶</a></dt>
<dd><p>Disable optical coupling in the SBE calculations.</p>
<p>Sets the module-level flag _Optics to False, which disables the
light-matter interaction terms in the Hamiltonian. This is useful
for studying purely electronic dynamics without optical fields.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>When _Optics is False:
- Dipole coupling matrix M^{eh} is not calculated
- Only electronic Coulomb interactions remain
- Useful for equilibration or dark dynamics</p>
<p>To re-enable optics, set _Optics = True directly.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Preparation" title="pulsesuite.PSTD3D.SBEs.Preparation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Preparation</span></code></a></dt><dd><p>Uses _Optics flag to conditionally calculate coupling</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a></dt><dd><p>Dipole coupling (only called if _Optics=True)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.ReadQWParams">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ReadQWParams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.ReadQWParams" title="Link to this definition">¶</a></dt>
<dd><p>Read quantum wire parameters from ‘params/qw.params’ file.</p>
<p>Loads fundamental physical parameters of the quantum wire system from
a parameter file and converts units where necessary. Sets module-level
variables used throughout the SBE calculations.</p>
<section id="file-format">
<h3>File Format<a class="headerlink" href="#file-format" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>params/qw.params should contain one parameter per line:</dt><dd><p>L       - Wire length (m)
Delta0  - Wire thickness (m)
gap     - Band gap (eV, converted to J)
me      - Electron effective mass (units of me0)
mh      - Hole effective mass (units of me0)
HO      - Energy level separation (eV, converted to J)
gam_e   - Electron dephasing rate (Hz)
gam_h   - Hole dephasing rate (Hz)
gam_eh  - Interband dephasing rate (Hz)
epsr    - Relative permittivity (dimensionless)
Oph     - Phonon energy (eV, converted to Hz)
Gph     - Phonon damping rate (eV, converted to Hz)
Edc     - DC electric field (V/m)
jmax    - Output interval (time steps)
ntmax   - Maximum time steps</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Module-level variables are set.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Unit conversions performed:
- gap: eV → J (multiply by e0)
- me, mh: units of me0 → kg (multiply by me0)
- HO: eV → J (multiply by e0)
- Oph: eV → Hz (multiply by e0/hbar)
- Gph: eV → Hz (multiply by e0/hbar)</p>
<p>Module variables set:
_L, _Delta0, _gap, _me, _mh, _HO, _gam_e, _gam_h, _gam_eh,
_epsr, _Oph, _Gph, _Edc, _jmax, _ntmax</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadMBParams" title="pulsesuite.PSTD3D.SBEs.ReadMBParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadMBParams</span></code></a></dt><dd><p>Read many-body physics flags</p>
</dd>
</dl>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.ReadMBParams">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ReadMBParams</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.ReadMBParams" title="Link to this definition">¶</a></dt>
<dd><p>Read many-body physics control flags from ‘params/mb.params’ file.</p>
<p>Loads boolean flags that control which physical effects are included
in the many-body semiconductor Bloch equation calculations. Also sets
the Lorentzian delta function flag for numerical integration.</p>
<section id="id1">
<h3>File Format<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>params/mb.params should contain one flag per line (T/F or 1/0):</dt><dd><p>Optics       - Include optical field coupling
Excitons     - Include excitonic correlations
EHs          - Include carrier-carrier scattering
Screened     - Use screened Coulomb interaction
Phonon       - Include phonon scattering
DCTrans      - Include DC transport
LF           - Include longitudinal field
FreePot      - Include free potential
DiagDph      - Include diagonal dephasing
OffDiagDph   - Include off-diagonal dephasing
Recomb       - Include spontaneous recombination
PLSpec       - Calculate photoluminescence spectrum
ignorewire   - Ignore wire effects
Xqwparams    - Write susceptibility parameters
LorentzDelta - Use Lorentzian delta function</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Module-level flags are set.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>These flags provide fine-grained control over the physics:</p>
<ul class="simple">
<li><p>_Optics: Enable/disable light-matter interaction</p></li>
<li><p>_Excitons: Include excitonic Coulomb correlations in Hamiltonian</p></li>
<li><p>_EHs: Include carrier-carrier scattering (MBCE, MBCH)</p></li>
<li><p>_screened: Use screened vs bare Coulomb interaction</p></li>
<li><p>_Phonon: Include carrier-phonon scattering (MBPE, MBPH)</p></li>
<li><p>_DCTrans: Include DC transport and drift</p></li>
<li><p>_LF: Include longitudinal field (plasmons, screening)</p></li>
<li><p>_FreePot: Include free-carrier potential</p></li>
<li><p>_DiagDph: Momentum-dependent dephasing rates</p></li>
<li><p>_OffDiagDph: Off-diagonal dephasing (correlations)</p></li>
<li><p>_Recomb: Spontaneous electron-hole recombination</p></li>
<li><p>_PLSpec: Track photoluminescence</p></li>
<li><p>_ignorewire: Single-wire approximation</p></li>
<li><p>_Xqwparams: Write χ(q,ω) parameter file</p></li>
</ul>
<p>The LorentzDelta flag is passed to SetLorentzDelta in the coulomb module
to control numerical delta function representation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadQWParams" title="pulsesuite.PSTD3D.SBEs.ReadQWParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadQWParams</span></code></a></dt><dd><p>Read physical parameters</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">SetLorentzDelta</span></code></dt><dd><p>Set delta function representation (coulomb module)</p>
</dd>
</dl>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.WriteSBEsData">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">WriteSBEsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.WriteSBEsData" title="Link to this definition">¶</a></dt>
<dd><p>Write SBE coherence matrices to backup files.</p>
<p>Saves the current state of all coherence matrices (electron-hole,
electron-electron, hole-hole) at three time steps to disk for backup
or restart purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – File index for output filenames (e.g., n=100 creates CC1.100.dat)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>None</em> – Data is written to files in ‘dataQW/backup/’ directory.</p></li>
<li><p><em>Files Created</em></p></li>
<li><p><em>————-</em></p></li>
<li><p><em>For each time step (1, 2, 3) and each matrix type (CC, DD, YY)</em> – dataQW/backup/CC1.{n}.dat - Electron coherence, step 1
dataQW/backup/CC2.{n}.dat - Electron coherence, step 2
dataQW/backup/CC3.{n}.dat - Electron coherence, step 3
dataQW/backup/DD1.{n}.dat - Hole coherence, step 1
dataQW/backup/DD2.{n}.dat - Hole coherence, step 2
dataQW/backup/DD3.{n}.dat - Hole coherence, step 3
dataQW/backup/YY1.{n}.dat - e-h coherence, step 1
dataQW/backup/YY2.{n}.dat - e-h coherence, step 2
dataQW/backup/YY3.{n}.dat - e-h coherence, step 3</p></li>
<li><p><em>Data Format</em></p></li>
<li><p><em>———–</em></p></li>
<li><p><em>Each file contains complex values written as</em> – real_part imaginary_part</p></li>
<li><p><em>One matrix element per line, nested loops over wire, k2, k1.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The three time steps correspond to the leapfrog integration scheme:
- Step 1: Previous time (t - dt)
- Step 2: Current time (t)
- Step 3: Next time (t + dt)</p>
<p>Data is written for all wires and all momentum indices.</p>
<p>File size scales as: Nwires × Nk × Nk × 2 (complex) × 3 (time steps) × 9 (matrices)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id10" title="pulsesuite.PSTD3D.SBEs.ReadSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadSBEsData</span></code></a></dt><dd><p>Read coherence matrices from backup files</p>
</dd>
</dl>
<p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkin" title="pulsesuite.PSTD3D.SBEs.Checkin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkin</span></code></a>, <a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkout" title="pulsesuite.PSTD3D.SBEs.Checkout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkout</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.ReadSBEsData">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ReadSBEsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.ReadSBEsData" title="Link to this definition">¶</a></dt>
<dd><p>Read SBE coherence matrices from backup files.</p>
<p>Loads the saved state of all coherence matrices (electron-hole,
electron-electron, hole-hole) at three time steps from disk for
restart or analysis purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Nt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – File index for input filenames (e.g., Nt=100 reads CC1.100.dat)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>None</em> – Module-level arrays _CC1, _CC2, _CC3, _DD1, _DD2, _DD3,
_YY1, _YY2, _YY3 are updated.</p></li>
<li><p><em>Files Read</em></p></li>
<li><p><em>———-</em></p></li>
<li><p><em>For each time step (1, 2, 3) and each matrix type (CC, DD, YY)</em> – dataQW/backup/CC1.{Nt}.dat - Electron coherence, step 1
dataQW/backup/CC2.{Nt}.dat - Electron coherence, step 2
dataQW/backup/CC3.{Nt}.dat - Electron coherence, step 3
dataQW/backup/DD1.{Nt}.dat - Hole coherence, step 1
dataQW/backup/DD2.{Nt}.dat - Hole coherence, step 2
dataQW/backup/DD3.{Nt}.dat - Hole coherence, step 3
dataQW/backup/YY1.{Nt}.dat - e-h coherence, step 1
dataQW/backup/YY2.{Nt}.dat - e-h coherence, step 2
dataQW/backup/YY3.{Nt}.dat - e-h coherence, step 3</p></li>
<li><p><em>Data Format</em></p></li>
<li><p><em>———–</em></p></li>
<li><p><em>Each file contains complex values as</em> – real_part imaginary_part</p></li>
<li><p><em>One matrix element per line, nested loops over wire, k2, k1.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is used to restart simulations from a saved state.
The data must match the current grid dimensions (Nk, Nwires).</p>
<p>The three time steps enable continuation of the leapfrog integration
without loss of temporal accuracy.</p>
<p>After reading, the simulation can continue from time Nt·dt using
the loaded coherence matrices.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#id9" title="pulsesuite.PSTD3D.SBEs.WriteSBEsData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WriteSBEsData</span></code></a></dt><dd><p>Write coherence matrices to backup files</p>
</dd>
</dl>
<p><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkin" title="pulsesuite.PSTD3D.SBEs.Checkin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkin</span></code></a>, <a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkout" title="pulsesuite.PSTD3D.SBEs.Checkout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkout</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.Relaxation">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">Relaxation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ne</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E1D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rsp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WriteFields</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.Relaxation" title="Link to this definition">¶</a></dt>
<dd><p>Apply phonon scattering and carrier-carrier relaxation to electron and hole populations.</p>
<p>This function calculates the time evolution of carrier populations due to
many-body scattering processes including:
- Electron-electron scattering
- Hole-hole scattering
- Electron-hole scattering
- Electron-phonon scattering
- Hole-phonon scattering
- Spontaneous electron-hole recombination</p>
<p>The scattering rates are calculated using many-body perturbation theory
and applied using an exact exponential solution to the rate equations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ne</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron occupation numbers for each momentum state k.
Modified in-place to apply relaxation effects.</p></li>
<li><p><strong>nh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole occupation numbers for each momentum state k.
Modified in-place to apply relaxation effects.</p></li>
<li><p><strong>VC</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>, </em><em>3</em><em>)</em>) – Real-time screened Coulomb interaction arrays.
VC[:,:,0] - electron-hole interaction
VC[:,:,1] - electron-electron interaction
VC[:,:,2] - hole-hole interaction</p></li>
<li><p><strong>E1D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Real-time 1D dielectric screening array used for carrier-photon
coupling calculations.</p></li>
<li><p><strong>Rsp</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Spontaneous emission rate for each momentum state (Hz).
Used if _Recomb is True.</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Time step for integration (seconds).</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Wire index identifying which quantum wire is being calculated.</p></li>
<li><p><strong>WriteFields</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – If True, write scattering rates to output files via printITR.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>ne and nh are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The carrier population evolution is governed by:</p>
<p>dn_e/dt = W_in^e * (1 - n_e) - W_out^e * n_e
dn_h/dt = W_in^h * (1 - n_h) - W_out^h * n_h</p>
<p>where W_in and W_out are the in-scattering and out-scattering rates.</p>
<p>This is solved exactly as:
n(t+dt) = exp(-W*dt) * [(-1 + exp(W*dt) + n)*W_in + n*W_out] / W
where W = W_in + W_out</p>
<p>This exponential solution is more accurate than a simple Euler step and
remains stable even for large time steps or scattering rates.</p>
<p>If spontaneous recombination is enabled (_Recomb=True), an additional
decay is applied:
n_e(t+dt) = n_e * exp(-R_sp * n_h * dt)
n_h(t+dt) = n_h * exp(-R_sp * n_e * dt)</p>
<p>The scattering rates are calculated by RelaxationE and RelaxationH which
call the many-body perturbation theory functions MBPE and MBPH from the
phonons module.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Possible Modifications:</strong> WinE, WoutE, WinH, WoutH could be inplace arguments.</p>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ne</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">complex</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">VC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E1D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rsp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Relaxation</span><span class="p">(</span><span class="n">ne</span><span class="p">,</span> <span class="n">nh</span><span class="p">,</span> <span class="n">VC</span><span class="p">,</span> <span class="n">E1D</span><span class="p">,</span> <span class="n">Rsp</span><span class="p">,</span> <span class="mf">1e-15</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.RelaxationE">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">RelaxationE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ne</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E1D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.RelaxationE" title="Link to this definition">¶</a></dt>
<dd><p>Calculate electron relaxation rates using many-body perturbation theory.</p>
<p>Computes in-scattering (W_in) and out-scattering (W_out) rates for electrons
due to:
- Carrier-carrier scattering (electron-electron, electron-hole)
- Carrier-phonon scattering (electron-LO phonon, electron-acoustic phonon)</p>
<p>The rates are calculated using second-order Born approximation within the
screened Hartree-Fock approximation, accounting for Pauli blocking factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ne</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron occupation numbers for each momentum state</p></li>
<li><p><strong>nh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole occupation numbers for each momentum state</p></li>
<li><p><strong>VC</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>, </em><em>3</em><em>)</em>) – Screened Coulomb interaction matrices</p></li>
<li><p><strong>E1D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – One-dimensional dielectric screening array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>WinE</strong> (<em>ndarray (float), shape (Nk,)</em>) – In-scattering rate into each electron state (Hz).
W_in^e(k) represents the rate of scattering INTO state k.</p></li>
<li><p><strong>WoutE</strong> (<em>ndarray (float), shape (Nk,)</em>) – Out-scattering rate from each electron state (Hz).
W_out^e(k) represents the rate of scattering OUT OF state k.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The scattering rates satisfy detailed balance and ensure proper
thermalization. Pauli exclusion is enforced through (1-n_e) factors.</p>
<p>Calls MBPE (Many-Body Perturbation theory for Electrons) from the phonons
module, which implements the full quantum kinetic theory calculation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Possible Modifications:</strong> WinE and WoutE could be inplace arguments.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RelaxationH" title="pulsesuite.PSTD3D.SBEs.RelaxationH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RelaxationH</span></code></a></dt><dd><p>Equivalent calculation for holes</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">MBPE</span></code></dt><dd><p>The underlying many-body calculation (in phonons module)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.RelaxationH">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">RelaxationH</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ne</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">VC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">E1D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.RelaxationH" title="Link to this definition">¶</a></dt>
<dd><p>Calculate hole relaxation rates using many-body perturbation theory.</p>
<p>Computes in-scattering (W_in) and out-scattering (W_out) rates for holes
due to:
- Carrier-carrier scattering (hole-hole, hole-electron)
- Carrier-phonon scattering (hole-LO phonon, hole-acoustic phonon)</p>
<p>The rates are calculated using second-order Born approximation within the
screened Hartree-Fock approximation, accounting for Pauli blocking factors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ne</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron occupation numbers for each momentum state</p></li>
<li><p><strong>nh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole occupation numbers for each momentum state</p></li>
<li><p><strong>VC</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>, </em><em>3</em><em>)</em>) – Screened Coulomb interaction matrices</p></li>
<li><p><strong>E1D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – One-dimensional dielectric screening array</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>WinH</strong> (<em>ndarray (float), shape (Nk,)</em>) – In-scattering rate into each hole state (Hz).
W_in^h(k) represents the rate of scattering INTO state k.</p></li>
<li><p><strong>WoutH</strong> (<em>ndarray (float), shape (Nk,)</em>) – Out-scattering rate from each hole state (Hz).
W_out^h(k) represents the rate of scattering OUT OF state k.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The scattering rates satisfy detailed balance and ensure proper
thermalization. Pauli exclusion is enforced through (1-n_h) factors.</p>
<p>Calls MBPH (Many-Body Perturbation theory for Holes) from the phonons
module, which implements the full quantum kinetic theory calculation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Possible Modifications:</strong> WinH, WoutH could be inplace arguments.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RelaxationE" title="pulsesuite.PSTD3D.SBEs.RelaxationE"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RelaxationE</span></code></a></dt><dd><p>Equivalent calculation for electrons</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">MBPH</span></code></dt><dd><p>The underlying many-body calculation (in phonons module)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.dpdt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">dpdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Heh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">OffP</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the time derivative of the electron-hole coherence (interband polarization).</p>
<p>Implements the Semiconductor Bloch Equation for the electron-hole coherence p,
which represents the microscopic interband polarization that gives rise to the
macroscopic optical polarization.</p>
<p>The equation solved is:
iℏ dp_{k_e,k_h}/dt =</p>
<blockquote>
<div><ul class="simple">
<li><p>Σ_k’ H_{k_h,k’}^{hh} p_{k’,k_e}           [hole Hamiltonian term]</p></li>
<li><p>Σ_k’ H_{k_e,k’}^{ee} p_{k_h,k’}           [electron Hamiltonian term]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k’,k_h}^{eh†} C_{k’,k_e}          [electron-electron correlation]</p></li>
<li><p>Σ_k’ H_{k_e,k’}^{eh} D_{k’,k_h}           [hole-hole correlation]</p></li>
</ul>
<ul class="simple">
<li><p>H_{k_e,k_h}^{eh}                          [light-matter coupling]</p></li>
</ul>
<ul class="simple">
<li><p>iℏ(γ_e(k_e) + γ_h(k_h)) p_{k_e,k_h}      [diagonal dephasing]</p></li>
</ul>
<ul class="simple">
<li><p>Γ_p^{off}(k_e,k_h)                        [off-diagonal dephasing]</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron coherence matrix C_{k1,k2}.
Diagonal elements C_{k,k} = n_e(k) are electron occupation numbers.
Off-diagonal elements represent electron-electron quantum correlations.</p></li>
<li><p><strong>D</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole coherence matrix D_{k1,k2}.
Diagonal elements D_{k,k} = n_h(k) are hole occupation numbers.
Off-diagonal elements represent hole-hole quantum correlations.</p></li>
<li><p><strong>p</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole coherence matrix p_{k_e,k_h}.
This is the microscopic polarization between electron state k_e
and hole state k_h.</p></li>
<li><p><strong>Heh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole Hamiltonian matrix elements H_{k_e,k_h}^{eh}.
Contains the light-matter coupling and screened Coulomb attraction.</p></li>
<li><p><strong>Hee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron Hamiltonian matrix elements H_{k1,k2}^{ee}.
Contains kinetic energy (diagonal) and Coulomb repulsion (off-diagonal).</p></li>
<li><p><strong>Hhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole Hamiltonian matrix elements H_{k1,k2}^{hh}.
Contains kinetic energy (diagonal) and Coulomb repulsion (off-diagonal).</p></li>
<li><p><strong>GamE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Diagonal electron dephasing rate γ_e(k) for each momentum state (Hz).
Due to carrier-carrier and carrier-phonon scattering.</p></li>
<li><p><strong>GamH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Diagonal hole dephasing rate γ_h(k) for each momentum state (Hz).
Due to carrier-carrier and carrier-phonon scattering.</p></li>
<li><p><strong>OffP</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Off-diagonal dephasing term Γ_p^{off}(k_e, k_h).
Accounts for correlations in scattering processes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dpdt_result</strong> – Time derivative dp/dt of the electron-hole coherence (1/s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)">complex</a>), shape (Nk, Nk)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is one of the three coupled Semiconductor Bloch Equations (SBEs).
The equations for C (electrons) and D (holes) are given by dCdt and dDdt.</p>
<p>The electron-hole coherence p is related to the macroscopic polarization P by:
P(r,t) = Σ_{k_e,k_h} d_{cv} p_{k_e,k_h}(t) exp(i(k_e-k_h)·r)
where d_{cv} is the interband dipole matrix element.</p>
<p>Physical interpretation:
- The Hamiltonian terms (Hee, Hhh) cause phase evolution
- The correlation terms (via C, D) include Coulomb many-body effects
- The Heh term couples to the external field (light)
- Dephasing terms model irreversible decay processes</p>
<p>Uses JIT compilation for performance with automatic fallback to pure Python.</p>
<p class="rubric">References</p>
<p>V. M. Axt and T. Kuhn, “Femtosecond spectroscopy in semiconductors:
a key to coherences, correlations and quantum kinetics”,
Rep. Prog. Phys. 67, 433 (2004), Eqs. 2.15-2.19.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="pulsesuite.PSTD3D.SBEs.dCdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dCdt</span></code></a></dt><dd><p>Time derivative of electron-electron coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="pulsesuite.PSTD3D.SBEs.dDdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dDdt</span></code></a></dt><dd><p>Time derivative of hole-hole coherence</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.dCdt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">dCdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Heh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">OffE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the time derivative of the electron-electron coherence.</p>
<p>Implements the Semiconductor Bloch Equation for the electron-electron coherence C,
which describes the quantum correlations between different electron momentum states.
The diagonal elements C_{k,k} = n_e(k) are the electron occupation numbers, while
off-diagonal elements represent quantum coherence between different momentum states.</p>
<p>The equation solved is:
iℏ dC_{k1,k2}/dt =</p>
<blockquote>
<div><ul class="simple">
<li><p>Σ_k’ H_{k2,k’}^{ee} C_{k1,k’}          [k2 electron Hamiltonian]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k’,k1}^{ee} C_{k’,k2}          [k1 electron Hamiltonian, commutator]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k2,k’}^{eh} p_{k1,k’}^†        [e-h correlation via p†]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k’,k1}^{eh†} p_{k’,k2}         [e-h correlation via Heh†]</p></li>
</ul>
</div></blockquote>
<p>Note: Off-diagonal dephasing terms (commented out in original Fortran) are not included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Cee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron coherence matrix C_{k1,k2}.
Diagonal: C_{k,k} = n_e(k) is electron occupation.
Off-diagonal: represents electron quantum correlations.</p></li>
<li><p><strong>Dhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole coherence matrix D_{k1,k2} (not used in this equation,
kept for interface compatibility).</p></li>
<li><p><strong>Phe</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole coherence matrix p_{k_e,k_h}.
Note: Fortran uses Phe for p, but it’s the same as p from dpdt.</p></li>
<li><p><strong>Heh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole Hamiltonian matrix H_{k_e,k_h}^{eh}.</p></li>
<li><p><strong>Hee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron Hamiltonian matrix H_{k1,k2}^{ee}.
Diagonal: kinetic energy E_e(k).
Off-diagonal: screened Coulomb repulsion between electrons.</p></li>
<li><p><strong>Hhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole Hamiltonian (not used, kept for interface compatibility).</p></li>
<li><p><strong>GamE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron dephasing rates (not used in this equation).</p></li>
<li><p><strong>GamH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole dephasing rates (not used, kept for interface compatibility).</p></li>
<li><p><strong>OffE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Off-diagonal dephasing for electrons (not used in current implementation).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dCdt_result</strong> – Time derivative dC/dt of electron-electron coherence (1/s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)">complex</a>), shape (Nk, Nk)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This equation governs the evolution of electron correlations, including:
- Single-particle evolution via Hee (phase evolution, energy renormalization)
- Coupling to the interband polarization p via Heh
- Generation of correlations due to Coulomb interaction</p>
<p>Physical significance:
- Diagonal elements: rate of change of electron occupation n_e(k)
- Off-diagonal: buildup/decay of electron quantum coherence
- Couples to the p equation via Heh, forming a closed system</p>
<p>The off-diagonal dephasing terms involving GamE are commented out in the
original Fortran code and not implemented here. If needed, they would add:
- iℏ·I_{k1≠k2}·(γ_e(k1) + γ_e(k2))·C_{k1,k2}
where I_{k1≠k2} is the anti-identity matrix.</p>
<p>Uses JIT compilation for performance with automatic fallback.</p>
<p class="rubric">References</p>
<ol class="upperalpha simple" start="22">
<li><ol class="upperalpha simple" start="13">
<li><p>Axt and T. Kuhn, Rep. Prog. Phys. 67, 433 (2004), Eqs. 2.15-2.19.</p></li>
</ol>
</li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a></dt><dd><p>Time derivative of electron-hole coherence (interband polarization)</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="pulsesuite.PSTD3D.SBEs.dDdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dDdt</span></code></a></dt><dd><p>Time derivative of hole-hole coherence</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.dDdt">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">dDdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Dhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Phe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Heh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Hhh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">GamH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">OffH</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the time derivative of the hole-hole coherence.</p>
<p>Implements the Semiconductor Bloch Equation for the hole-hole coherence D,
which describes the quantum correlations between different hole momentum states.
The diagonal elements D_{k,k} = n_h(k) are the hole occupation numbers, while
off-diagonal elements represent quantum coherence between different momentum states.</p>
<p>The equation solved is:
iℏ dD_{k1,k2}/dt =</p>
<blockquote>
<div><ul class="simple">
<li><p>Σ_k’ H_{k2,k’}^{hh} D_{k1,k’}          [k2 hole Hamiltonian]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k’,k1}^{hh} D_{k’,k2}          [k1 hole Hamiltonian, commutator]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k’,k2}^{eh†} p_{k’,k1}^†       [e-h correlation via p†]</p></li>
</ul>
<ul class="simple">
<li><p>Σ_k’ H_{k1,k’}^{eh†} p_{k2,k’}         [e-h correlation via Heh†]</p></li>
</ul>
</div></blockquote>
<p>Note: Off-diagonal dephasing terms (commented out in original Fortran) are not included.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Cee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron coherence (not used, kept for interface compatibility).</p></li>
<li><p><strong>Dhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole coherence matrix D_{k1,k2}.
Diagonal: D_{k,k} = n_h(k) is hole occupation.
Off-diagonal: represents hole quantum correlations.</p></li>
<li><p><strong>Phe</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole coherence matrix p_{k_e,k_h}.</p></li>
<li><p><strong>Heh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-hole Hamiltonian matrix H_{k_e,k_h}^{eh}.</p></li>
<li><p><strong>Hee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Electron-electron Hamiltonian (not used, kept for interface compatibility).</p></li>
<li><p><strong>Hhh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Hole-hole Hamiltonian matrix H_{k1,k2}^{hh}.
Diagonal: kinetic energy E_h(k).
Off-diagonal: screened Coulomb repulsion between holes.</p></li>
<li><p><strong>GamE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron dephasing rates (not used, kept for interface compatibility).</p></li>
<li><p><strong>GamH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole dephasing rates (not used in this equation).</p></li>
<li><p><strong>OffH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Off-diagonal dephasing for holes (not used in current implementation).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dDdt_result</strong> – Time derivative dD/dt of hole-hole coherence (1/s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)">complex</a>), shape (Nk, Nk)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This equation is analogous to the electron equation (dCdt), but for holes.
It governs the evolution of hole correlations, including:
- Single-particle evolution via Hhh (phase evolution, energy renormalization)
- Coupling to the interband polarization p via Heh
- Generation of correlations due to Coulomb interaction</p>
<p>Physical significance:
- Diagonal elements: rate of change of hole occupation n_h(k)
- Off-diagonal: buildup/decay of hole quantum coherence
- Couples to the p equation via Heh, forming a closed system with dpdt and dCdt</p>
<p>The three equations (dpdt, dCdt, dDdt) form the complete set of Semiconductor
Bloch Equations that must be solved self-consistently. Together they describe:
- Optical response (via p)
- Carrier dynamics (via diagonal C and D)
- Quantum correlations and many-body effects (via off-diagonal C and D)</p>
<p>The off-diagonal dephasing terms involving GamH are commented out in the
original Fortran code and not implemented here. If needed, they would add:
- iℏ·I_{k1≠k2}·(γ_h(k1) + γ_h(k2))·D_{k1,k2}
where I_{k1≠k2} is the anti-identity matrix.</p>
<p>Uses JIT compilation for performance with automatic fallback.</p>
<p class="rubric">References</p>
<p>V. M. Axt and T. Kuhn, “Femtosecond spectroscopy in semiconductors”,
Rep. Prog. Phys. 67, 433 (2004), Eqs. 2.15-2.19.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a></dt><dd><p>Time derivative of electron-hole coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="pulsesuite.PSTD3D.SBEs.dCdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dCdt</span></code></a></dt><dd><p>Time derivative of electron-electron coherence</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.write_statistics">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">write_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ne2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Re</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.write_statistics" title="Link to this definition">¶</a></dt>
<dd><p>Write statistical data to file.</p>
<p>Writes detailed carrier statistics including velocities, densities,
energies, temperatures, and currents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Wire index</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Time step</p></li>
<li><p><strong>ne2</strong> (<em>ndarray</em>) – Electron occupation numbers</p></li>
<li><p><strong>nh2</strong> (<em>ndarray</em>) – Hole occupation numbers</p></li>
<li><p><strong>Re</strong> (<em>ndarray</em>) – Electron charge density</p></li>
<li><p><strong>Rh</strong> (<em>ndarray</em>) – Hole charge density</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.CalcMeh">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">CalcMeh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ez</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Meh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the dipole-field coupling matrix for electron-hole transitions.</p>
<p>Computes the matrix elements of the light-matter interaction Hamiltonian
M_{k_e,k_h}^{eh} which couples the electric field to the interband polarization.
This is the driving term in the optical Bloch equations that causes absorption
and emission of photons.</p>
<p>The matrix elements are calculated as:
M_{k_e,k_h}^{eh} = -η_{int} [X_{cv}(k_e,k_h)·E_x(q) + Y_{cv}(k_e,k_h)·E_y(q)·y_w(w)</p>
<blockquote>
<div><ul class="simple">
<li><p>Z_{cv}(k_e,k_h)·E_z(q)·(-1)^w]</p></li>
</ul>
</div></blockquote>
<p>where:
- η_{int} is the electron-hole spatial overlap integral
- X_{cv}, Y_{cv}, Z_{cv} are the momentum-dependent dipole matrix elements
- q = k_e - k_h is the momentum transfer (photon momentum)
- y_w(w) is a wire-dependent weighting factor
- (-1)^w alternates sign for different wires</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ex</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – X-component of electric field in momentum space (Fourier transformed).
Indexed by momentum q.</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Y-component of electric field in momentum space.
Multiplied by wire-dependent factor yw(w).</p></li>
<li><p><strong>Ez</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Z-component of electric field in momentum space.
Multiplied by (-1)^w for wire parity.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Wire index. Used to determine y-polarization weight yw(w) and
z-polarization sign (-1)^w.</p></li>
<li><p><strong>Meh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Output matrix for dipole-field coupling (modified in-place).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Meh is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is central to the optical response of the semiconductor.
The coupling matrix Meh appears in the SBE for the electron-hole coherence p:</p>
<p>iℏ dp/dt = … + M^{eh}_{k_e,k_h} + …</p>
<p>The momentum index q = k_e - k_h represents the photon momentum absorbed/emitted
in a transition. This is obtained via the index mapping array kkp(ke, kh).</p>
<p>The spatial overlap integral η_{int} (ehint) accounts for the finite size
of the quantum wire and reduces the coupling strength compared to the
bare dipole moment.</p>
<p>The factors yw(w) and (-1)^w allow for different polarization responses
in different wires, enabling modeling of wire arrays with varying orientations.</p>
<p>Important: The comment in the Fortran code notes that previously there was
confusion about whether to use FFT or IFFT for the fields, and that q should
be ke - kh. This has been corrected in the current implementation.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">Xcv</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Ycv</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">Zcv</span></code></p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a></dt><dd><p>The SBE that uses this coupling matrix</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.CalcWnn">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">CalcWnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wnn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.CalcWnn" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the monopole-potential coupling matrix for carrier-carrier interactions.</p>
<p>Computes the matrix elements of the free-charge potential coupling
W_{k1,k2}^{nn} which represents the effect of long-range Coulomb potential
from free carriers on the carrier states. This contributes to the longitudinal
field effects in the SBEs.</p>
<p>The matrix elements are:
W_{k1,k2}^{nn} = q_0 · V_r(q)</p>
<p>where:
- q_0 is the charge of the carrier (+e for holes, -e for electrons)
- V_r(q) is the electric potential from free charge in momentum space
- q = k1 - k2 is the momentum transfer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Free charge of carrier species:
+e0 (positive) for holes
-e0 (negative) for electrons
where e0 is the elementary charge (C)</p></li>
<li><p><strong>Vr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Electric potential from free charge in momentum space (Fourier transformed).
This is the long-range Coulomb potential V(r) = ρ(r)/(4πε_0ε_r) in q-space.</p></li>
<li><p><strong>Wnn</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>, </em><em>Nk</em><em>)</em>) – Output monopole-potential coupling matrix (modified in-place).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Wnn is modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the coupling between carriers and the self-consistent
mean-field potential arising from the carrier density distribution. It’s used
when the longitudinal field (_LF) is enabled to include plasmon effects and
long-range Coulomb interactions.</p>
<p>The coupling matrix Wnn would appear in the SBEs as additional diagonal terms:
- For electrons: H_{k1,k2}^{ee} += W_{k1,k2}^{ee} (with q0 = -e0)
- For holes: H_{k1,k2}^{hh} += W_{k1,k2}^{hh} (with q0 = +e0)</p>
<p>The momentum transfer q = k1 - k2 is obtained via the index mapping kkp(k1, k2).</p>
<p>Note: This function is currently not actively used in the CalcH function (it’s
commented out in the Fortran code), but is kept for potential future use or
for studying longitudinal field effects.</p>
<p>Important: As noted in the Fortran comments, there was previously confusion
about FFT vs IFFT conventions, which has been corrected. The q index now
properly represents q = k1 - k2.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a></dt><dd><p>Dipole-field coupling matrix for optical transitions</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcH" title="pulsesuite.PSTD3D.SBEs.CalcH"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcH</span></code></a></dt><dd><p>Hamiltonian calculation (where Wnn would be used)</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.CalcXqw">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">CalcXqw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">game</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.CalcXqw" title="Link to this definition">¶</a></dt>
<dd><p>Calculate the linear optical susceptibility χ(q,ω) for a quantum wire.</p>
<p>Computes the frequency and momentum-dependent linear susceptibility using
the Lindhard formula generalized to include population inversion (fe, fh)
and dephasing rates (game, gamh). This describes the linear optical response
of the quantum wire system to an external electromagnetic field.</p>
<p>The susceptibility includes contributions from both absorption (fc &lt; fv) and
stimulated emission (fc &gt; fv) processes at each momentum state.</p>
<section id="physics">
<h3>Physics<a class="headerlink" href="#physics" title="Link to this heading">¶</a></h3>
<p>The linear susceptibility is calculated as:</p>
<dl>
<dt>χ(q,ω) = Σ_k [N·<a href="#id2"><span class="problematic" id="id3">|</span></a>d_cv|²/ε₀] × {</dt><dd><blockquote>
<div><p>(f_c(k) - f_v(k+q)) / [E_v(k+q) - E_c(k) - ℏω - iℏ(γ_h(k+q) + γ_e(k))]</p>
</div></blockquote>
<ul class="simple">
<li><p>(f_v(k) - f_c(k+q)) / [E_c(k+q) - E_v(k) - ℏω - iℏ(γ_e(k+q) + γ_h(k))]</p></li>
</ul>
</dd>
</dl>
<p>}</p>
<p>where:
- N = 2·Δk/(2π·A) is the density of states normalization
- d_cv is the interband dipole matrix element
- f_c, f_v are electron (conduction) and hole (valence) occupation numbers
- E_c, E_v are conduction and valence band energies
- γ_e, γ_h are electron and hole dephasing rates
- q is the photon momentum (momentum transfer)
- ω is the photon frequency</p>
<p>The first term represents transitions where an electron in state k absorbs
a photon with momentum q, while the second term represents the time-reversed
process (stimulated emission).</p>
<dl class="field-list simple">
<dt class="field-odd">param iq<span class="colon">:</span></dt>
<dd class="field-odd"><p>Momentum index for photon momentum q. Can be positive, negative, or zero.
The actual momentum is q = iq * (kr[1] - kr[0]).</p>
</dd>
<dt class="field-even">type iq<span class="colon">:</span></dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param w<span class="colon">:</span></dt>
<dd class="field-odd"><p>Angular frequency ω (rad/s) of the electromagnetic field.</p>
</dd>
<dt class="field-even">type w<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">param kr<span class="colon">:</span></dt>
<dd class="field-odd"><p>Momentum grid (rad/m) for carrier states.</p>
</dd>
<dt class="field-even">type kr<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param fe<span class="colon">:</span></dt>
<dd class="field-odd"><p>Electron occupation numbers f_e(k) at each momentum state.
Range: [0, 1] for physical occupation.</p>
</dd>
<dt class="field-even">type fe<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param fh<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hole occupation numbers f_h(k) at each momentum state.
Range: [0, 1] for physical occupation.</p>
</dd>
<dt class="field-even">type fh<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param Ee<span class="colon">:</span></dt>
<dd class="field-odd"><p>Electron energies E_e(k) relative to conduction band edge (J).</p>
</dd>
<dt class="field-even">type Ee<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param Eh<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hole energies E_h(k) relative to valence band edge (J).</p>
</dd>
<dt class="field-even">type Eh<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param gap<span class="colon">:</span></dt>
<dd class="field-odd"><p>Band gap energy E_g (J).</p>
</dd>
<dt class="field-even">type gap<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">param area<span class="colon">:</span></dt>
<dd class="field-odd"><p>Cross-sectional area A of the quantum wire (m²).</p>
</dd>
<dt class="field-even">type area<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">param game<span class="colon">:</span></dt>
<dd class="field-odd"><p>Electron dephasing rates γ_e(k) (1/s).</p>
</dd>
<dt class="field-even">type game<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param gamh<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hole dephasing rates γ_h(k) (1/s).</p>
</dd>
<dt class="field-even">type gamh<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray (float), shape (Nk,)</p>
</dd>
<dt class="field-odd">param dcv<span class="colon">:</span></dt>
<dd class="field-odd"><p>Interband dipole matrix element d_cv (C·m).</p>
</dd>
<dt class="field-even">type dcv<span class="colon">:</span></dt>
<dd class="field-even"><p>complex</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Xqw</strong> – Linear optical susceptibility χ(q,ω) (dimensionless).
Real part: related to refractive index change Δn.
Imaginary part: related to absorption/gain coefficient α.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>complex</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The summation range is carefully chosen to avoid out-of-bounds array access:
- For iq ≥ 0: kmin = 0, kmax = Nk - 1 - iq (Python indexing)
- For iq &lt; 0: kmin = -iq, kmax = Nk - 1 (Python indexing)</p>
<p>This ensures that both k and k+iq remain within [0, Nk-1].</p>
<p>The minimum dephasing is set to 1e-4 eV to prevent numerical instabilities
from vanishing denominators.</p>
<p>The valence band occupations are f_v = 1 - f_h, as holes represent absence
of electrons in the valence band.</p>
<p>The imaginary part Im[χ(q,ω)] &gt; 0 indicates absorption, while Im[χ] &lt; 0
indicates gain (population inversion). The real part Re[χ(q,ω)] is related
to dispersion via the Kramers-Kronig relations.</p>
<p>Physical applications:
- Optical absorption/gain spectra
- Refractive index changes
- Electromagnetically induced transparency (EIT)
- Population inversion and lasing conditions
- Exciton resonances in quantum wires</p>
<p class="rubric">References</p>
<p>H. Haug and S. W. Koch, “Quantum Theory of the Optical and Electronic
Properties of Semiconductors”, 5th ed., World Scientific (2009), Ch. 13.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWChi1</span></code></dt><dd><p>Related function for calculating χ from coulomb module</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordXqw" title="pulsesuite.PSTD3D.SBEs.RecordXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordXqw</span></code></a></dt><dd><p>Function that records χ(q,ω) data to files</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetChi1Dqw</span></code></dt><dd><p>1D susceptibility calculation from coulomb module</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate susceptibility at q=0, near band edge</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">iq</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">gap</span> <span class="o">/</span> <span class="n">hbar</span>  <span class="c1"># Frequency at band gap</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi</span> <span class="o">=</span> <span class="n">CalcXqw</span><span class="p">(</span><span class="n">iq</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">fh</span><span class="p">,</span> <span class="n">Ee</span><span class="p">,</span> <span class="n">Eh</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">gamh</span><span class="p">,</span> <span class="n">dcv</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">w</span> <span class="o">/</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span>  <span class="c1"># Absorption coefficient</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.RecordEpsLqw">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">RecordEpsLqw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Qr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamH</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.RecordEpsLqw" title="Link to this definition">¶</a></dt>
<dd><p>Record the longitudinal dielectric function ε_L(q,ω) and susceptibility χ_L(q,ω).</p>
<p>Calculates and saves to file the frequency and momentum-dependent longitudinal
dielectric function and linear susceptibility for a quantum wire. This provides
a complete characterization of the collective excitations (plasmons) and
optical response of the system.</p>
<p>The longitudinal dielectric function describes the screening of longitudinal
electric fields (parallel to the wire axis) and determines the dispersion
relation of plasmon modes via ε_L(q,ω) = 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Qr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nq</em><em>,</em><em>)</em>) – Momentum grid (rad/m) for the output. Determines the q-resolution.</p></li>
<li><p><strong>fe</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron occupation numbers f_e(k).</p></li>
<li><p><strong>fh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole occupation numbers f_h(k).</p></li>
<li><p><strong>Ee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron energies E_e(k) (J).</p></li>
<li><p><strong>Eh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole energies E_h(k) (J).</p></li>
<li><p><strong>gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Band gap energy E_g (J).</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wire cross-sectional area A (m²).</p></li>
<li><p><strong>gamE</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron dephasing rates γ_e(k) (1/s).</p></li>
<li><p><strong>gamH</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole dephasing rates γ_h(k) (1/s).</p></li>
<li><p><strong>dcv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a>) – Interband dipole matrix element d_cv (C·m).</p></li>
<li><p><strong>ind</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – File index for output filename generation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>None</em> – Data is written to files in ‘dataQW/Wire/Xqw/’ directory.</p></li>
<li><p><em>Files Created</em></p></li>
<li><p><em>————-</em></p></li>
<li><p><strong>dataQW/Wire/Xqw/EpsL.{ind</strong> (<em>06d}.dat :</em>) – Contains Re[ε_L(q,ω) - 1] and Im[ε_L(q,ω)] in two columns.
Data is organized as nested loops: outer loop over ω, inner loop over q.
Total size: (nwmax+1) × (Nq+1) rows, 2 columns.</p></li>
<li><p><strong>dataQW/Wire/Xqw/ChiL.{ind</strong> (<em>06d}.dat :</em>) – Contains Re[χ_L(q,ω)] and Im[χ_L(q,ω)] in two columns.
Same structure as EpsL file.</p></li>
<li><p><em>dataQW/Wire/Xqw/EpsL.params</em> – Parameter file (written only once when _Xqwparams is True).
Contains grid information: Nq, Nw, Δω, Δq, frequency range, momentum range.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The frequency grid is automatically generated:
- ω_max = 2·E_g/ℏ (twice the band gap frequency)
- Δω = ω_max / 2000
- Number of points: 2001 (from ω=0 to ω_max)</p>
<p>The momentum grid uses the input kr spacing:
- Δq = kr[1] - kr[0]
- q ranges from 0 to Nk·Δq</p>
<p>The 1D carrier density is calculated as:
n_1D = Σ(f_e + f_h) / (2·L)
but is currently overridden to a fixed value n_1D = 1.5×10⁸ m⁻¹ for testing.</p>
<p>Two different methods are used:
1. GetEps1Dqw: Analytical RPA dielectric function (from coulomb module)
2. GetChi1Dqw: Numerical susceptibility from actual occupations (from coulomb module)</p>
<p>The longitudinal dielectric function is related to susceptibility by:
ε_L(q,ω) = 1 + V(q)·χ_L(q,ω)
where V(q) is the 1D Coulomb interaction.</p>
<p>Physical applications:
- Plasmon dispersion relations (zeros of ε_L)
- Collective oscillation frequencies
- Screening length determination
- Optical absorption with many-body effects
- Carrier density diagnostics</p>
<p>The data format allows easy plotting as 2D contour plots with:
- X-axis: momentum q
- Y-axis: frequency ω
- Color: Re[ε_L] or Im[ε_L]</p>
<p class="rubric">References</p>
<ol class="upperalpha simple" start="7">
<li><ol class="upperalpha simple" start="4">
<li><p>Mahan, “Many-Particle Physics”, 3rd ed., Springer (2000), Ch. 5.</p></li>
</ol>
</li>
</ol>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcXqw" title="pulsesuite.PSTD3D.SBEs.CalcXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcXqw</span></code></a></dt><dd><p>Calculate linear susceptibility at single (q,ω) point</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetEps1Dqw</span></code></dt><dd><p>Analytical 1D dielectric function (coulomb module)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetChi1Dqw</span></code></dt><dd><p>Numerical 1D susceptibility (coulomb module)</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordXqw" title="pulsesuite.PSTD3D.SBEs.RecordXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordXqw</span></code></a></dt><dd><p>Similar function for recording χ(q,ω) using CalcXqw</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Record dielectric function at time step 1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RecordEpsLqw</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">fh</span><span class="p">,</span> <span class="n">Ee</span><span class="p">,</span> <span class="n">Eh</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">gamE</span><span class="p">,</span> <span class="n">gamH</span><span class="p">,</span> <span class="n">dcv</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Files created: EpsL.001000.dat, ChiL.001000.dat</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.RecordXqw">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">RecordXqw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">game</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.RecordXqw" title="Link to this definition">¶</a></dt>
<dd><p>Record the linear optical susceptibility χ(q,ω) using CalcXqw.</p>
<p>Calculates and saves to file the frequency and momentum-dependent linear
susceptibility χ(q,ω) for a quantum wire using the direct CalcXqw function.
This provides the complete optical response spectrum including absorption,
gain, and dispersion.</p>
<p>Unlike RecordEpsLqw which uses analytical RPA functions, this uses the
CalcXqw function that directly sums over carrier occupations, providing
a more accurate representation when populations deviate from equilibrium.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Momentum grid (rad/m) for carrier states.</p></li>
<li><p><strong>fe</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron occupation numbers f_e(k).</p></li>
<li><p><strong>fh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole occupation numbers f_h(k).</p></li>
<li><p><strong>Ee</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron energies E_e(k) (J).</p></li>
<li><p><strong>Eh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole energies E_h(k) (J).</p></li>
<li><p><strong>gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Band gap energy E_g (J).</p></li>
<li><p><strong>area</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Wire cross-sectional area A (m²).</p></li>
<li><p><strong>game</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Electron dephasing rates γ_e(k) (1/s).</p></li>
<li><p><strong>gamh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Hole dephasing rates γ_h(k) (1/s).</p></li>
<li><p><strong>dcv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a>) – Interband dipole matrix element d_cv (C·m).</p></li>
<li><p><strong>ind</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – File index for output filename generation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>None</em> – Data is written to files in ‘dataQW/Wire/Xqw/’ directory.</p></li>
<li><p><em>Files Created</em></p></li>
<li><p><em>————-</em></p></li>
<li><p><strong>dataQW/Wire/Xqw/Xqw.{ind</strong> (<em>06d}.dat :</em>) – Contains three columns: ω (rad/s), Re[χ(q,ω)], Im[χ(q,ω)].
Data is organized as nested loops: outer loop over ω, inner loop over q.
Total size: (nwmax+1) × (Nk+1) rows, 3 columns.</p></li>
<li><p><em>dataQW/Wire/Xqw/Xqw.params</em> – Parameter file (written only once when _Xqwparams is True).
Contains grid information: Nq, Nw, Δω, Δq, frequency range, momentum range.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The frequency grid is automatically generated:
- ω_max = 2·E_g/ℏ (twice the band gap frequency)
- Δω = ω_max / 2000
- Number of points: 2001 (from ω=0 to ω_max)</p>
<p>The momentum grid uses indices iq from 0 to Nk:
- q ranges from 0 to Nk·Δkr
- Δkr = kr[1] - kr[0]</p>
<p>The output format with three columns (ω, Re[χ], Im[χ]) facilitates plotting
and analysis of the frequency-dependent response at each momentum.</p>
<p>Computation time scales as O(Nω × Nq × Nk), which can be substantial for
large grids. For Nω=2001, Nq=101, Nk=101, this requires ~20M function calls
to CalcXqw.</p>
<p>Physical applications:
- Optical absorption/gain spectra vs. carrier density
- Refractive index changes (via Kramers-Kronig)
- Identification of excitonic resonances
- Population inversion and lasing thresholds
- Non-equilibrium optical response</p>
<p>The inclusion of ω in the first column makes it easy to plot susceptibility
vs. frequency for any given q value.</p>
<p>Differences from RecordEpsLqw:
- Uses CalcXqw (direct sum over occupations) vs. GetChi1Dqw (equilibrium)
- Output format: 3 columns (ω, Re, Im) vs. 2 columns (Re, Im)
- Single file vs. separate files for ε and χ</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcXqw" title="pulsesuite.PSTD3D.SBEs.CalcXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcXqw</span></code></a></dt><dd><p>Function used to calculate χ(q,ω)</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordEpsLqw" title="pulsesuite.PSTD3D.SBEs.RecordEpsLqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordEpsLqw</span></code></a></dt><dd><p>Similar function using analytical RPA methods</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWChi1</span></code></dt><dd><p>Related susceptibility calculation from qwoptics module</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Record susceptibility after excitation at time step 1000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RecordXqw</span><span class="p">(</span><span class="n">kr</span><span class="p">,</span> <span class="n">fe</span><span class="p">,</span> <span class="n">fh</span><span class="p">,</span> <span class="n">Ee</span><span class="p">,</span> <span class="n">Eh</span><span class="p">,</span> <span class="n">gap</span><span class="p">,</span> <span class="n">area</span><span class="p">,</span> <span class="n">game</span><span class="p">,</span> <span class="n">gamh</span><span class="p">,</span> <span class="n">dcv</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># File created: Xqw.001000.dat</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.GetArrays">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">GetArrays</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kx</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.GetArrays" title="Link to this definition">¶</a></dt>
<dd><p>Initialize spatial and momentum arrays for the SBE solver.</p>
<p>Sets up the fundamental coordinate and momentum space grids used throughout
the semiconductor Bloch equation calculations. This includes:
- Real-space positions x for field propagation
- Momentum space qx for Fourier-transformed fields
- Carrier momentum grid kx (offset by half grid spacing)</p>
<p>The carrier momentum grid kx is offset by 0.5 grid spacing to avoid having
a state exactly at k=0, which simplifies boundary conditions and symmetry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Real-space position array (m). Modified in-place.</p></li>
<li><p><strong>qx</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Momentum array for fields (rad/m). Modified in-place.</p></li>
<li><p><strong>kx</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nk</em><em>,</em><em>)</em>) – Carrier momentum array (rad/m). Modified in-place.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Arrays x, qx, kx are modified in-place.
Module-level variables _NK0 and _NQ0 are set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The carrier momentum grid kx is centered at k=0 with the formula:
kx[k] = Δkr × (-dnk + k - 0.5)  for k = 0, 1, …, Nk-1</p>
<p>where dnk = (Nk-1)/2, so that:
- kx is antisymmetric about the origin
- The grid spacing is Δkr
- No state sits exactly at k=0 (offset by 0.5)</p>
<p>The field momentum array qx is obtained from GetKArray and then:
1. Shifted by cshift(qx, Nr/2) to center the zero-frequency component
2. The first element is negated: qx[0] = -qx[0]</p>
<p>Module-level variables set:
- _NK0: Index where kx ≈ 0 (central carrier momentum index)
- _NQ0: Index where qx = 0 (zero field momentum index)</p>
<p>These zero indices are crucial for the kkp mapping array and for properly
handling momentum conservation in scattering processes.</p>
<p>The real-space array x spans the domain [-L, L] (total length 2L).
The momentum array qx corresponds to this spatial grid via FFT convention.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetSpaceArray</span></code></dt><dd><p>Generate real-space position array (from usefulsubs)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetKArray</span></code></dt><dd><p>Generate momentum array for FFT (from usefulsubs)</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArray0Index</span></code></dt><dd><p>Find index where array value is closest to zero (from usefulsubs)</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.MakeKKP" title="pulsesuite.PSTD3D.SBEs.MakeKKP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MakeKKP</span></code></a></dt><dd><p>Create momentum difference mapping using NQ0</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">qx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Nk</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">GetArrays</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">qx</span><span class="p">,</span> <span class="n">kx</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now x, qx, kx are initialized and _NK0, _NQ0 are set</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.MakeKKP">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">MakeKKP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.MakeKKP" title="Link to this definition">¶</a></dt>
<dd><p>Create the momentum difference mapping array kkp.</p>
<p>Constructs the index mapping array kkp[k, kp] that gives the field momentum
index for the momentum difference q = k - kp. This is essential for evaluating
matrix elements of Fourier-transformed fields in the semiconductor Bloch equations.</p>
<p>The array satisfies:
qx[kkp[k, kp]] ≈ kr[k] - kr[kp]</p>
<p>where qx is the field momentum array and kr is the carrier momentum array.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The module-level array _kkp is allocated and filled.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The mapping is calculated as:
kkp[k, kp] = round[(kr[k] - kr[kp]) / Δkr] + NQ0</p>
<p>where:
- kr[k] - kr[kp] is the momentum difference
- Division by Δkr converts to grid index units
- round() maps to nearest grid point
- NQ0 is added to shift from centered indexing to array indexing</p>
<p>This mapping is used extensively in the SBE Hamiltonian terms:
- Dipole-field coupling: M_{k_e,k_h} ∝ E(q) where q = k_e - k_h
- Coulomb interaction: V_{k1,k2} ∝ V(q) where q = k1 - k2
- Screening: ε(q) where q is momentum transfer</p>
<p>Physical interpretation:
When an electron scatters from state kp to state k, the momentum transfer
is q = k - kp. This momentum must be provided by (or absorbed into) a photon,
phonon, or other field mode. The kkp array provides the field mode index
corresponding to this momentum transfer.</p>
<p>Memory: For Nk=101, kkp requires ~10,000 integers (~40 KB).</p>
<p>The Fortran code includes commented-out bounds checking:
- if(kr[0] &lt;= q &lt;= kr[Nr]): only map if q is in range
- if(kkp &lt; 1 or kkp &gt; Nr): set kkp = 0 for out-of-range</p>
<p>These checks are omitted in the current implementation, assuming that the
momentum grids are compatible and all differences are in range.</p>
<section id="global-variables-modified">
<h3>Global Variables Modified<a class="headerlink" href="#global-variables-modified" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>_kkp<span class="classifier">ndarray (int), shape (Nk, Nk)</span></dt><dd><p>Momentum difference mapping array. Allocated and filled.</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.GetArrays" title="pulsesuite.PSTD3D.SBEs.GetArrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArrays</span></code></a></dt><dd><p>Must be called first to set _NQ0</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcMeh" title="pulsesuite.PSTD3D.SBEs.CalcMeh"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcMeh</span></code></a></dt><dd><p>Uses kkp for dipole-field coupling</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.CalcWnn" title="pulsesuite.PSTD3D.SBEs.CalcWnn"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CalcWnn</span></code></a></dt><dd><p>Uses kkp for potential coupling</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.kindex" title="pulsesuite.PSTD3D.SBEs.kindex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kindex</span></code></a></dt><dd><p>Convert continuous momentum to grid index</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GetArrays</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">qx</span><span class="p">,</span> <span class="n">kx</span><span class="p">)</span>  <span class="c1"># Initialize arrays first</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MakeKKP</span><span class="p">()</span>  <span class="c1"># Now create mapping</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access field at momentum difference k - kp:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q_idx</span> <span class="o">=</span> <span class="n">_kkp</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="n">kp</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">field_at_q</span> <span class="o">=</span> <span class="n">Ex</span><span class="p">[</span><span class="n">q_idx</span><span class="p">]</span>
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.kindex">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">kindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.kindex" title="Link to this definition">¶</a></dt>
<dd><p>Convert a continuous momentum value to the nearest grid index.</p>
<p>Maps a continuous momentum k (in rad/m) to the corresponding index in the
carrier momentum array kr. Useful for finding which discrete momentum state
corresponds to a given continuous momentum value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Momentum value (rad/m).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>idx</strong> – Index in the kr array closest to the given momentum k.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)">int</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The mapping formula is:
idx = round(k / Δkr) + NK0</p>
<p>where:
- k / Δkr converts momentum to grid index units
- round() finds nearest grid point
- NK0 is added to shift from centered indexing to array indexing</p>
<p>This function is the inverse of:
k ≈ (idx - NK0) × Δkr</p>
<p>Caution: No bounds checking is performed. If k is outside the range of the
kr array, the returned index may be out of bounds [0, Nk-1].</p>
<p>Physical applications:
- Finding initial state indices for given carrier momenta
- Mapping continuous momentum distributions to discrete grid
- Identifying states near a specific momentum (e.g., Fermi surface)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.GetArrays" title="pulsesuite.PSTD3D.SBEs.GetArrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArrays</span></code></a></dt><dd><p>Sets up kr array and NK0</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.MakeKKP" title="pulsesuite.PSTD3D.SBEs.MakeKKP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MakeKKP</span></code></a></dt><dd><p>Creates momentum difference mapping</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find index for momentum near Fermi momentum</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_fermi</span> <span class="o">=</span> <span class="mf">1e8</span>  <span class="c1"># rad/m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">idx</span> <span class="o">=</span> <span class="n">kindex</span><span class="p">(</span><span class="n">k_fermi</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k_actual</span> <span class="o">=</span> <span class="n">_kr</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>  <span class="c1"># Actual momentum on grid</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.InitializeSBE">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">InitializeSBE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Emaxxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QW</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.InitializeSBE" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the SBE module for calculations.</p>
<p>This function allocates all module-level arrays, initializes them to zero,
calculates material constants, and sets up all subsystems required for
solving the Semiconductor Bloch Equations. It must be called before any
SBE calculations are performed.</p>
<p>The initialization process includes:
1. Reading physical parameters from parameter files
2. Calculating momentum and spatial grids
3. Allocating coherence matrices (YY, CC, DD) for all wires
4. Computing material constants (dipole moment, screening lengths, etc.)
5. Initializing subsystems (Coulomb, Phonons, DC field, Dephasing, Emission)
6. Setting up output files
7. Calculating initial carrier distributions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nq</em><em>,</em><em>)</em>) – Momentum array for fields (rad/m). Used for compatibility but not
directly modified in this function.</p></li>
<li><p><strong>rr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr_prop</em><em>,</em><em>)</em>) – Spatial position array for propagation space (m). Used to determine
the quantum wire window within the propagation domain.</p></li>
<li><p><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Reference position offset (m). Used to locate the quantum wire
within the propagation spatial grid.</p></li>
<li><p><strong>Emaxxx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Initial peak electric field magnitude (V/m). Used to determine
when to activate quantum wire calculations (via _wireoff flag).</p></li>
<li><p><strong>lam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Laser wavelength (m). Used for calculating linear susceptibility
and initializing QW optics.</p></li>
<li><p><strong>Nw</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Number of quantum wires in the simulation. Each wire has its own
set of coherence matrices (YY, CC, DD).</p></li>
<li><p><strong>QW</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Flag to enable quantum wire calculations. If False, only minimal
initialization is performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All module-level arrays and variables are set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function performs extensive setup:</p>
<p><strong>Grid Calculation:</strong>
- Maximum momentum: kmax = sqrt(1.2 * gap * 2 * me / hbar²)
- Momentum spacing: dkr = 2π / (2*L)
- Number of k-points: Nk = floor(kmax/dkr) * 2 + 1, then Nk = Nk - 1
- Number of r-points: Nr = Nk * 2</p>
<p><strong>Material Constants:</strong>
- Dipole moment: dcv = sqrt((e0*hbar)² / (6*me0*gap) * (me0/me - 1))
- Electron confinement: alphae = sqrt(me * HO) / hbar
- Hole confinement: alphah = sqrt(mh * HO) / hbar
- Overlap integral: ehint = sqrt(2 * alphae * alphah / (alphae² + alphah²))
- Critical momentum: qc = 2 * alphae * alphah / (alphae + alphah)
- Wire area: area = sqrt(2π) / sqrt(alphae² + alphah²) * Delta0</p>
<p><strong>Initial Carrier Distribution:</strong>
- Electrons and holes initialized to Fermi-Dirac distribution at</p>
<blockquote>
<div><p>energy E = gap/2 (half the band gap)</p>
</div></blockquote>
<ul class="simple">
<li><p>All off-diagonal coherence elements set to zero</p></li>
</ul>
<p><strong>Subsystem Initialization:</strong>
- InitializeQWOptics: Sets up optical coupling matrices
- InitializeCoulomb: Calculates screened Coulomb interactions
- InitializePhonons: Sets up phonon scattering rates
- InitializeDC: Prepares DC field transport calculations
- InitializeDephasing: Sets up dephasing rate calculations
- InitializeEmission: (if _Recomb=True) Sets up spontaneous emission</p>
<p><strong>Output Files:</strong>
For each wire w:
- dataQW/info.{w:02d}.t.dat - General information
- dataQW/EP.{w:02d}.t.dat - Energy and polarization data
- dataQW/XQ.{w:02d}.t.dat - Susceptibility data
- dataQW/Etr.dat - Transition energies
- dataQW/Wire/info/ETHz.t.dat - THz field data</p>
<p><strong>Special Modes:</strong>
If _OBE=True (Optical Bloch Equations only):
- Disables all many-body effects
- Only optical coupling remains active
- Useful for testing basic optical response</p>
<p><strong>File I/O:</strong>
- Reads parameters from ‘params/qw.params’ and ‘params/mb.params’
- Optionally reads DC field from ‘DC.txt’ if _ReadDC=True
- Writes initial arrays using WriteIt function</p>
<p>The function sets the module-level flag _start to indicate that
initialization is complete, allowing other functions to check if
the module has been properly initialized.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadQWParams" title="pulsesuite.PSTD3D.SBEs.ReadQWParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadQWParams</span></code></a></dt><dd><p>Read quantum wire physical parameters</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.ReadMBParams" title="pulsesuite.PSTD3D.SBEs.ReadMBParams"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReadMBParams</span></code></a></dt><dd><p>Read many-body physics flags</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.GetArrays" title="pulsesuite.PSTD3D.SBEs.GetArrays"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GetArrays</span></code></a></dt><dd><p>Set up spatial and momentum grids</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.MakeKKP" title="pulsesuite.PSTD3D.SBEs.MakeKKP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MakeKKP</span></code></a></dt><dd><p>Create momentum difference mapping</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeQWOptics</span></code></dt><dd><p>Initialize optical coupling</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeCoulomb</span></code></dt><dd><p>Initialize Coulomb interactions</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializePhonons</span></code></dt><dd><p>Initialize phonon scattering</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeDC</span></code></dt><dd><p>Initialize DC field transport</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeDephasing</span></code></dt><dd><p>Initialize dephasing rates</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">InitializeEmission</span></code></dt><dd><p>Initialize spontaneous emission</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWChi1</span></code></dt><dd><p>Calculate linear susceptibility</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.RecordXqw" title="pulsesuite.PSTD3D.SBEs.RecordXqw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RecordXqw</span></code></a></dt><dd><p>Record susceptibility data</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1e8</span><span class="p">,</span> <span class="mf">1e8</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">500e-9</span><span class="p">,</span> <span class="mf">500e-9</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">InitializeSBE</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">rr</span><span class="p">,</span> <span class="n">r0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">Emaxxx</span><span class="o">=</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">800e-9</span><span class="p">,</span> <span class="n">Nw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">QW</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Module is now initialized and ready for SBE calculations</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBECalculator">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">SBECalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ey</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ez</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Px</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Py</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Re</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">WriteFields</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBECalculator" title="Link to this definition">¶</a></dt>
<dd><p>Solve the 1D Semiconductor Bloch Equations and calculate source terms.</p>
<p>This is the main function that solves the Semiconductor Bloch Equations
for the w’th quantum wire and calculates the source terms Px, Py, Pz, Re,
and Rh that are used in Maxwell’s equations for field propagation.</p>
<p>The function performs a leapfrog time integration of the SBEs, including:
- Electron-hole coherence (interband polarization) p
- Electron-electron coherence C
- Hole-hole coherence D
- Many-body effects (Coulomb, phonons, dephasing)
- DC transport effects
- Charge density calculations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ex</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – X-component electric field in QW momentum space (modified in-place).
The field is FFT’d to real space for calculations, then FFT’d back.</p></li>
<li><p><strong>Ey</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Y-component electric field in QW momentum space (modified in-place).</p></li>
<li><p><strong>Ez</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Z-component electric field in QW momentum space (modified in-place).</p></li>
<li><p><strong>Vr</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Free charge potential (voltage) in QW momentum space (modified in-place).</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – Time step (s).</p></li>
<li><p><strong>Px</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – X-component QW polarization field (output, modified in-place).</p></li>
<li><p><strong>Py</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Y-component QW polarization field (output, modified in-place).</p></li>
<li><p><strong>Pz</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – Z-component QW polarization field (output, modified in-place).</p></li>
<li><p><strong>Re</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – QW electron charge density (output, modified in-place).</p></li>
<li><p><strong>Rh</strong> (<em>ndarray</em><em> (</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#complex" title="(in Python v3.14)"><em>complex</em></a><em>)</em><em>, </em><em>shape</em><em> (</em><em>Nr</em><em>,</em><em>)</em>) – QW hole charge density (output, modified in-place).</p></li>
<li><p><strong>WriteFields</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Flag to record SBE solutions and write output files this time step.</p></li>
<li><p><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – Quantum wire index (which wire to calculate for).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>All output arrays (Px, Py, Pz, Re, Rh, Ex, Ey, Ez, Vr) are modified in-place.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function implements the following sequence:</p>
<ol class="arabic simple">
<li><p><strong>Initialize source terms</strong> to zero</p></li>
<li><p><strong>Checkout coherence matrices</strong> from module storage for wire w</p></li>
<li><p><strong>Prepare arrays</strong> (Hamiltonians, screening, dephasing) via Preparation()</p></li>
<li><p><strong>Calculate time derivatives</strong> dp/dt, dC/dt, dD/dt</p></li>
<li><p><strong>Time evolve</strong> using leapfrog scheme: X3 = X1 + dX/dt * 2*dt</p></li>
<li><p><strong>Apply relaxation</strong> (phonon/carrier-carrier scattering) if enabled</p></li>
<li><p><strong>Apply DC transport</strong> if enabled</p></li>
<li><p><strong>Normalize populations</strong> to ensure charge neutrality</p></li>
<li><p><strong>Reshuffle</strong> for stability (convert leapfrog to implicit Euler)</p></li>
<li><p><strong>Calculate polarization</strong> Px, Py, Pz from coherence p</p></li>
<li><p><strong>Calculate charge densities</strong> Re, Rh if longitudinal field enabled</p></li>
<li><p><strong>Write output files</strong> if WriteFields is True</p></li>
<li><p><strong>Checkin updated matrices</strong> to module storage</p></li>
</ol>
<p><strong>Time Integration Scheme:</strong>
The leapfrog scheme is:
- X3 = X1 + dX/dt * 2*dt  (2nd order accurate but potentially unstable)
- Then reshuffled to: X2 = (X1 + X3) / 2  (1st order accurate but stable)</p>
<p>This converts the 2nd-order accurate (but unstable) leapfrog scheme into
a 1st-order accurate (but stable) implicit Euler scheme.</p>
<p><strong>Charge Neutrality:</strong>
The populations are normalized so that:
- Total electrons = Total holes = (sum(ne) + sum(nh)) / 2
This ensures charge neutrality in the system.</p>
<p><strong>FFT Operations:</strong>
The electric fields and polarizations are FFT’d to real space for
calculations, then FFT’d back to momentum space. This is done because:
- Some calculations are easier in real space
- The output is written in real space (at center point Nr/2)</p>
<p><strong>Output Files:</strong>
If WriteFields is True:
- WriteSBESolns: Writes coherence matrices and populations
- WriteDephasing: Writes dephasing rates (if DiagDph enabled)
- File (uw+w): Writes statistics (velocities, densities, energies, etc.)
- File (2*uw+w): Writes fields and polarizations at center point</p>
<p><strong>Module Variables Used:</strong>
- _YY1, _YY2, _YY3: Electron-hole coherence matrices
- _CC1, _CC2, _CC3: Electron-electron coherence matrices
- _DD1, _DD2, _DD3: Hole-hole coherence matrices
- _Id, _Ia: Identity and anti-identity matrices
- _kr, _Ee, _Eh: Momentum and energy arrays
- _r, _Qr: Spatial and momentum arrays
- _I0: Drift current array
- _xxx, _jjj: Time step counters
- _gap, _me, _mh, _L, _area, _ehint: Material parameters
- _Optics, _EHs, _Phonon, _DCTrans, _LF, _DiagDph: Physics flags</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Preparation" title="pulsesuite.PSTD3D.SBEs.Preparation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Preparation</span></code></a></dt><dd><p>Prepare Hamiltonians and arrays for SBE time step</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dpdt" title="pulsesuite.PSTD3D.SBEs.dpdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dpdt</span></code></a></dt><dd><p>Calculate time derivative of electron-hole coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dCdt" title="pulsesuite.PSTD3D.SBEs.dCdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dCdt</span></code></a></dt><dd><p>Calculate time derivative of electron-electron coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.dDdt" title="pulsesuite.PSTD3D.SBEs.dDdt"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dDdt</span></code></a></dt><dd><p>Calculate time derivative of hole-hole coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Relaxation" title="pulsesuite.PSTD3D.SBEs.Relaxation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Relaxation</span></code></a></dt><dd><p>Apply phonon and carrier-carrier scattering</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">Transport</span></code></dt><dd><p>Apply DC field transport effects</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWPolarization3</span></code></dt><dd><p>Calculate polarization from coherence</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">QWRho5</span></code></dt><dd><p>Calculate charge densities from coherence</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkout" title="pulsesuite.PSTD3D.SBEs.Checkout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkout</span></code></a></dt><dd><p>Retrieve coherence matrices from module storage</p>
</dd>
<dt><a class="hxr-hoverxref hxr-tooltip reference internal" href="#pulsesuite.PSTD3D.SBEs.Checkin" title="pulsesuite.PSTD3D.SBEs.Checkin"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Checkin</span></code></a></dt><dd><p>Store coherence matrices to module storage</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">SBESolver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Emaxxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QW</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver" title="Link to this definition">¶</a></dt>
<dd><p>Class-based SBE solver. Encapsulates all module-level state as instance
attributes, enabling multiple independent quantum wire simulations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.L">
<span class="sig-name descname"><span class="pre">L</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-07</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.L" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Delta0">
<span class="sig-name descname"><span class="pre">Delta0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5e-09</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Delta0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.gap">
<span class="sig-name descname"><span class="pre">gap</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2.4032649509999997e-19</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.gap" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.me">
<span class="sig-name descname"><span class="pre">me</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.me" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.mh">
<span class="sig-name descname"><span class="pre">mh</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.mh" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.HO">
<span class="sig-name descname"><span class="pre">HO</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.602176634e-20</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.HO" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.gam_e">
<span class="sig-name descname"><span class="pre">gam_e</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000000000.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.gam_e" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.gam_h">
<span class="sig-name descname"><span class="pre">gam_h</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000000000.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.gam_h" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.gam_eh">
<span class="sig-name descname"><span class="pre">gam_eh</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000000000000.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.gam_eh" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.wL">
<span class="sig-name descname"><span class="pre">wL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.wL" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.epsr">
<span class="sig-name descname"><span class="pre">epsr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">9.1</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.epsr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Oph">
<span class="sig-name descname"><span class="pre">Oph</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Oph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Gph">
<span class="sig-name descname"><span class="pre">Gph</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Gph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Edc">
<span class="sig-name descname"><span class="pre">Edc</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Edc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Optics">
<span class="sig-name descname"><span class="pre">Optics</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Optics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Excitons">
<span class="sig-name descname"><span class="pre">Excitons</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Excitons" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.EHs">
<span class="sig-name descname"><span class="pre">EHs</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.EHs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Screened">
<span class="sig-name descname"><span class="pre">Screened</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Screened" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Phonon">
<span class="sig-name descname"><span class="pre">Phonon</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Phonon" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.DCTrans">
<span class="sig-name descname"><span class="pre">DCTrans</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.DCTrans" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.LF">
<span class="sig-name descname"><span class="pre">LF</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.LF" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.FreePot">
<span class="sig-name descname"><span class="pre">FreePot</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.FreePot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.DiagDph">
<span class="sig-name descname"><span class="pre">DiagDph</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.DiagDph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.OffDiagDph">
<span class="sig-name descname"><span class="pre">OffDiagDph</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.OffDiagDph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.OBE">
<span class="sig-name descname"><span class="pre">OBE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.OBE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Recomb">
<span class="sig-name descname"><span class="pre">Recomb</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Recomb" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ReadDC">
<span class="sig-name descname"><span class="pre">ReadDC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ReadDC" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.PLSpec">
<span class="sig-name descname"><span class="pre">PLSpec</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.PLSpec" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ignorewire">
<span class="sig-name descname"><span class="pre">ignorewire</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ignorewire" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.debug1">
<span class="sig-name descname"><span class="pre">debug1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.debug1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Xqwparams">
<span class="sig-name descname"><span class="pre">Xqwparams</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Xqwparams" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Id">
<span class="sig-name descname"><span class="pre">Id</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Id" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Ia">
<span class="sig-name descname"><span class="pre">Ia</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Ia" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Ee">
<span class="sig-name descname"><span class="pre">Ee</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Ee" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Eh">
<span class="sig-name descname"><span class="pre">Eh</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Eh" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.r">
<span class="sig-name descname"><span class="pre">r</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.r" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Qr">
<span class="sig-name descname"><span class="pre">Qr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Qr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.QE">
<span class="sig-name descname"><span class="pre">QE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.QE" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.kr">
<span class="sig-name descname"><span class="pre">kr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.kr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.EPEnergy">
<span class="sig-name descname"><span class="pre">EPEnergy</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.EPEnergy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.EPEnergyW">
<span class="sig-name descname"><span class="pre">EPEnergyW</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.EPEnergyW" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.I0">
<span class="sig-name descname"><span class="pre">I0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.I0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ErI0">
<span class="sig-name descname"><span class="pre">ErI0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ErI0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.hw">
<span class="sig-name descname"><span class="pre">hw</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.hw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.PLS">
<span class="sig-name descname"><span class="pre">PLS</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.PLS" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.dkr">
<span class="sig-name descname"><span class="pre">dkr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.dkr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.dr">
<span class="sig-name descname"><span class="pre">dr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.dr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Nr1">
<span class="sig-name descname"><span class="pre">Nr1</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Nr1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Nr2">
<span class="sig-name descname"><span class="pre">Nr2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Nr2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.start">
<span class="sig-name descname"><span class="pre">start</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.qw">
<span class="sig-name descname"><span class="pre">qw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.qw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Nr">
<span class="sig-name descname"><span class="pre">Nr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Nr" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Nk">
<span class="sig-name descname"><span class="pre">Nk</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Nk" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.small">
<span class="sig-name descname"><span class="pre">small</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-200</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.small" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.NK0">
<span class="sig-name descname"><span class="pre">NK0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.NK0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.NQ0">
<span class="sig-name descname"><span class="pre">NQ0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.NQ0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.nqq">
<span class="sig-name descname"><span class="pre">nqq</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.nqq" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.nqq10">
<span class="sig-name descname"><span class="pre">nqq10</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.nqq10" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.kkp">
<span class="sig-name descname"><span class="pre">kkp</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.kkp" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.dcv">
<span class="sig-name descname"><span class="pre">dcv</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.dcv" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ehint">
<span class="sig-name descname"><span class="pre">ehint</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ehint" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Emax0">
<span class="sig-name descname"><span class="pre">Emax0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Emax0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.alphae">
<span class="sig-name descname"><span class="pre">alphae</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.alphae" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.alphah">
<span class="sig-name descname"><span class="pre">alphah</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.alphah" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.qc">
<span class="sig-name descname"><span class="pre">qc</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.qc" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.area">
<span class="sig-name descname"><span class="pre">area</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-16</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.area" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.t">
<span class="sig-name descname"><span class="pre">t</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.wph">
<span class="sig-name descname"><span class="pre">wph</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.wph" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.chiw">
<span class="sig-name descname"><span class="pre">chiw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0j</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.chiw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.uw">
<span class="sig-name descname"><span class="pre">uw</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">820</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.uw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.vhh0">
<span class="sig-name descname"><span class="pre">vhh0</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.vhh0" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ETHz">
<span class="sig-name descname"><span class="pre">ETHz</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.0</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ETHz" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.wireoff">
<span class="sig-name descname"><span class="pre">wireoff</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.wireoff" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.xxx">
<span class="sig-name descname"><span class="pre">xxx</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.xxx" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.jjj">
<span class="sig-name descname"><span class="pre">jjj</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.jjj" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.jmax">
<span class="sig-name descname"><span class="pre">jmax</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1000</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.jmax" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ntmax">
<span class="sig-name descname"><span class="pre">ntmax</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">100000</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ntmax" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.file_972">
<span class="sig-name descname"><span class="pre">file_972</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.file_972" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.file_973">
<span class="sig-name descname"><span class="pre">file_973</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.file_973" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.Nw">
<span class="sig-name descname"><span class="pre">Nw</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.Nw" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.YY1">
<span class="sig-name descname"><span class="pre">YY1</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.YY1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.YY2">
<span class="sig-name descname"><span class="pre">YY2</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.YY2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.YY3">
<span class="sig-name descname"><span class="pre">YY3</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.YY3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.CC1">
<span class="sig-name descname"><span class="pre">CC1</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.CC1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.CC2">
<span class="sig-name descname"><span class="pre">CC2</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.CC2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.CC3">
<span class="sig-name descname"><span class="pre">CC3</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.CC3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.DD1">
<span class="sig-name descname"><span class="pre">DD1</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.DD1" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.DD2">
<span class="sig-name descname"><span class="pre">DD2</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.DD2" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.DD3">
<span class="sig-name descname"><span class="pre">DD3</span></span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.DD3" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.kindex">
<span class="sig-name descname"><span class="pre">kindex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.kindex" title="Link to this definition">¶</a></dt>
<dd><p>Convert continuous momentum to nearest grid index.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.calc_Xqw">
<span class="sig-name descname"><span class="pre">calc_Xqw</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ee</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">game</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dcv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.calc_Xqw" title="Link to this definition">¶</a></dt>
<dd><p>Calculate linear optical susceptibility chi(q,w).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.chiqw">
<span class="sig-name descname"><span class="pre">chiqw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.chiqw" title="Link to this definition">¶</a></dt>
<dd><p>Return linear optical susceptibility.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.getqc">
<span class="sig-name descname"><span class="pre">getqc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.getqc" title="Link to this definition">¶</a></dt>
<dd><p>Return critical momentum.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.QWArea">
<span class="sig-name descname"><span class="pre">QWArea</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.QWArea" title="Link to this definition">¶</a></dt>
<dd><p>Return quantum wire cross-sectional area.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.ShutOffOptics">
<span class="sig-name descname"><span class="pre">ShutOffOptics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.ShutOffOptics" title="Link to this definition">¶</a></dt>
<dd><p>Disable optical coupling.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.write_sbes_data">
<span class="sig-name descname"><span class="pre">write_sbes_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.write_sbes_data" title="Link to this definition">¶</a></dt>
<dd><p>Write coherence matrices to backup files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.read_sbes_data">
<span class="sig-name descname"><span class="pre">read_sbes_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.read_sbes_data" title="Link to this definition">¶</a></dt>
<dd><p>Read coherence matrices from backup files.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.QWCalculator">
<span class="sig-name descname"><span class="pre">QWCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Exx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ezz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vrr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWDl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.QWCalculator" title="Link to this definition">¶</a></dt>
<dd><p>Time-evolve quantum wire sources for Maxwell’s equations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.close" title="Link to this definition">¶</a></dt>
<dd><p>Close open file handles.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="pulsesuite.PSTD3D.SBEs.SBESolver.__del__">
<span class="sig-name descname"><span class="pre">__del__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pulsesuite.PSTD3D.SBEs.SBESolver.__del__" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">InitializeSBE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Emaxxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">QW</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim — creates a default SBESolver instance.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id4">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">QWCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Exx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Eyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ezz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Vrr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pzz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Rho</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DoQWDl</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id4" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim — delegates to _default_solver.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">chiqw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id6">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">getqc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id6" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id7">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">QWArea</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id7" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id8">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ShutOffOptics</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id8" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id9">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">WriteSBEsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id9" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="id10">
<span class="sig-prename descclassname"><span class="pre">pulsesuite.PSTD3D.SBEs.</span></span><span class="sig-name descname"><span class="pre">ReadSBEsData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Nt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id10" title="Link to this definition">¶</a></dt>
<dd><p>Backward-compatible shim.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2026, Rahul R. Sah and PulseSuite Developers.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>